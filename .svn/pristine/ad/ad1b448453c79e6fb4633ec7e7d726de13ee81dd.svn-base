<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Test Grid Meta Data</title>
    <link rel="Stylesheet" type="text/css" href="../../../css/Kendo.v2014.1.318/kendo.common.min.css" />
    <link rel="Stylesheet" type="text/css" href="../../../css/GRCConnect/connect-grid.css" />
    <link rel="Stylesheet" type="text/css" href="../../../css/GRCConnect/connect-icons.css" />
    <link rel="Stylesheet" type="text/css" href="../../../css/kendo-lightblue-noedit.css" />
    <link rel="Stylesheet" type="text/css" href="../../../css/kendo-lightblue-grid.css" />
    <link rel="Stylesheet" type="text/css" href="../../../css/kendo-lightblue-menu.css" />
    <link rel="Stylesheet" type="text/css" href="../../../css/Kendo.v2014.1.318/kendo.grid.css" />
    <link rel="Stylesheet" type="text/css" href="../../../css/pages/global.css" />
    <link rel="Stylesheet" type="text/css" href="../../../css/pages/topbanner.css" />
    <link rel="Stylesheet" type="text/css" href="../../../css/pages/icons.css" />
    <link rel="Stylesheet" type="text/css" href="../../../css/pages/windows.css" />
    <link rel="Stylesheet" type="text/css" href="../../../css/EDA/eda.css" />
    <link rel="Stylesheet" type="text/css" href="../../../css/EDA/cssgrid.css" />
    <script src="../../../Lib_{{VER}}/JQuery.v1.11.3/jquery-1.11.3.min.js" type="text/javascript"></script>
    <script src="../../../Lib_{{VER}}/Knockout.v3.3.0/knockout-3.3.0.js" type="text/javascript"></script>
    <script src="../../../Lib_{{VER}}/KendoUI.v2014.1.416/kendo.web.min.js" type="text/javascript"></script>
    <script src="../../../Lib_{{VER}}/KendoUI.v2014.1.416/kendo.grc.grid.js" type="text/javascript"></script>
    <script src="../../../Lib_{{VER}}/knockoutkendo.v0.9.3/knockout-kendo.min.js" type="text/javascript"></script>
    <script src="../../../Lib_{{VER}}/pages/global.js" type="text/javascript"></script>
    <script src="../../../Lib_{{VER}}/JQuery/jquery.cookie.js" type="text/javascript"></script>
    <script src="../../../Lib_{{VER}}/JQuery/cache-controller_{{VER}}.js" type="text/javascript"></script>
    <script src="../../../Lib_{{VER}}/json/json2.js" type="text/javascript"></script>
    <script src="../../../Lib_{{VER}}/ES/entityspaces.XHR.js" type="text/javascript"></script>
    <script src="../../../Lib_{{VER}}/Config/baseurl.js" type="text/javascript"></script>
    <script src="../../../Lib_{{VER}}/Generated/GSafeDetail.js" type="text/javascript"></script>
    <script src="../../../Lib_{{VER}}/Custom/GSafeDetail.js" type="text/javascript"></script>
    <script src="../../../Lib_{{VER}}/Generated/GSafeHeader.js" type="text/javascript"></script>
    <script src="../../../Lib_{{VER}}/Custom/GSafeHeader.js" type="text/javascript"></script>
    <script src="../../../Lib_{{VER}}/Generated/NavLink.js" type="text/javascript"></script>
    <script src="../../../Lib_{{VER}}/Session/sessvars.js" type="text/javascript"></script>
    <script src="../../../Lib_{{VER}}/pages/constants.js" type="text/javascript"></script>
    <script src="../../../Lib_{{VER}}/pages/util_{{VER}}.js" type="text/javascript"></script>
    <script src="../../../Lib_{{VER}}/pages/topbanner.js" type="text/javascript"></script>
</head>
<body style="padding: 16px; text-align: center;">
    <div id="view">
        <br /><br />
        <div style="height: 200px;">
            TYPE IN A FUNCTION
            <textarea id="functionString" data-bind="value: functionString" style="width: 100%; height: 100%"></textarea>
        </div>
        <br /><br />
        <button data-bind="click: onRunFunction">Run The Function</button>
    </div>
</body>
<script>
    $(document).ready(function () {
        view = {
            functionString: ko.observable("return = function (pData) { var zReturn = \"<div style='background-color: green'>\" + pData.RecCategory + \"</div>\"; alert(zReturn); }"),

            init: function () {
            },

            onRunFunction: function () {
                try {
                    //if (view.functionString().indexOf("function") == 0) {
                    //var zFunction = new Function(view.functionString()); // EXPECTED IDENTIFIER

                    // THIS WORKS, HOWEVER IT IS PLACED INSIDE A VARIABLE THAT MUST BE RUN
                    var zData = { RecCategory: "Wookiees" };
                    var zFunction = eval(view.functionString());
                    //fn(zData);

                    //eval(view.functionString());

                    //} else {
                     //   alert("This is not a function");
                    //}
                } catch (pException) {
                    alert("Something went wrong: " + pException.message);
                }
            },

            bindForm: function () {
                ko.applyBindings(view, $("#view")[0]);
            }
        };

        view.bindForm();
        view.init();
    });
</script>

</html>
