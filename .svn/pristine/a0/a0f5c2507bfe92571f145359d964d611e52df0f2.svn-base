var dsAdminLanguageLabels = {
    //// ADMINISTRATION WINDOW
    
    //// IMPORT
    lblWindowAdminTitle: "Administration Window",
    lblWindowLoadCOPEInfo: "Load C.O.P.E. Info",
    lblWindowLoadNatHazDataInfo: "Load NatHaz Data Info",
    lblWindowLoadFacilityDataInfo: "Load Facility Data Info",
    lblWindowLoadNatHazModelData: "Load NatHaz Model Data",
    lblWindowLoadRecInfo: "Load Rec. Info",
    lblWindowLoadRatingInfo: "Load Rating Info",
    lblWindowLoadRetailInfo: "Load Retail Info",
    lblImport: "Import",
    lblSelectAll: "Select All ",
    lblSelectNone: "Select None",
    lblNoCheckboxesSelected: "Please select at least one import type in the checkboxes above to enable the import button.",
    lblIncorrectFileFormat: "The file you are uploading is an invalid file type.  Please try again.",
    lblImportNotAvailable: "The Import Template tool is not available for this practice.  Please select another practice and try again.",
    lblPleaseClickContinue: "Please click continue to go to the next screen.",
    lblPleaseCheckForErrors: "Please check the details above for errors.",
    lblUploadProgress: "Upload Progress",
    lblDefaultImportSuccess: "",
    lblDefaultImportError: "",
    lblContinue: "Continue",
    lblCancel: "Cancel",
    lblClose: "Close",
    lblLoading: "Loading, please wait...",
    lblPracticeCode: "Practice Code",
    lblResults: "Results...",

    //// REC RESPONSE
    lblFileNo: "File No",
    lblDateOfInspection: "Date of Inspection",
    lblDateMailedToClient: "Date Mailed to Client",
    lblLastEmailSentOn: "Last Email Sent On",
    lblLastEmailSentBy: "Last Email Sent By",
    lblLinkToERReport: "Link to ER Report",
    lblRecipientsFullName: "Recipient\'s Full Name",
    lblRecipientsEmailAddress: "Recipient\'s Email Address",
    lblSendRecommendationResponseEmail: "Send Original Rec. Response Email",
    lblReSendRecommendationResponseEmail: "Resend Rec. Response Email",
    lblCurrentLink: "Current Link",
    lblClickHere: "Click Here",
    lblActivity: "Activity",
    lblHazard: "Hazard",

    //// USER ACTIVITY
    lblExport: "Export",
    lblAddNewUser: "Add New User",
    lblEdit: "Edit",
    lblFullName: "Full Name",
    lblUserID: "User ID",
    lblPassword: "Password",
    lblDateAdded: "Date Added",
    lblLastLogin: "Last Login",
    lblActiveUser: "Active User",
    lblThirdParty: "Third Party",
    lblInternal: "Internal",
    lblGRCAdmin: "GRC Admin.",
    lblGRCAdministrator: "GRC Administrator",
    lblIsAMorAE: "Is AM or AE?",
    lblAccountAccess: "Account Access",
    lblDocumentAccess: "Doc. Access",
    lblDocumentsOnly: "Documents Only",
    lblClientAdmin: "Client Admin",
    lblCustAccess: "Cust. Access",
    lblCustomAccess: "Custom Access",
    lblCustomAccessText: "Custom Access Text",
    lblLocationAccess: "Location Access",
    lblLocation: "Location",
    lblClientLocNo: "Client Loc No.",
    lblDivisionManager: "Division Access",
    lblDiv: "Div.",
    lblDivision: "Division",
    lblPlantManager: "Plant Manager",
    lblPlant: "Plant",
    lblFacilityManager: "Facility Manager",
    lblFacility: "Facility",
    lblCity: "City",
    lblStProv: "St/Prov",
    lblCountry: "Country",
    lblPhone: "Phone",
    lblFax: "Fax",
    lblEmail: "Email",
    lblComments: "Comments",
    lblRInit: "R. Initial",
    lblRReport: "R. Report",
    lblRFU1: "RFU1",
    lblRFU2: "RFU2",
    lblRFU3: "RFU3",
    lblROverdue1: "R. Overdue 1",
    lblROverdue2: "R. Overdue 2",
    lblROverdue3: "R. Overdue 3",
    lblExpOverdue: "Exp. Overdue",
    lblWorkOrder: "Work Order",
    lblUserForm: "User Form",
    lblAutoRecDetails: "Auto-Rec. Details",
    lblErrorLoadUser: "Error while loading user information.",
    lblCCgActivity: "CC'g Activity",
    lblCCOnly: "CC Only",
    lbl1stFU: "1st F/U",
    lbl2ndFU: "2nd F/U",
    lbl3rdFU: "3rd F/U",
    lblExpdFU: "Exp'd F/U",
    lbl1stOD: "1st OD",
    lbl2ndOD: "2nd OD",
    lbl3rdOD: "3rd OD",
    lblPastDue: "Past Due",
    lblExpOD: "Exp OD",
    lblInit: "Init.",
    lblRpt: "Rpt.",
    lblAll: "All",
    lblFire: "Fire",
    lblBM: "B&M",
    lblInfrared: "Infrared",
    lblWind: "Wind",
    lblSeismic: "Seismic",
    lblFlood: "Flood",
    lblNatHaz: "Nat. Haz.",
    lblDivServ: "Div. Serv.",
    lblProcSafe: "Proc. Safe.",
    lblSaveChanges: "Save Changes",
    lblDeleteUser: "Delete User",
    lblPleaseProvideEmail: "Please provide an email address.",
    lblPleaseProvideFullName: "Please provide a full name.",
    lblPleaseProvidePassword: "Please provide a password.",
    lblPleaseProvidePhone: "Please provide a phone number.",
    lblPleaseProvideCustomAccess: "Please provide a custom access text, or uncheck custom access.",
    lblPleaseProvideDivision: "Please provide a division, or uncheck division manager.",
    lblPleaseProvideLocation: "Please provide a location, or uncheck location manager.",
    lblPleaseProvideClientLocNo: "Please provide a Client Loc. No., or uncheck Client Loc. No. manager.",
    lblPleaseProvideFacility: "Please provide a facility, or uncheck facility manager.",
    lblPleaseProvideCity: "Please provide a city, or uncheck city manager.",
    lblPleaseProvideStProv: "Please provide a St. / Prov., or uncheck St. / Prov. manager.",
    lblPleaseProvideCountry: "Please provide a country, or uncheck country manager.",
    lblPleaseSelectOneTypeAccess: "Please select at least one type of access.",
    lblAreYouSureDeleteUser: "Are you sure you want to delete this user?",
    lblErrorDeleteUser: "An error occurred while trying to delete user. Please log out and try again later.",
    lblEmailPasswordCombo: "The email/password combination already exists in the system for this client. Please try again.",

    //// DOCUMENT MANAGER
    lblDocumentManager: "Document Manager",
    lblSelectReport: "Select Report",
    lblSelectDiagram: "Select Diagram",
    lblAddDocument: "Add Document",
    lblEditRecord: "Edit Record",
    lblDelectRecord: "Delete Record",
    lblLinkToERReport: "Link to ER Report",
    lblLinkToURLEReport: "Link to UR or LE Report",
    lblLinkToDiagram: "Link to Diagram",
    lblAreYouSurePermanentlyDeleteRecord: "Are you sure you want to permanently delete this record?",
    lblDocumentAlreadyExists: "A record already exists for the latest inspection date. Are you sure you want to archive and add new record?",
    lblErrorAddingNew: "An error has occurred while looking up existing records before adding. Please try again later.",
    lblErrorWhileDeleteDoc: "An error occurred while trying to delete document record. Please log out and try again later.",
    lblRecordSaved: "The document record has been saved. Please click continue to go to the next screen.",
    lblRecordNotSaved: "An error has occurred while saving the document record. Please log out and try again later.",
    lblSelectOneReport: "Please select at least one report or one diagram before saving.",
    lblProvideDates: "Please provide the required dates above.",
    lblCannotEditDocumentRecord: "No document record exists to edit.",
    lblThisPracticeNotAvailable: "This practice does not have this function available.",
    
    //// PLAN PROJECT REVIEW
    lblAddNewPlanProject: "Add New Plan/Project Review",
    lblPlanProjectReviewForm: "Project/Plan Review Form",
    lblProjectNo: "Project No.",
    lblProjectNo: "Project No.",
    lblSubmittedBy: "Submitted By",
    lblEmailPhone: "Email / Phone",
    lblProject: "Project",
    lblConsultant: "Consultant",
    lblReceived: "Received",
    lblReviewed: "Reviewed",
    lblToReview: "To Review",
    lblDeletePlanProject: "Delete Record",
    lblSelectItem: "Select Item",
    lblErrorLoadPlanProject: "Error while loading Plan Project Review information.",
    lblAreYouSureDeletePlanProject: "Are you sure you want to delete this Plan Project Review?",
    lblErrorDeletePlanProject: "An error occurred while trying to delete Plan Project Review. Please log out and try again later.",
    lblSelectDocument: "Select Document",
    lblPleaseEnterSubmittedBy: "Please enter a submitted by name.",
    lblPleaseEnterProject: "Please enter information in the project field.",
    lblPleaseEnterConsultant: "Please enter a consultant name.",
    lblPleaseEnterReviewedDate: "Please enter a valid reviewed date.",
    lblPleaseEnterFileToReview: "Please enter a valid file to review.",
    lblPleaseEnterValidProjectNumber: "Please enter a valid project number (less than 32750).",
    lblPleaseEnterValidRecievedDate: "Please enter a received date less than or equal to today.",
    lblPleaseEnterValidReviewedDate: "Please enter a reviewed date less than or equal to today.",
    lblMaxCharProject: "Maximum characters allowed is 50. Please modify the project field.",
    lblPractice: "Practice",

    lbl: ""
};

var cancelDoc = {
    DateOfInspection: "",
    DateMailedToClient: "",
    LinkToReport: "",
    LinkToReport2: "",
    LinkToDiagram: ""
};

var previousDoc = {
    DateOfInspection: "",
    DateMailedToClient: "",
    LinkToReport: "",
    LinkToReport2: "",
    LinkToDiagram: ""
};

var viewAdmin = {
    objAdminLanguageLabels: ko.observable(dsAdminLanguageLabels),
    gSafeGuid: getGSafeGUID(),
    currentTab: "",

    enableAdminButtons: ko.observable(true),
    enableCloseCancelContinue: ko.observable(true),
    enableImport: ko.observable(false),
    enableImportUploadButton: ko.observable(true),
    txtCloseCancelContinue_Document: ko.observable(""),
    txtCloseCancelContinue_Import: ko.observable(""),
    txtCloseCancelContinue_Rec: ko.observable(""),
    txtCloseCancelContinue_User: ko.observable(""),
    txtCloseCancelContinue_PlanProject: ko.observable(""),
    messageImport: ko.observable(""),
    messageImportLabel: ko.observable(""),
    messageRec: ko.observable(""),
    uploadProgress: ko.observable(),

    //// IMPORT
    //// CHECKBOXES
    chkLoadCOPE: ko.observable(true),
    chkLoadFacilityData: ko.observable(true),
    chkLoadNatHazDataInfo: ko.observable(true),
    chkLoadNatHazModelData: ko.observable(true),
    chkLoadRecInfo: ko.observable(true),
    chkLoadRatingInfo: ko.observable(true),
    chkLoadRetailInfo: ko.observable(true),
    enableImportFireCheckboxes: ko.observable(true),
    enableImportBMCheckboxes: ko.observable(true),
    enableImportNatHazCheckboxes: ko.observable(true),
    enableImportRetailCheckboxes: ko.observable(false),
    enableImportRatingCheckboxes: ko.observable(true),
    enableImportRecCheckboxes: ko.observable(true),


    //// REC RESPONSE
    collRec: undefined,
    objRec: ko.observable(),
    recLoaded: false,
    recRecipientsFullName: ko.observable(""),
    recRecipientsEmailAddress: ko.observable(""),
    enableResendRecResponseEmail: ko.observable(false),
    enableSendRecResponseEmail: ko.observable(true),
    cboHazard: ko.observableArray(["Seismic","Wind","Flood"]),
    cboHazardValue: ko.observable(),
    enableCboRecResponse_Hazard: ko.observable(false),
    visibleCboRecResponse_Hazard: ko.observable(false),

    //// USER ACTIVITY
    editNewMode: "",
    collUser: null, // new es.objects.EzyUsersCollection(),
    collUserGrid: null, // new es.objects.ViewCCUserActivityGridCollection(),
    collGridDS: ko.observableArray(),
    objUser: ko.observable(),
    userColumnTitles: [],
    enableDeleteUser: ko.observable(),
    messageUserDetails: ko.observable(),
    customAccessTextArray: ko.observableArray([]),
    customAccessTextValue: ko.observable(),
    divisionArray: ko.observableArray([]),
    divisionValue: ko.observable(),
    plantArray: ko.observableArray([]),
    plantValue: ko.observable(),
    facilityArray: ko.observableArray([]),
    facilityValue: ko.observable(),
    clientLocNoArray: ko.observableArray([]),
    clientLocNoValue: ko.observable(),
    cityArray: ko.observableArray([]),
    cityValue: ko.observable(),
    stProvArray: ko.observableArray([]),
    stProvValue: ko.observable(),
    countryArray: ko.observableArray([]),
    countryValue: ko.observable(),
    emailFlag: ko.observable("emailNone"),

    All_Init: ko.observable(false),
    All_Rpt: ko.observable(false),
    All_1stFU: ko.observable(false),
    All_2ndFU: ko.observable(false),
    All_3rdFU: ko.observable(false),
    All_ExpdFU: ko.observable(false),
    All_1stOD: ko.observable(false),
    All_2ndOD: ko.observable(false),
    All_3rdOD: ko.observable(false),
    All_PastDue: ko.observable(false),
    Fire_Init: ko.observable(false),
    Fire_Rpt: ko.observable(false),
    Fire_1stFU: ko.observable(false),
    Fire_2ndFU: ko.observable(false),
    Fire_3rdFU: ko.observable(false),
    Fire_ExpdFU: ko.observable(false),
    Fire_1stOD: ko.observable(false),
    Fire_2ndOD: ko.observable(false),
    Fire_3rdOD: ko.observable(false),
    Fire_PastDue: ko.observable(false),
    BM_Init: ko.observable(false),
    BM_Rpt: ko.observable(false),
    BM_1stFU: ko.observable(false),
    BM_2ndFU: ko.observable(false),
    BM_3rdFU: ko.observable(false),
    BM_ExpdFU: ko.observable(false),
    BM_1stOD: ko.observable(false),
    BM_2ndOD: ko.observable(false),
    BM_3rdOD: ko.observable(false),
    BM_PastDue: ko.observable(false),
    IR_Init: ko.observable(false),
    IR_Rpt: ko.observable(false),
    IR_1stFU: ko.observable(false),
    IR_2ndFU: ko.observable(false),
    IR_3rdFU: ko.observable(false),
    IR_ExpdFU: ko.observable(false),
    IR_1stOD: ko.observable(false),
    IR_2ndOD: ko.observable(false),
    IR_3rdOD: ko.observable(false),
    IR_PastDue: ko.observable(false),
    Wind_Init: ko.observable(false),
    Wind_Rpt: ko.observable(false),
    Wind_1stFU: ko.observable(false),
    Wind_2ndFU: ko.observable(false),
    Wind_3rdFU: ko.observable(false),
    Wind_ExpdFU: ko.observable(false),
    Wind_1stOD: ko.observable(false),
    Wind_2ndOD: ko.observable(false),
    Wind_3rdOD: ko.observable(false),
    Wind_PastDue: ko.observable(false),
    Seismic_Init: ko.observable(false),
    Seismic_Rpt: ko.observable(false),
    Seismic_1stFU: ko.observable(false),
    Seismic_2ndFU: ko.observable(false),
    Seismic_3rdFU: ko.observable(false),
    Seismic_ExpdFU: ko.observable(false),
    Seismic_1stOD: ko.observable(false),
    Seismic_2ndOD: ko.observable(false),
    Seismic_3rdOD: ko.observable(false),
    Seismic_PastDue: ko.observable(false),
    Flood_Init: ko.observable(false),
    Flood_Rpt: ko.observable(false),
    Flood_1stFU: ko.observable(false),
    Flood_2ndFU: ko.observable(false),
    Flood_3rdFU: ko.observable(false),
    Flood_ExpdFU: ko.observable(false),
    Flood_1stOD: ko.observable(false),
    Flood_2ndOD: ko.observable(false),
    Flood_3rdOD: ko.observable(false),
    Flood_PastDue: ko.observable(false),
    NatHaz_Init: ko.observable(false),
    NatHaz_Rpt: ko.observable(false),
    NatHaz_1stFU: ko.observable(false),
    NatHaz_2ndFU: ko.observable(false),
    NatHaz_3rdFU: ko.observable(false),
    NatHaz_ExpdFU: ko.observable(false),
    NatHaz_1stOD: ko.observable(false),
    NatHaz_2ndOD: ko.observable(false),
    NatHaz_3rdOD: ko.observable(false),
    NatHaz_PastDue: ko.observable(false),
    DivServ_Init: ko.observable(false),
    DivServ_Rpt: ko.observable(false),
    DivServ_1stFU: ko.observable(false),
    DivServ_2ndFU: ko.observable(false),
    DivServ_3rdFU: ko.observable(false),
    DivServ_ExpdFU: ko.observable(false),
    DivServ_1stOD: ko.observable(false),
    DivServ_2ndOD: ko.observable(false),
    DivServ_3rdOD: ko.observable(false),
    DivServ_PastDue: ko.observable(false),

    ProcSafe_Init: ko.observable(false),
    ProcSafe_Rpt: ko.observable(false),
    ProcSafe_1stFU: ko.observable(false),
    ProcSafe_2ndFU: ko.observable(false),
    ProcSafe_3rdFU: ko.observable(false),
    ProcSafe_ExpdFU: ko.observable(false),
    ProcSafe_1stOD: ko.observable(false),
    ProcSafe_2ndOD: ko.observable(false),
    ProcSafe_3rdOD: ko.observable(false),
    ProcSafe_PastDue: ko.observable(false),




    //// DOCUMENT MANAGER
    selectReportMode: "",
    docAddEditMode: "",
    enableDocumentSelect: ko.observable(false),
    enableDocumentDelete: ko.observable(false),
    enableDocumentTopButtons: ko.observable(true),
    collDoc: undefined,
    objDoc: ko.observable(),
    docManagerLoaded: false,
    messageDoc: ko.observable(),
    metaPracticeID: null,

    //// PLAN PROJECT REVIEW
    collPlanProject: undefined,
    collPlanProjectGrid: undefined,
    collGridPlanProjectDS: ko.observableArray(),
    objPlanProject: ko.observable(),
    planProjectColumnTitles: [],
    enableDeletePlanProject: false,
    editNewModePlanProject: "",
    messagePlanProjectDetails: ko.observable(""),
    enableDeletePlanProject: ko.observable(false),
    enablePlanProjectSelect: ko.observable(true),
    planProjectFileNoArray: ko.observableArray(),
    planProjectFileNoValue: ko.observable(),
    practiceTypeArray: ko.observableArray([
        { practiceName: "Fire", practiceCode: "520" },
        { practiceName: "B & M", practiceCode: "510" }
    ]),
    practiceTypeValue: ko.observable(),
    enablePracticeType: ko.observable(),
    enablePlanProjectFileNo: ko.observable(true),

    ////////////////////////
    ////////////////////////
    //// START DATA LOADING FUNCTIONS
    onLoadEmptyTabs: function () {
        //// PREVENT UNEEDED WCF CALL TIME AT PAGE LOAD, THE ADMIN POPUP IS NOT OPEN YET
        var tempTab = viewAdmin.currentTab;

        //// REC RESPONSE
        if (!global_IsMainGaugePage) {
            switch (tempTab) {
                case "9": case "782": case "791":
                    viewAdmin.objRec(new es.objects.ViewCCAdminWindowRecResponseFire());
                    break;
                case "10": case "783": case "792":
                    viewAdmin.objRec(new es.objects.ViewCCAdminWindowRecResponseBM());
                    break;
                case "11": case "784": case "793":
                    viewAdmin.objRec(new es.objects.ViewCCAdminWindowRecResponseIR());
                    break;
                case "12": case "785": case "794":
                    viewAdmin.objRec(new es.objects.ViewCCAdminWindowRecResponseJuris());
                    break;
                case "678": case "790": case "799":
                    // NATURAL HAZARDS
                    viewAdmin.objRec(new es.objects.ViewCCAdminWindowRecResponseNH());
                    break;
                case "665": case "789": case "798": case "869":
                    // DIVERSIFIED SERVICES
                    viewAdmin.objRec(new es.objects.ViewCCAdminWindowRecResponseDiversified());
                    break;
                case "881": case "882": case "899":
                    // PROCESS SAFETY
                    viewAdmin.objRec(new es.objects.ViewCCAdminWindowRecResponsePS());
                    break;
                default:
                    viewAdmin.objRec(new es.objects.ViewCCAdminWindowRecResponseFire());
                    break;
            }
            viewAdmin.objRec().RRLogGuid("");
            viewAdmin.objRec().FileNo("");
            viewAdmin.objRec().CurrentLink("");
            viewAdmin.objRec().Sender("");
            viewAdmin.objRec().DateRecEmailed("");
            viewAdmin.objRec().PracticeCode("");
            viewAdmin.objRec().InspectionDate("");
            viewAdmin.objRec().InspectionEmailedDate("");
            viewAdmin.objRec().LinkToReport("");
            viewAdmin.objRec().Activity("");
            viewAdmin.objRec().LastRecipientEmail("");
            viewAdmin.objRec().LastRecipientName("");
            viewAdmin.objRec().LatestStatusDate("");
            viewAdmin.objRec().StatusDateCount(0);
            viewAdmin.objRec().RecCount(0);
        }

        //// USER EDIT FORM
        switch (tempTab) {
            case "1":
                viewAdmin.onClearUser();
                break;
            default:
                viewAdmin.onClearUser();
                break;
        }

        //// IMPORT
        if (!global_IsMainGaugePage) {
            var isFeaturesV = false;
            if (getClientFeatures(viewAdmin.gSafeGuid).toLowerCase().indexOf("v") < 0) { isFeaturesV = false; } else { isFeaturesV = true; };
            switch (tempTab) {
                case "9": case "782": case "791":
                    viewAdmin.chkLoadCOPE(true);
                    viewAdmin.chkLoadFacilityData(false);
                    viewAdmin.chkLoadNatHazDataInfo(false);
                    viewAdmin.chkLoadNatHazModelData(true);
                    viewAdmin.chkLoadRecInfo(true);
                    viewAdmin.chkLoadRatingInfo(true);
                    if (isFeaturesV) { viewAdmin.chkLoadRetailInfo(true); } else { viewAdmin.chkLoadRetailInfo(false); }
                    viewAdmin.enableImportFireCheckboxes(true);
                    viewAdmin.enableImportRecCheckboxes(true);
                    viewAdmin.enableImportBMCheckboxes(false);
                    viewAdmin.enableImportRatingCheckboxes(true);
                    viewAdmin.enableImportNatHazCheckboxes(true);
                    viewAdmin.enableImportRetailCheckboxes(true);
                    break;
                case "10": case "783": case "792":
                    viewAdmin.chkLoadCOPE(false);
                    viewAdmin.chkLoadFacilityData(true);
                    viewAdmin.chkLoadNatHazDataInfo(false);
                    viewAdmin.chkLoadNatHazModelData(false);
                    viewAdmin.chkLoadRecInfo(true);
                    viewAdmin.chkLoadRatingInfo(true);
                    if (isFeaturesV) { viewAdmin.chkLoadRetailInfo(true); } else { viewAdmin.chkLoadRetailInfo(false); }
                    viewAdmin.enableImportFireCheckboxes(false);
                    viewAdmin.enableImportRecCheckboxes(true);
                    viewAdmin.enableImportBMCheckboxes(true);
                    viewAdmin.enableImportRatingCheckboxes(true);
                    viewAdmin.enableImportNatHazCheckboxes(false);
                    viewAdmin.enableImportRetailCheckboxes(false);
                    break;
                case "11": case "784": case "793":
                    viewAdmin.chkLoadCOPE(false);
                    viewAdmin.chkLoadFacilityData(false);
                    viewAdmin.chkLoadNatHazDataInfo(false);
                    viewAdmin.chkLoadNatHazModelData(false);
                    viewAdmin.chkLoadRecInfo(false);
                    viewAdmin.chkLoadRatingInfo(false);
                    if (isFeaturesV) { viewAdmin.chkLoadRetailInfo(true); } else { viewAdmin.chkLoadRetailInfo(false); }
                    viewAdmin.enableImport(false);
                    $('#btnImport').addClass('grcBlueDisabledBtn');
                    viewAdmin.enableImportUploadButton(false);
                    $("#windowAdminUpload").attr("disabled", "disabled");
                    viewAdmin.messageImport(viewAdmin.objAdminLanguageLabels().lblImportNotAvailable);
                    viewAdmin.enableImportFireCheckboxes(false);
                    viewAdmin.enableImportRecCheckboxes(false);
                    viewAdmin.enableImportBMCheckboxes(false);
                    viewAdmin.enableImportRatingCheckboxes(false);
                    viewAdmin.enableImportNatHazCheckboxes(false);
                    viewAdmin.enableImportRetailCheckboxes(false);
                    break;
                case "12": case "785": case "794":
                    viewAdmin.chkLoadCOPE(false);
                    viewAdmin.chkLoadFacilityData(false);
                    viewAdmin.chkLoadNatHazDataInfo(false);
                    viewAdmin.chkLoadNatHazModelData(false);
                    viewAdmin.chkLoadRecInfo(false);
                    viewAdmin.chkLoadRatingInfo(false);
                    if (isFeaturesV) { viewAdmin.chkLoadRetailInfo(true); } else { viewAdmin.chkLoadRetailInfo(false); }
                    viewAdmin.enableImport(false);
                    $('#btnImport').addClass('grcBlueDisabledBtn');
                    viewAdmin.enableImportUploadButton(false);
                    $("#windowAdminUpload").attr("disabled", "disabled");
                    viewAdmin.messageImport(viewAdmin.objAdminLanguageLabels().lblImportNotAvailable);
                    viewAdmin.enableImportFireCheckboxes(false);
                    viewAdmin.enableImportRecCheckboxes(false);
                    viewAdmin.enableImportBMCheckboxes(false);
                    viewAdmin.enableImportRatingCheckboxes(false);
                    viewAdmin.enableImportNatHazCheckboxes(false);
                    viewAdmin.enableImportRetailCheckboxes(false);
                    break;
                case "678": case "790": case "799":
                    // NATURAL HAZARDS
                    viewAdmin.chkLoadCOPE(true);
                    viewAdmin.chkLoadFacilityData(false);
                    viewAdmin.chkLoadNatHazDataInfo(true);
                    viewAdmin.chkLoadNatHazModelData(true);
                    viewAdmin.chkLoadRecInfo(true);
                    viewAdmin.chkLoadRatingInfo(true);
                    if (isFeaturesV) { viewAdmin.chkLoadRetailInfo(true); } else { viewAdmin.chkLoadRetailInfo(false); }
                    viewAdmin.enableImportFireCheckboxes(true);
                    viewAdmin.enableImportRecCheckboxes(true);
                    viewAdmin.enableImportBMCheckboxes(false);
                    viewAdmin.enableImportRatingCheckboxes(true);
                    viewAdmin.enableImportNatHazCheckboxes(true);
                    viewAdmin.enableImportRetailCheckboxes(false);
                    break;
                case "665": case "789": case "798": case "869":
                    // DIVERSIFIED SERVICES
                    viewAdmin.chkLoadCOPE(false);
                    viewAdmin.chkLoadFacilityData(false);
                    viewAdmin.chkLoadNatHazDataInfo(false);
                    viewAdmin.chkLoadNatHazModelData(false);
                    viewAdmin.chkLoadRecInfo(false);
                    viewAdmin.chkLoadRatingInfo(false);
                    if (isFeaturesV) { viewAdmin.chkLoadRetailInfo(true); } else { viewAdmin.chkLoadRetailInfo(false); }
                    viewAdmin.enableImport(false);
                    $('#btnImport').addClass('grcBlueDisabledBtn');
                    viewAdmin.enableImportUploadButton(false);
                    $("#windowAdminUpload").attr("disabled", "disabled");
                    viewAdmin.messageImport(viewAdmin.objAdminLanguageLabels().lblImportNotAvailable);
                    viewAdmin.enableImportFireCheckboxes(false);
                    viewAdmin.enableImportRecCheckboxes(false);
                    viewAdmin.enableImportBMCheckboxes(false);
                    viewAdmin.enableImportRatingCheckboxes(false);
                    viewAdmin.enableImportNatHazCheckboxes(false);
                    viewAdmin.enableImportRetailCheckboxes(false);
                    break;
                case "881": case "882": case "899":
                    // PROCESS SAFETY
                    viewAdmin.chkLoadCOPE(false);
                    viewAdmin.chkLoadFacilityData(false);
                    viewAdmin.chkLoadNatHazDataInfo(false);
                    viewAdmin.chkLoadNatHazModelData(false);
                    viewAdmin.chkLoadRecInfo(true);
                    viewAdmin.chkLoadRatingInfo(false);
                    viewAdmin.chkLoadRetailInfo(false);
                    viewAdmin.enableImportFireCheckboxes(false);
                    viewAdmin.enableImportRecCheckboxes(true);
                    viewAdmin.enableImportBMCheckboxes(false);
                    viewAdmin.enableImportRatingCheckboxes(false);
                    viewAdmin.enableImportNatHazCheckboxes(false);
                    viewAdmin.enableImportRetailCheckboxes(false);
                    break;
            }
        }

        //// DOCUMENT MANAGER
        if (!global_IsMainGaugePage) {
            switch (tempTab) {
                case "9": case "782": case "791":
                    viewAdmin.objDoc(new es.objects.ViewCCAdminWindowDocManagerFire());
                    viewAdmin.metaPracticeID = 3;
                    $("#divDoc_LinkToLEReport").show();
                    $("#divDoc_LinkToURLEReport").show();
                    $("#divDoc_LinkToDiagram").show();
                    break;
                case "10": case "783": case "792":
                    viewAdmin.objDoc(new es.objects.ViewCCAdminWindowDocManagerBM());
                    viewAdmin.metaPracticeID = 2;
                    $("#divDoc_LinkToLEReport").show();
                    $("#divDoc_LinkToURLEReport").show();
                    $("#divDoc_LinkToDiagram").show();
                    break;
                case "11": case "784": case "793":
                    viewAdmin.objDoc(new es.objects.ViewCCAdminWindowDocManagerIR());
                    viewAdmin.metaPracticeID = 4;
                    $("#divDoc_LinkToLEReport").show();
                    $("#divDoc_LinkToURLEReport").hide();
                    $("#divDoc_LinkToDiagram").hide();
                    break;
                case "12": case "785": case "794":
                    viewAdmin.objDoc(new es.objects.ViewCCAdminWindowDocManagerJuris());
                    viewAdmin.metaPracticeID = 5;
                    $("#divDoc_LinkToLEReport").hide();
                    $("#divDoc_LinkToURLEReport").hide();
                    $("#divDoc_LinkToDiagram").hide();
                    break;
                case "678": case "790": case "799":
                    // NATURAL HAZARDS
                    viewAdmin.objDoc(new es.objects.ViewCCAdminWindowDocManagerNH());
                    viewAdmin.metaPracticeID = 9;
                    $("#divDoc_LinkToLEReport").show();
                    $("#divDoc_LinkToURLEReport").show();
                    $("#divDoc_LinkToDiagram").show();
                    break;
                case "665": case "789": case "798": case "869":
                    // DIVERSIFIED SERVICES
                    viewAdmin.objDoc(new es.objects.ViewCCAdminWindowDocManagerDiversified());
                    viewAdmin.metaPracticeID = 10;
                    $("#divDoc_LinkToLEReport").show();
                    $("#divDoc_LinkToURLEReport").show();
                    $("#divDoc_LinkToDiagram").show();
                    break;
                case "881": case "882": case "899":
                    // PROCESS SAFETY
                    viewAdmin.objDoc(new es.objects.ViewCCAdminWindowDocManagerPS());
                    viewAdmin.metaPracticeID = 11;
                    $("#divDoc_LinkToLEReport").show();
                    $("#divDoc_LinkToURLEReport").show();
                    $("#divDoc_LinkToDiagram").show();
                    break;
                default:
                    viewAdmin.objDoc(new es.objects.ViewCCAdminWindowDocManagerFire());
                    viewAdmin.metaPracticeID = 3;
                    $("#divDoc_LinkToLEReport").show();
                    $("#divDoc_LinkToURLEReport").show();
                    $("#divDoc_LinkToDiagram").show();
                    break;
            }
            viewAdmin.objDoc().FileNo("");
            viewAdmin.objDoc().PracticeCode("");
            viewAdmin.objDoc().PracticeName("");
            viewAdmin.objDoc().ReportArchiveID(0);
            viewAdmin.objDoc().DateOfInspection("");
            viewAdmin.objDoc().DateMailedToClient("");
            viewAdmin.objDoc().LinkToReport("");
            viewAdmin.objDoc().LinkToReport2("");
            viewAdmin.objDoc().LinkToDiagram("");
        }

        //// PLAN PROJECT
        switch (tempTab) {
            case "1": //// MAIN GAUGE PAGE
                viewAdmin.objPlanProject(new es.objects.FirePlanReview);
                viewAdmin.collPlanProject = new es.objects.FirePlanReviewCollection;
                viewAdmin.collPlanProjectGrid = new es.objects.ViewCCAllPlanReviewCollection;
                break;
            case "9": case "782": case "791": //// FIRE
                viewAdmin.objPlanProject(new es.objects.FirePlanReview);
                viewAdmin.collPlanProject = new es.objects.FirePlanReviewCollection;
                viewAdmin.collPlanProjectGrid = new es.objects.ViewCCFirePlanReviewCollection;
                break;
            case "10": case "783": case "792": //// BM
                viewAdmin.objPlanProject(new es.objects.BMPlanReview);
                viewAdmin.collPlanProject = new es.objects.BMPlanReviewCollection;
                viewAdmin.collPlanProjectGrid = new es.objects.ViewCCBMPlanReviewCollection;
                break;
            default: //// FIRE AS DEFAULT, BUT HIDE PANEL
                viewAdmin.objPlanProject(new es.objects.FirePlanReview);
                viewAdmin.collPlanProject = new es.objects.FirePlanReviewCollection;
                viewAdmin.collPlanProjectGrid = new es.objects.ViewCCFirePlanReviewCollection;
                setTimeout(function () {
                    $("divPlanProject_PlanProjectGrid").css("display", "none");
                    $("divPlanProject_PlanProjectDetailForm").css("display", "none");
                    $("divPlanProject_FilePicker").css("display", "none");
                }, 150);
                setTimeout(function () {
                    $("divPlanProject_Disabled").css("display", "block");
                }, 333);
                break;
        }
        viewAdmin.objPlanProject().FileNo("");
        viewAdmin.objPlanProject().Contact("");
        viewAdmin.objPlanProject().ContactPhone("");
        viewAdmin.objPlanProject().Subject("");
        viewAdmin.objPlanProject().Consultant("");
        viewAdmin.objPlanProject().Received("");
        viewAdmin.objPlanProject().Mailed("");
        viewAdmin.objPlanProject().ToReview("");
        viewAdmin.objPlanProject().ProjectNo(0);
        viewAdmin.objPlanProject().Comments("");
    },

    loadEmptyUserObject: function () {
        viewAdmin.objUser().colFullName("");
        viewAdmin.objUser().colUserID("");
        viewAdmin.objUser().colPassword("");
        viewAdmin.objUser().colDateTimeStamp("1/1/1900");
        viewAdmin.objUser().colLastLogin("1/1/1900");
        viewAdmin.objUser().colActiveUser(false);
        viewAdmin.objUser().colThirdParty(false);
        viewAdmin.objUser().colInternal(false);
        viewAdmin.objUser().colGrcadministrator("");
        viewAdmin.objUser().colRiskManager(false);
        viewAdmin.objUser().colDocumentAccess(false);
        viewAdmin.objUser().colClientAdministration(false);
        viewAdmin.objUser().colCustomAccess(false);
        viewAdmin.objUser().colCustomAccessText("");
        viewAdmin.objUser().colDivisionManager(false);
        viewAdmin.objUser().colDivision("");
        viewAdmin.objUser().colPlantManager(false);
        viewAdmin.objUser().colPlant("");
        viewAdmin.objUser().colPhone("");
        viewAdmin.objUser().colFax("");
        viewAdmin.objUser().colEmail("");
        viewAdmin.objUser().colComments("");
        viewAdmin.objUser().colRInit("");
        viewAdmin.objUser().colRReport("");
        viewAdmin.objUser().colRfu1("");
        viewAdmin.objUser().colRfu2("");
        viewAdmin.objUser().colRfu3("");
        viewAdmin.objUser().colROverdue1("");
        viewAdmin.objUser().colROverdue2("");
        viewAdmin.objUser().colROverdue3("");
        viewAdmin.objUser().colExpOverdue("");
        viewAdmin.objUser().colWo(false);
        viewAdmin.objUser().colCCActive(false);
        viewAdmin.objUser().colOperatorStamp(null);
        viewAdmin.objUser().colNotificationStamp("1/1/1900");
        viewAdmin.objUser().colFilePrefix(null);
        viewAdmin.objUser().colLastPWChange("1/1/1900");
        viewAdmin.objUser().colRActResp(null);
        viewAdmin.objUser().colCalist(null);
        viewAdmin.objUser().colDivlist(null);
        viewAdmin.objUser().colLoclist(null);
        viewAdmin.objUser().colLastRecentUpdate("1/1/1900");
        viewAdmin.objUser().colClientLocNoManager(false);
        viewAdmin.objUser().colClientLocNoText("");
        viewAdmin.objUser().colFacilityManager(false);
        viewAdmin.objUser().colFacilityText("");
        viewAdmin.objUser().colCityManager(false);
        viewAdmin.objUser().colCityText("");
        viewAdmin.objUser().colStProvManager(false);
        viewAdmin.objUser().colStProvText("");
        viewAdmin.objUser().colCountryManager(false);
        viewAdmin.objUser().colCountryText("");
        viewAdmin.objUser().colRExpd("");
        viewAdmin.objUser().colCCOnly(false)
    },

    buildUserObjectFromData: function (pObject) {
        return {
            "colLoginID": ko.observable(pObject.colLoginID),
            "colEzyUserID": ko.observable(pObject.colEzyUserID),
            "colFullName": ko.observable(pObject.colFullName),
            "colUserID": ko.observable(pObject.colUserID),
            "colPassword": ko.observable(pObject.colPassword),
            "colDateTimeStamp": ko.observable(pObject.colDateTimeStamp),
            "colLastLogin": ko.observable(pObject.colLastLogin),
            "colActiveUser": ko.observable(pObject.colActiveUser),
            "colThirdParty": ko.observable(pObject.colThirdparty),
            "colInternal": ko.observable(pObject.colInternal),
            "colGRCAdministrator": ko.observable(pObject.colGrcadministrator),
            "colRiskManager": ko.observable(pObject.colRiskManager),
            "colDocumentAccess": ko.observable(pObject.colDocumentAccess),
            "colClientAdministration": ko.observable(pObject.colClientAdministration),
            "colCustomAccess": ko.observable(pObject.colCustomAccess),
            "colCustomAccessText": ko.observable(pObject.colCustomAccessText),
            "colDivisionManager": ko.observable(pObject.colDivisionManager),
            "colDivision": ko.observable(pObject.colDivision),
            "colPlantManager": ko.observable(pObject.colPlantManager),
            "colPlant": ko.observable(pObject.colPlant),
            "colPhone": ko.observable(pObject.colPhone),
            "colFax": ko.observable(pObject.colFax),
            "colEmail": ko.observable(pObject.colEmail),
            "colComments": ko.observable(pObject.colComments),
            "colRInit": ko.observable(pObject.colRInit),
            "colRReport": ko.observable(pObject.colRReport),
            "colRfu1": ko.observable(pObject.colRfu1),
            "colRfu2": ko.observable(pObject.colRfu2),
            "colRfu3": ko.observable(pObject.colRfu3),
            "colROverdue1": ko.observable(pObject.colROverdue1),
            "colROverdue2": ko.observable(pObject.colROverdue2),
            "colROverdue3": ko.observable(pObject.colROverdue3),
            "colExpOverdue": ko.observable(pObject.colExpOverdue),
            "colWo": ko.observable(pObject.colWo),
            "colCCActive": ko.observable(pObject.colCCActive),
            "colOperatorStamp": ko.observable(pObject.colOperatorStamp),
            "colNotificationStamp": ko.observable(pObject.colNotificationStamp),
            "colFilePrefix": ko.observable(pObject.colFilePrefix),
            "colLastPWChange": ko.observable(pObject.colLastPWChange),
            "colRActResp": ko.observable(pObject.colRActResp),
            "colCalist": ko.observable(pObject.colCalist),
            "colDivlist": ko.observable(pObject.colDivlist),
            "colLoclist": ko.observable(pObject.colLoclist),
            "colLastRecentUpdate": ko.observable(pObject.colLastRecentUpdate),
            "colClientLocNoManager": ko.observable(pObject.colClientLocNoManager),
            "colClientLocNoText": ko.observable(pObject.colClientLocNoText),
            "colFacilityManager": ko.observable(pObject.colFacilityManager),
            "colFacilityText": ko.observable(pObject.colFacilityText),
            "colCityManager": ko.observable(pObject.colCityManager),
            "colCityText": ko.observable(pObject.colCityText),
            "colStProvManager": ko.observable(pObject.colStProvManager),
            "colStProvText": ko.observable(pObject.colStProvText),
            "colCountryManager": ko.observable(pObject.colCountryManager),
            "colCountryText": ko.observable(pObject.colCountryText),
            "colRExpd": ko.observable(pObject.colRExpd),
            "colCCOnly": ko.observable(pObject.colCCOnly)
        }
    },

    loadEmptyUserCheckboxes: function () {
        viewAdmin.All_Init(false);
        viewAdmin.All_Rpt(false);
        viewAdmin.All_1stFU(false);
        viewAdmin.All_2ndFU(false);
        viewAdmin.All_3rdFU(false);
        viewAdmin.All_1stOD(false);
        viewAdmin.All_2ndOD(false);
        viewAdmin.All_3rdOD(false);
        viewAdmin.All_PastDue(false);
        viewAdmin.Fire_Init(false);
        viewAdmin.Fire_Rpt(false);
        viewAdmin.Fire_1stFU(false);
        viewAdmin.Fire_2ndFU(false);
        viewAdmin.Fire_3rdFU(false);
        viewAdmin.Fire_1stOD(false);
        viewAdmin.Fire_2ndOD(false);
        viewAdmin.Fire_3rdOD(false);
        viewAdmin.Fire_PastDue(false);
        viewAdmin.BM_Init(false);
        viewAdmin.BM_Rpt(false);
        viewAdmin.BM_1stFU(false);
        viewAdmin.BM_2ndFU(false);
        viewAdmin.BM_3rdFU(false);
        viewAdmin.BM_1stOD(false);
        viewAdmin.BM_2ndOD(false);
        viewAdmin.BM_3rdOD(false);
        viewAdmin.BM_PastDue(false);
        viewAdmin.IR_Init(false);
        viewAdmin.IR_Rpt(false);
        viewAdmin.IR_1stFU(false);
        viewAdmin.IR_2ndFU(false);
        viewAdmin.IR_3rdFU(false);
        viewAdmin.IR_1stOD(false);
        viewAdmin.IR_2ndOD(false);
        viewAdmin.IR_3rdOD(false);
        viewAdmin.IR_PastDue(false);
        viewAdmin.Wind_Init(false);
        viewAdmin.Wind_Rpt(false);
        viewAdmin.Wind_1stFU(false);
        viewAdmin.Wind_2ndFU(false);
        viewAdmin.Wind_3rdFU(false);
        viewAdmin.Wind_1stOD(false);
        viewAdmin.Wind_2ndOD(false);
        viewAdmin.Wind_3rdOD(false);
        viewAdmin.Wind_PastDue(false);
        viewAdmin.Seismic_Init(false);
        viewAdmin.Seismic_Rpt(false);
        viewAdmin.Seismic_1stFU(false);
        viewAdmin.Seismic_2ndFU(false);
        viewAdmin.Seismic_3rdFU(false);
        viewAdmin.Seismic_1stOD(false);
        viewAdmin.Seismic_2ndOD(false);
        viewAdmin.Seismic_3rdOD(false);
        viewAdmin.Seismic_PastDue(false);
        viewAdmin.Flood_Init(false);
        viewAdmin.Flood_Rpt(false);
        viewAdmin.Flood_1stFU(false);
        viewAdmin.Flood_2ndFU(false);
        viewAdmin.Flood_3rdFU(false);
        viewAdmin.Flood_1stOD(false);
        viewAdmin.Flood_2ndOD(false);
        viewAdmin.Flood_3rdOD(false);
        viewAdmin.Flood_PastDue(false);

        viewAdmin.NatHaz_Init(false);
        viewAdmin.NatHaz_Rpt(false);
        viewAdmin.NatHaz_1stFU(false);
        viewAdmin.NatHaz_2ndFU(false);
        viewAdmin.NatHaz_3rdFU(false);
        viewAdmin.NatHaz_1stOD(false);
        viewAdmin.NatHaz_2ndOD(false);
        viewAdmin.NatHaz_3rdOD(false);
        viewAdmin.NatHaz_PastDue(false);

        viewAdmin.DivServ_Init(false);
        viewAdmin.DivServ_Rpt(false);
        viewAdmin.DivServ_1stFU(false);
        viewAdmin.DivServ_2ndFU(false);
        viewAdmin.DivServ_3rdFU(false);
        viewAdmin.DivServ_1stOD(false);
        viewAdmin.DivServ_2ndOD(false);
        viewAdmin.DivServ_3rdOD(false);
        viewAdmin.DivServ_PastDue(false);

        viewAdmin.ProcSafe_Init(false);
        viewAdmin.ProcSafe_Rpt(false);
        viewAdmin.ProcSafe_1stFU(false);
        viewAdmin.ProcSafe_2ndFU(false);
        viewAdmin.ProcSafe_3rdFU(false);
        viewAdmin.ProcSafe_1stOD(false);
        viewAdmin.ProcSafe_2ndOD(false);
        viewAdmin.ProcSafe_3rdOD(false);
        viewAdmin.ProcSafe_PastDue(false);
    },

    onLoadAllTabs: function () {
        //// WHEN ADMIN WINDOW IS OPENED, LOAD ALL THE TABS
        if (global_IsAdminWindowOpen) {
        }
    },

    onTabstripSelect: function (e) {
        if (global_IsAdminWindowOpen) {
            switch (e.item.id) {
                case "0": // DOCUMENT MANAGER
                    viewAdmin.onLoadDocManagerTab();
                    break;
                case "1": // IMPORT TEMPLATE
                    viewAdmin.messageImportLabel("");
                    break;
                case "2": // REC RESPONSE
                    viewAdmin.onLoadRecResponseTab();
                    break;
                case "3": // USER ACTIVITY
                    viewAdmin.onResetUserForm();
                    viewAdmin.onLoadUserGrid();
                    break;
                case "4": // PROJECT PLAN REVIEW
                    viewAdmin.onResetPlanProject();
                    var tempTab = viewAdmin.currentTab;
                    viewAdmin.onLoadPlanProjectFileNoList();
                    switch (tempTab) {
                        case "1":
                            viewAdmin.onLoadAllPlanProjectGrid();
                            break;
                        case "9": case "782": case "791":
                            viewAdmin.onLoadFirePlanProjectGrid();
                            break;
                        case "10": case "783": case "792":
                            viewAdmin.onLoadBMPlanProjectGrid();
                            break;
                        default:
                            viewAdmin.onLoadFirePlanProjectGrid();
                            setTimeout(function () {
                                $("#divPlanProject_PlanProjectGrid").css("display", "none");
                                $("#divPlanProject_PlanProjectDetailForm").css("display", "none");
                                $("#divPlanProject_FilePicker").css("display", "none");
                            }, 150);
                            setTimeout(function () {
                                $("#divPlanProject_Disabled").css("display", "block");
                            }, 333);
                        }
                    break;
                default:  // DEFAULT LOAD ALL
                    viewAdmin.onLoadDocManagerTab();
                    viewAdmin.onLoadRecResponseTab();
                    viewAdmin.onLoadUserGrid();
                    break;
            }
        }
    },

    onLoadDocManagerTab: function () {
        viewAdmin.messageDoc("");
        var tempTab = viewAdmin.currentTab;
        switch (tempTab) {
            case "9": case "782": case "791":
                viewAdmin.collDoc = new es.objects.ViewCCAdminWindowDocManagerFireCollection();
                es.dataProvider.baseURL = SITEBASEURL + VIEWSERVERENDPOINT;
                if (!viewAdmin.collDoc.GetFireDocInfoByGuid(viewAdmin.gSafeGuid)) { viewAdmin.docManagerLoaded = true; } else { viewAdmin.docManagerLoaded = false; }
                break;
            case "10": case "783": case "792":
                viewAdmin.collDoc = new es.objects.ViewCCAdminWindowDocManagerBMCollection();
                es.dataProvider.baseURL = SITEBASEURL + VIEWSERVERENDPOINT;
                if (!viewAdmin.collDoc.GetBMDocInfoByGuid(viewAdmin.gSafeGuid)) { viewAdmin.docManagerLoaded = true; } else { viewAdmin.docManagerLoaded = false; }
                break;
            case "11": case "784": case "793":
                viewAdmin.collDoc = new es.objects.ViewCCAdminWindowDocManagerIRCollection();
                es.dataProvider.baseURL = SITEBASEURL + VIEWSERVERENDPOINT;
                if (!viewAdmin.collDoc.GetIRDocInfoByGuid(viewAdmin.gSafeGuid)) { viewAdmin.docManagerLoaded = true; } else { viewAdmin.docManagerLoaded = false; }
                break;
            case "12": case "785": case "794":
                viewAdmin.collDoc = new es.objects.ViewCCAdminWindowDocManagerJurisCollection();
                es.dataProvider.baseURL = SITEBASEURL + VIEWSERVERENDPOINT;
                if (!viewAdmin.collDoc.GetJurisDocInfoByGuid(viewAdmin.gSafeGuid)) { viewAdmin.docManagerLoaded = true; } else { viewAdmin.docManagerLoaded = false; }
                viewAdmin.enableDocumentTopButtons(false);
                $("#lblMessageDoc").removeClass("messageError");
                $("#lblMessageDoc").addClass("messageNotice");
                viewAdmin.messageDoc(viewAdmin.objAdminLanguageLabels().lblThisPracticeNotAvailable);
                break;
            case "678": case "790": case "799":
                // NATURAL HAZARDS
                viewAdmin.collDoc = new es.objects.ViewCCAdminWindowDocManagerNHCollection();
                es.dataProvider.baseURL = SITEBASEURL + VIEWSERVERENDPOINT;
                if (!viewAdmin.collDoc.GetNHDocInfoByGuid(viewAdmin.gSafeGuid)) { viewAdmin.docManagerLoaded = true; } else { viewAdmin.docManagerLoaded = false; }
                break;
            case "665": case "789": case "798": case "869":
                // DIVERSIFIED SERVICES
                viewAdmin.collDoc = new es.objects.ViewCCAdminWindowDocManagerDiversifiedCollection();
                es.dataProvider.baseURL = SITEBASEURL + VIEWSERVERENDPOINT;
                if (!viewAdmin.collDoc.GetDivServDocInfoByGuid(viewAdmin.gSafeGuid)) { viewAdmin.docManagerLoaded = true; } else { viewAdmin.docManagerLoaded = false; }
                break;
            case "881": case "882": case "899":
                // PROCESS SAFETY
                viewAdmin.collDoc = new es.objects.ViewCCAdminWindowDocManagerPSCollection();
                es.dataProvider.baseURL = SITEBASEURL + VIEWSERVERENDPOINT;
                if (!viewAdmin.collDoc.GetPSDocInfoByGuid(viewAdmin.gSafeGuid)) { viewAdmin.docManagerLoaded = true; } else { viewAdmin.docManagerLoaded = false; }
                break;
            default:
                viewAdmin.collDoc = new es.objects.ViewCCAdminWindowDocManagerFireCollection();
                es.dataProvider.baseURL = SITEBASEURL + VIEWSERVERENDPOINT;
                if (!viewAdmin.collDoc.GetFireDocInfoByGuid(viewAdmin.gSafeGuid)) { viewAdmin.docManagerLoaded = true; } else { viewAdmin.docManagerLoaded = false; }
                break;
        }

        if (viewAdmin.collDoc()[0].FileNo() == "not found") {
            viewAdmin.objDoc(viewAdmin.collDoc()[0]);
            viewAdmin.objDoc().FileNo("Not Available");
            Admin_Document_DateMailedToClient.value("");
            Admin_Document_DateOfInspection.value("");
            viewAdmin.objDoc().LinkToReport("");
            viewAdmin.objDoc().LinkToReport2("");
            viewAdmin.objDoc().LinkToDiagram("");
            viewAdmin.enableDocumentSelect(false);
            $('#btnSave_DocumentManager').addClass('grcGreenDisabledBtn');
            $('#btnSelectLEReport').addClass('grcBlueDisabledBtn');
            $('#btnClearURLEReport').addClass('grcBlueDisabledBtn');
            $('#btnClearDiagram').addClass('grcBlueDisabledBtn');
            $('#btnSelectDiagram').addClass('grcBlueDisabledBtn');
            $('#btnSelectERReport').addClass('grcBlueDisabledBtn');
            $('#btnClearERReport').addClass('grcBlueDisabledBtn');
            viewAdmin.enableDocumentDelete(false);
            $('#btnDelete_DocumentManager').addClass('grcRedDisabledBtn');
            viewAdmin.enableDocumentTopButtons(false);
        } else {
            viewAdmin.objDoc(viewAdmin.collDoc()[0]);
            if (viewAdmin.objDoc().DateMailedToClient() == undefined || viewAdmin.objDoc().DateMailedToClient() == "Mon Jan 1 00:00:00 EST 1900") { Admin_Document_DateMailedToClient.value(""); } else { Admin_Document_DateMailedToClient.value(viewAdmin.objDoc().DateMailedToClient()); }
            if (viewAdmin.objDoc().DateOfInspection() == undefined || viewAdmin.objDoc().DateOfInspection() == "Mon Jan 1 00:00:00 EST 1900") { Admin_Document_DateOfInspection.value(""); } else { Admin_Document_DateOfInspection.value(viewAdmin.objDoc().DateOfInspection()); }
            if (viewAdmin.objDoc().LinkToReport() == "0") { viewAdmin.objDoc().LinkToReport(""); }
            if (viewAdmin.objDoc().LinkToReport2() == "0") { viewAdmin.objDoc().LinkToReport2(""); }
            if (viewAdmin.objDoc().LinkToDiagram() == "0") { viewAdmin.objDoc().LinkToDiagram(""); }
            viewAdmin.enableDocumentSelect(false);
            $('#btnSave_DocumentManager').addClass('grcGreenDisabledBtn');
            $('#btnSelectLEReport').addClass('grcBlueDisabledBtn');
            $('#btnClearURLEReport').addClass('grcBlueDisabledBtn');
            $('#btnClearDiagram').addClass('grcBlueDisabledBtn');
            $('#btnSelectDiagram').addClass('grcBlueDisabledBtn');
            $('#btnSelectERReport').addClass('grcBlueDisabledBtn');
            $('#btnClearERReport').addClass('grcBlueDisabledBtn');
            viewAdmin.enableDocumentDelete(false);
            $('#btnDelete_DocumentManager').addClass('grcRedDisabledBtn');
        }
    },

    onLoadFirePlanProjectGrid: function () {
        es.dataProvider.baseURL = SITEBASEURL + VIEWSERVERENDPOINT;
        if (!viewAdmin.collPlanProjectGrid.GetFirePlanReviewGrid(viewAdmin.gSafeGuid)) {
            if (viewAdmin.collPlanProjectGrid()[0].FileNo() == "not found") {
                viewAdmin.collPlanProjectGrid([]);
            }
            viewAdmin.createPlanProjectGridColumnTitles();
            viewAdmin.createPlanProjectGridDataSourceObject();
            viewAdmin.createPlanProjectGridObject();
            viewAdmin.buildPlanProjectGrid();
            gridPlanProject.dataSource.data(viewAdmin.collGridPlanProjectDS());
            gridPlanProject.dataSource.page(1);
        } else {
            alert("Error while loading Plan Project Review grid.");
        }
    },

    onLoadBMPlanProjectGrid: function () {
        es.dataProvider.baseURL = SITEBASEURL + VIEWSERVERENDPOINT;
        if (!viewAdmin.collPlanProjectGrid.GetBMPlanReviewGrid(viewAdmin.gSafeGuid)) {
            if (viewAdmin.collPlanProjectGrid()[0].FileNo() == "not found") {
                viewAdmin.collPlanProjectGrid([]);
            }
            viewAdmin.createPlanProjectGridColumnTitles();
            viewAdmin.createPlanProjectGridDataSourceObject();
            viewAdmin.createPlanProjectGridObject();
            viewAdmin.buildPlanProjectGrid();
            gridPlanProject.dataSource.data(viewAdmin.collGridPlanProjectDS());
            gridPlanProject.dataSource.page(1);
        } else {
            alert("Error while loading Plan Project Review grid.");
        }
    },

    onLoadAllPlanProjectGrid: function () {
        es.dataProvider.baseURL = SITEBASEURL + VIEWSERVERENDPOINT;
        if (!viewAdmin.collPlanProjectGrid.GetAllPlanReviewGrid(viewAdmin.gSafeGuid)) {
            if (viewAdmin.collPlanProjectGrid()[0].FileNo() == "not found") {
                viewAdmin.collPlanProjectGrid([]);
            }
            viewAdmin.createPlanProjectGridColumnTitles();
            viewAdmin.createPlanProjectGridDataSourceObject();
            viewAdmin.createPlanProjectGridObject();
            viewAdmin.buildPlanProjectGrid();
            gridPlanProject.dataSource.data(viewAdmin.collGridPlanProjectDS());
            gridPlanProject.dataSource.page(1);
        } else {
            alert("Error while loading Plan Project Review grid.");
        }
    },

    onLoadPlanProjectFileNoList: function () {
        var tempTab = viewAdmin.currentTab;
        var tempFileNoList = undefined;
        var tempArray = new Array();
        switch (tempTab) {
            case "9": case "782": case "791":
                tempFileNoList = new es.objects.ViewCCFirePlanReviewCollection;
                es.dataProvider.baseURL = SITEBASEURL + VIEWSERVERENDPOINT;
                if (!tempFileNoList.GetFirePlanReviewFileNoList(viewAdmin.gSafeGuid)) {
                    tempArray.push("");
                    for (i = 0; i < tempFileNoList().length; i++) {
                        tempArray.push(tempFileNoList()[i].FileNo());
                    }
                    viewAdmin.planProjectFileNoArray(tempArray);
                } else {
                    alert("Error while loading Plan Project Review file number list.");
                }
                break;
            case "10": case "783": case "792":
                tempFileNoList = new es.objects.ViewCCBMPlanReviewCollection;
                es.dataProvider.baseURL = SITEBASEURL + VIEWSERVERENDPOINT;
                if (!tempFileNoList.GetBMPlanReviewFileNoList(viewAdmin.gSafeGuid)) {
                    tempArray.push("");
                    for (i = 0; i < tempFileNoList().length; i++) {
                        tempArray.push(tempFileNoList()[i].FileNo());
                    }
                    viewAdmin.planProjectFileNoArray(tempArray);
                } else {
                    alert("Error while loading Plan Project Review file number list.");
                }
                break;
            default:
                tempFileNoList = new es.objects.ViewCCAllPlanReviewCollection;
                es.dataProvider.baseURL = SITEBASEURL + VIEWSERVERENDPOINT;
                if (!tempFileNoList.GetAllPlanReviewFileNoList(viewAdmin.gSafeGuid)) {
                    tempArray.push("");
                    for (i = 0; i < tempFileNoList().length; i++) {
                        tempArray.push(tempFileNoList()[i].FileNo());
                    }
                    viewAdmin.planProjectFileNoArray(tempArray);
                } else {
                    alert("Error while loading Plan Project Review file number list.");
                }
                break;
        }
    },

    onLoadRecResponseTab: function () {
        //// FIND WHICH COLLECTION TYPE WE NEED        
        //// THEN LOAD THE COLLECTION
        $("#lblMessageRec").addClass("messageNotice");
        viewAdmin.messageRec("");
        viewAdmin.visibleCboRecResponse_Hazard(false);
        viewAdmin.cboHazardValue("");
        var newHazard = "";
        var tempTab = viewAdmin.currentTab;
        var tempHemisphere = getHemisphere(calculate_time_zone());
        switch (tempTab) {
            case "9": case "782": case "791":
                viewAdmin.collRec = new es.objects.ViewCCAdminWindowRecResponseFireCollection();
                es.dataProvider.baseURL = SITEBASEURL + VIEWSERVERENDPOINT;
                if (!viewAdmin.collRec.GetFireInfoByGuid(viewAdmin.gSafeGuid + "|" + tempHemisphere)) { viewAdmin.recLoaded = true; } else { viewAdmin.recLoaded = false; }
                break;
            case "10": case "783": case "792":
                viewAdmin.collRec = new es.objects.ViewCCAdminWindowRecResponseBMCollection();
                es.dataProvider.baseURL = SITEBASEURL + VIEWSERVERENDPOINT;
                if (!viewAdmin.collRec.GetBMInfoByGuid(viewAdmin.gSafeGuid + "|" + tempHemisphere)) { viewAdmin.recLoaded = true; } else { viewAdmin.recLoaded = false; }
                break;
            case "11": case "784": case "793":
                viewAdmin.collRec = new es.objects.ViewCCAdminWindowRecResponseIRCollection();
                es.dataProvider.baseURL = SITEBASEURL + VIEWSERVERENDPOINT;
                if (!viewAdmin.collRec.GetIRInfoByGuid(viewAdmin.gSafeGuid + "|" + tempHemisphere)) { viewAdmin.recLoaded = true; } else { viewAdmin.recLoaded = false; }
                break;
            case "12": case "785": case "794":
                viewAdmin.collRec = new es.objects.ViewCCAdminWindowRecResponseJurisCollection();
                es.dataProvider.baseURL = SITEBASEURL + VIEWSERVERENDPOINT;
                if (!viewAdmin.collRec.GetJurisInfoByGuid(viewAdmin.gSafeGuid)) { viewAdmin.recLoaded = true; } else { viewAdmin.recLoaded = false; }
                break;
            case "678": case "790": case "799":
                // NATURAL HAZARDS
                viewAdmin.visibleCboRecResponse_Hazard(true);
                viewAdmin.cboHazardValue(viewAdmin.cboHazard()[0]);
                newHazard = "";
                viewAdmin.collRec = new es.objects.ViewCCAdminWindowRecResponseNHCollection();
                es.dataProvider.baseURL = SITEBASEURL + VIEWSERVERENDPOINT;
                if (!viewAdmin.collRec.GetNHInfoByGuid(viewAdmin.gSafeGuid + "|" + "NatHaz" + "|" + tempHemisphere)) { viewAdmin.recLoaded = true; } else { viewAdmin.recLoaded = false; }
                // SET THE HAZARD IF EXIST
                if (viewAdmin.collRec()[0].Hazard() !== undefined && viewAdmin.collRec()[0].Hazard() !== null && viewAdmin.collRec()[0].Hazard().length > 0) {
                    newHazard = viewAdmin.collRec()[0].Hazard();
                } else {
                    newHazard = viewAdmin.cboHazard()[0];
                }
                break;
            case "665": case "789": case "798": case "869":
                // DIVERSIFIED SERVICES
                viewAdmin.collRec = new es.objects.ViewCCAdminWindowRecResponseDiversifiedCollection();
                es.dataProvider.baseURL = SITEBASEURL + VIEWSERVERENDPOINT;
                if (!viewAdmin.collRec.GetDivServInfoByGuid(viewAdmin.gSafeGuid + "|" + tempHemisphere)) { viewAdmin.recLoaded = true; } else { viewAdmin.recLoaded = false; }
                break;
            case "881": case "882": case "899":
                // PROCESS SAFETY
                viewAdmin.collRec = new es.objects.ViewCCAdminWindowRecResponsePSCollection();
                es.dataProvider.baseURL = SITEBASEURL + VIEWSERVERENDPOINT;
                if (!viewAdmin.collRec.GetPSInfoByGuid(viewAdmin.gSafeGuid + "|" + tempHemisphere)) { viewAdmin.recLoaded = true; } else { viewAdmin.recLoaded = false; }
                break;
        }

        //// POPULATE THE PAGE
        var newFileNo = getFileNo(viewAdmin.gSafeGuid);
        var newPracticeCode = global_PracticeCode;
        var newTab = viewAdmin.currentTab;

        //// CHECK IF NO RRLOG WAS FOUND
        if (viewAdmin.collRec()[0].RRLogGuid() == "not found") {
            viewAdmin.collRec()[0].FileNo(newFileNo);
            viewAdmin.collRec()[0].CurrentLink("");
            viewAdmin.collRec()[0].Sender("");
            viewAdmin.collRec()[0].DateRecEmailed("");
            viewAdmin.collRec()[0].PracticeCode(global_PracticeCode);
            viewAdmin.collRec()[0].Hazard(newHazard);
            viewAdmin.collRec()[0].InspectionEmailedDate("");
            viewAdmin.collRec()[0].LinkToReport("");
            viewAdmin.collRec()[0].Activity("");
            viewAdmin.objRec(viewAdmin.collRec()[0]);
        } else {
            viewAdmin.objRec(viewAdmin.collRec()[0]);
        }

        //// CHECK IF PRACTICE CODE IS MISSING
        if (viewAdmin.collRec()[0].PracticeCode() == 0) {
            viewAdmin.collRec()[0].PracticeCode(newPracticeCode);
        }

        //// CHECK IF THE CLIENT HAS AUTO REC ENABLED
        if (!getRecAutoFollowup(viewAdmin.gSafeGuid)) {
            viewAdmin.enableResendRecResponseEmail(false);
            $('#btnReSendRecEmail').addClass('grcBlueDisabledBtn');
            viewAdmin.enableSendRecResponseEmail(false);
            $('#btnSendRecEmail').addClass('grcBlueDisabledBtn');
            $("#Admin_RecResponse_RecipientsFullName").attr("readonly", "readonly");
            $("#Admin_RecResponse_RecipientsEmailAddress").attr("readonly", "readonly");
            $("#Admin_RecResponse_RecipientsFullName").removeClass("editRequired");
            $("#Admin_RecResponse_RecipientsEmailAddress").removeClass("editRequired");
            $("#lblMessageRec").removeClass("messageError");
            $("#lblMessageRec").addClass("messageNotice");
            viewAdmin.enableCboRecResponse_Hazard(false);
            cboRecResponse_Hazard.find(".editRequired").removeClass("editRequired").addClass("noedit");
            viewAdmin.cboHazardValue("");
            viewAdmin.messageRec("The Auto Rec. feature is disabled for this client.");
        } else {

            //// CHECK IF THERE ARE NO EXISTING RECOMMENDATIONS
            if (viewAdmin.objRec().RecCount() < 1) {
                viewAdmin.enableResendRecResponseEmail(false);
                $('#btnReSendRecEmail').addClass('grcBlueDisabledBtn');
                viewAdmin.enableSendRecResponseEmail(false);
                $('#btnSendRecEmail').addClass('grcBlueDisabledBtn');
                $("#Admin_RecResponse_RecipientsFullName").attr("readonly", "readonly");
                $("#Admin_RecResponse_RecipientsEmailAddress").attr("readonly", "readonly");
                $("#Admin_RecResponse_RecipientsFullName").removeClass("editRequired");
                $("#Admin_RecResponse_RecipientsEmailAddress").removeClass("editRequired");
                $("#lblMessageRec").removeClass("messageError");
                $("#lblMessageRec").addClass("messageNotice");
                viewAdmin.enableCboRecResponse_Hazard(false);
                cboRecResponse_Hazard.find(".editRequired").removeClass("editRequired").addClass("noedit");
                viewAdmin.cboHazardValue("");
                viewAdmin.messageRec("There are no Recommendations available for this location.");
            } else {

                //// CHECK IF STATUS DATES ARE NOT MATCHING EACH OTHER (INCORRECT DATA)
                if (viewAdmin.objRec().StatusDateCount() > 1) {
                    viewAdmin.enableResendRecResponseEmail(false);
                    $('#btnReSendRecEmail').addClass('grcBlueDisabledBtn');
                    viewAdmin.enableSendRecResponseEmail(false);
                    $('#btnSendRecEmail').addClass('grcBlueDisabledBtn');
                    $("#Admin_RecResponse_RecipientsFullName").attr("readonly", "readonly");
                    $("#Admin_RecResponse_RecipientsEmailAddress").attr("readonly", "readonly");
                    $("#Admin_RecResponse_RecipientsFullName").removeClass("editRequired");
                    $("#Admin_RecResponse_RecipientsEmailAddress").removeClass("editRequired");
                    $("#lblMessageRec").removeClass("messageError");
                    $("#lblMessageRec").addClass("messageNotice");
                    viewAdmin.enableCboRecResponse_Hazard(false);
                    cboRecResponse_Hazard.find(".editRequired").removeClass("editRequired").addClass("noedit");
                    viewAdmin.cboHazardValue("");
                    viewAdmin.messageRec("Unable to send a Rec. Response email. Please check Rec. Status Dates.");
                } else {

                    //// CHECK IF STATUS DATE IS DIFFERENT FROM INSPECTION DATE
                    if (viewAdmin.objRec().InspectionDate().toString() != viewAdmin.objRec().LatestStatusDate().toString()) {
                        viewAdmin.enableResendRecResponseEmail(false);
                        $('#btnReSendRecEmail').addClass('grcBlueDisabledBtn');
                        viewAdmin.enableSendRecResponseEmail(false);
                        $('#btnSendRecEmail').addClass('grcBlueDisabledBtn');
                        $("#Admin_RecResponse_RecipientsFullName").attr("readonly", "readonly");
                        $("#Admin_RecResponse_RecipientsEmailAddress").attr("readonly", "readonly");
                        $("#Admin_RecResponse_RecipientsFullName").removeClass("editRequired");
                        $("#Admin_RecResponse_RecipientsEmailAddress").removeClass("editRequired");
                        $("#lblMessageRec").removeClass("messageError");
                        $("#lblMessageRec").addClass("messageNotice");
                        viewAdmin.enableCboRecResponse_Hazard(false);
                        cboRecResponse_Hazard.find(".editRequired").removeClass("editRequired").addClass("noedit");
                        viewAdmin.cboHazardValue("");
                        viewAdmin.messageRec("Unable to send a Rec. Response email. The Inspection Date and Status Date do not match.");
                    } else {

                        //// VALIDATION PASSED, OPEN THE FORM FOR USE
                        $("#Admin_RecResponse_RecipientsFullName").removeAttr("readonly");
                        $("#Admin_RecResponse_RecipientsEmailAddress").removeAttr("readonly");
                        $("#Admin_RecResponse_RecipientsFullName").addClass("editRequired");
                        $("#Admin_RecResponse_RecipientsEmailAddress").addClass("editRequired");
                        viewAdmin.enableCboRecResponse_Hazard(true);                                     
                        cboRecResponse_Hazard.find(".noedit").removeClass("noedit").addClass("editRequired");
                        viewAdmin.cboHazardValue(newHazard);
                        for (var x = 0; x < viewAdmin.cboHazard().length ; x++) {
                            if (viewAdmin.cboHazard()[x].toLowerCase() == newHazard.toLowerCase()) {
                                viewAdmin.cboHazardValue(viewAdmin.cboHazard()[x]);
                                newHazard = viewAdmin.cboHazard()[x];
                                break;
                            }
                        }
                        //if ((viewAdmin.objRec().CurrentLink() != undefined && viewAdmin.objRec().CurrentLink() != "") && (viewAdmin.objRec().LinkActive() != undefined && viewAdmin.objRec().LinkActive() == true) && (viewAdmin.objRec().Hazard() == newHazard)) {
                        if ((viewAdmin.objRec().LinkActive() != undefined && viewAdmin.objRec().LinkActive() == true) && (viewAdmin.objRec().DateRecEmailed() >= viewAdmin.objRec().LatestStatusDate())) { //&& (viewAdmin.objRec().Hazard() == newHazard)) {
                            viewAdmin.enableResendRecResponseEmail(true);
                            $('#btnReSendRecEmail').removeClass('grcBlueDisabledBtn');
                            viewAdmin.enableSendRecResponseEmail(true);
                            $('#btnSendRecEmail').removeClass('grcBlueDisabledBtn');
                        } else {
                            viewAdmin.enableResendRecResponseEmail(false);
                            $('#btnReSendRecEmail').addClass('grcBlueDisabledBtn');
                            viewAdmin.enableSendRecResponseEmail(true);
                            $('#btnSendRecEmail').removeClass('grcBlueDisabledBtn');
                        }
                    }
                }
            }
        }

        //// UPDATE PICKERS
        if (viewAdmin.objRec().InspectionDate() == "Mon Jan 1 00:00:00 EST 1900") { Admin_RecResponse_DateOfInspection.value(""); } else { Admin_RecResponse_DateOfInspection.value(viewAdmin.objRec().InspectionDate()); }
        if (viewAdmin.objRec().InspectionEmailedDate() == "Mon Jan 1 00:00:00 EST 1900") { Admin_RecResponse_DateMailedToClient.value(""); } else { Admin_RecResponse_DateMailedToClient.value(viewAdmin.objRec().InspectionEmailedDate()); }
        if (viewAdmin.objRec().DateRecEmailed() == "Mon Jan 1 00:00:00 EST 1900") { Admin_RecResponse_LastEmailSentOn.value(""); } else { Admin_RecResponse_LastEmailSentOn.value(viewAdmin.objRec().DateRecEmailed()); }
    },
    //// END DATA LOADING FUNCTIONS
    ////////////////////////


    ////////////////////////
    ////////////////////////
    //// IMPORT FUNCTIONS
    onCheckBox: function () {
        if (!viewAdmin.chkLoadCOPE() && !viewAdmin.chkLoadFacilityData() && !viewAdmin.chkLoadRecInfo() && !viewAdmin.chkLoadRatingInfo() && !viewAdmin.chkLoadRetailInfo() && !viewAdmin.chkLoadNatHazDataInfo() && !viewAdmin.chkLoadNatHazModelData()) {
            viewAdmin.enableImport(false);
            $('#btnImport').addClass('grcBlueDisabledBtn');
        } else {
            if ($(".k-widget.k-upload").find("ul").length > 0) {
                viewAdmin.enableImport(true);
                $('#btnImport').removeClass('grcBlueDisabledBtn');
            }
        }
        return true;
    },

    onUploadSelectNone: function () {
        viewAdmin.chkLoadCOPE(false);
        viewAdmin.chkLoadFacilityData(false);
        viewAdmin.chkLoadNatHazDataInfo(false);
        viewAdmin.chkLoadNatHazModelData(false);
        viewAdmin.chkLoadRecInfo(false);
        viewAdmin.chkLoadRatingInfo(false);
        viewAdmin.chkLoadRetailInfo(false);
        viewAdmin.enableImport(false);
        $('#btnImport').addClass('grcBlueDisabledBtn');
        viewAdmin.messageImportLabel("");
    },

    onUploadSelectAll: function () {
        viewAdmin.messageImportLabel("");
        var tempTab = viewAdmin.currentTab;
        switch (tempTab) {
            case "9": case "782": case "791":
                viewAdmin.chkLoadCOPE(true);
                viewAdmin.chkLoadFacilityData(false);
                viewAdmin.chkLoadNatHazDataInfo(true);
                viewAdmin.chkLoadNatHazModelData(true);
                viewAdmin.chkLoadRecInfo(true);
                viewAdmin.chkLoadRatingInfo(true);
                viewAdmin.chkLoadRetailInfo(true);
                break;
            case "10": case "783": case "792":
                viewAdmin.chkLoadCOPE(false);
                viewAdmin.chkLoadFacilityData(true);
                viewAdmin.chkLoadNatHazDataInfo(false);
                viewAdmin.chkLoadNatHazModelData(false);
                viewAdmin.chkLoadRecInfo(true);
                viewAdmin.chkLoadRatingInfo(true);
                viewAdmin.chkLoadRetailInfo(false);
                break;
            case "11": case "784": case "793":
                viewAdmin.chkLoadCOPE(false);
                viewAdmin.chkLoadFacilityData(false);
                viewAdmin.chkLoadNatHazDataInfo(false);
                viewAdmin.chkLoadNatHazModelData(false);
                viewAdmin.chkLoadRecInfo(false);
                viewAdmin.chkLoadRatingInfo(false);
                viewAdmin.chkLoadRetailInfo(false);
                break;
            case "12": case "785": case "794":
                viewAdmin.chkLoadCOPE(false);
                viewAdmin.chkLoadFacilityData(false);
                viewAdmin.chkLoadNatHazDataInfo(false);
                viewAdmin.chkLoadNatHazModelData(false);
                viewAdmin.chkLoadRecInfo(false);
                viewAdmin.chkLoadRatingInfo(false);
                viewAdmin.chkLoadRetailInfo(false);
                break;
            case "678": case "790": case "799":
                // NATURAL HAZARDS
                viewAdmin.chkLoadCOPE(true);
                viewAdmin.chkLoadFacilityData(false);
                viewAdmin.chkLoadNatHazDataInfo(true);
                viewAdmin.chkLoadNatHazModelData(true);
                viewAdmin.chkLoadRecInfo(true);
                viewAdmin.chkLoadRatingInfo(true);
                viewAdmin.chkLoadRetailInfo(false);
                break;
            case "665": case "789": case "798": case "869":
                // DIVERSIFIED SERVICES
                viewAdmin.chkLoadCOPE(true);
                viewAdmin.chkLoadFacilityData(false);
                viewAdmin.chkLoadNatHazDataInfo(true);
                viewAdmin.chkLoadNatHazModelData(true);
                viewAdmin.chkLoadRecInfo(true);
                viewAdmin.chkLoadRatingInfo(true);
                viewAdmin.chkLoadRetailInfo(true);
                break;
        }

        if ($(".k-widget.k-upload").find("ul").length > 0) {
            viewAdmin.enableImport(true);
            $('#btnImport').removeClass('grcBlueDisabledBtn');
        }
    },

    onUploadSelect: function (e) {
        //// CLEAR OUT PREVIOUS MESSAGE
        viewAdmin.messageImport("Results...");
        viewAdmin.messageImportLabel("");

        //// CREATE CLICK EVENT FOR IMPORT BUTTON AND REMOVE CANNED UPLOAD BUTTON
        $("#btnImport").click(function (event) {
            viewAdmin.messageImport(viewAdmin.objAdminLanguageLabels().lblLoading);
            viewAdmin.enableImport(false);
            $('#btnImport').addClass('grcBlueDisabledBtn');
            viewAdmin.enableCloseCancelContinue(false);
            $(document).find(".k-upload-selected").trigger("click");
        });

        //// ENABLE BUTTONS
        viewAdmin.enableImport(true);
        $('#btnImport').removeClass('grcBlueDisabledBtn');

        //// VALIDATION ON CHECKBOXES
        if (!viewAdmin.chkLoadCOPE() && !viewAdmin.chkLoadFacilityData() && !viewAdmin.chkLoadRecInfo() && !viewAdmin.chkLoadRatingInfo() && !viewAdmin.chkLoadRetailInfo() && !viewAdmin.chkLoadNatHazDataInfo() && !viewAdmin.chkLoadNatHazModelData()) {
            viewAdmin.messageImport(viewAdmin.objAdminLanguageLabels().lblNoCheckboxesSelected);
            viewAdmin.enableCloseCancelContinue(true);
            viewAdmin.enableImport(false);
            $('#btnImport').addClass('grcBlueDisabledBtn');
        }

        //// VALIDATION ON FILE EXTENSION
        if (e.files[0].extension.toLowerCase() != ".csv" && e.files[0].extension.toLowerCase() != ".xls" && e.files[0].extension.toLowerCase() != ".xlsx" && e.files[0].extension.toLowerCase() != ".xlsm") {
            viewAdmin.messageImport(viewAdmin.objAdminLanguageLabels().lblIncorrectFileFormat);
            viewAdmin.enableCloseCancelContinue(true);
            viewAdmin.enableImport(false);
            $('#btnImport').addClass('grcBlueDisabledBtn');
            e.preventDefault();
        }
    },

    onUploadProgress: function (e) {
        viewAdmin.uploadProgress(e.percentComplete);
    },

    onUpload: function (e) {
        viewAdmin.messageImportLabel("");

        //// BUILD UPLOAD
        var tempMsg = "";
        var tempImportSheet = "";
        var tempFileList = "";

        //// BUILD A STRING OF FILE NAMES
        for (x = 0; e.files.length > x; x++) {
            tempFileList += e.files[x].name + ":";
        }
        if (tempFileList.length > 0) {
            tempMsg += tempFileList.substring(0, tempFileList.length - 1) + "|";
        }

        //// BUILD A STRING OF IMPORT SHEETS
        //// ENUM DATA FROM IMPORT ENGINE
        // CopeData             = 0
        // RecTracking          = 1
        // RatingForm           = 2
        // RetailData           = 3
        // NatHazData           = 4
        // NatHazModelingData   = 5
        // FacilityData         = 6

        if (viewAdmin.chkLoadCOPE()) { tempImportSheet += "0:"; }
        if (viewAdmin.chkLoadRecInfo()) { tempImportSheet += "1:"; }
        if (viewAdmin.chkLoadRatingInfo()) { tempImportSheet += "2:"; }
        if (viewAdmin.chkLoadRetailInfo()) { tempImportSheet += "3:"; }
        if (viewAdmin.chkLoadNatHazDataInfo()) { tempImportSheet += "4:"; }
        if (viewAdmin.chkLoadNatHazModelData()) { tempImportSheet += "5:"; }
        if (viewAdmin.chkLoadFacilityData()) { tempImportSheet += "6:"; }
        if (tempImportSheet.length > 0) {
            tempMsg += tempImportSheet.substring(0, tempImportSheet.length - 1);
        }

        //// PASS THE STRINGS TO THE SERVER
        e.data = {
            ImportFileList: tempFileList.substring(0, tempFileList.length - 1),
            ImportSheet: tempImportSheet.substring(0, tempImportSheet.length - 1),
            ImportStrings: tempMsg,
            ImportGSafeGuid: viewAdmin.gSafeGuid
        };
    },

    onUploadSuccess: function (e) {
        viewAdmin.messageImportLabel("");
        if (e.response == undefined || e.response.result == "") {
            viewAdmin.messageImport("File(s) uploaded successfully.");
        } else {
            viewAdmin.messageImport(e.response.result);
        }
        if (e.response.closeImport.toUpperCase() == "FALSE" && e.response.continueImport.toUpperCase() == "FALSE") {
            $("#lblMessageImport").removeClass("messageNotice");
            $("#lblMessageImport").addClass("messageError");
            viewAdmin.messageImportLabel(viewAdmin.objAdminLanguageLabels().lblPleaseCheckForErrors);
        } else if (e.response != undefined && e.response.closeImport.toUpperCase() == "TRUE") { // VB RETURNS UPPER CASE FIRST LETTER
            viewAdmin.txtCloseCancelContinue_Import(viewAdmin.objAdminLanguageLabels().lblClose);
        } else if (e.response != undefined && e.response.continueImport.toUpperCase() == "TRUE") {
            viewAdmin.txtCloseCancelContinue_Import(viewAdmin.objAdminLanguageLabels().lblContinue);
            $("#lblMessageImport").removeClass("messageError");
            $("#lblMessageImport").addClass("messageNotice");
            viewAdmin.messageImportLabel(viewAdmin.objAdminLanguageLabels().lblPleaseClickContinue);
        }
        viewAdmin.enableImport(false);
        $('#btnImport').addClass('grcBlueDisabledBtn');
        viewAdmin.enableCloseCancelContinue(true);
        $(".k-widget.k-upload").find("ul").remove();
    },

    onUploadError: function (e) {
        var tempResponseText = e.XMLHttpRequest.responseText;
        try {
            tempResponseText = tempResponseText.replace(/\\\\n/g, '');
            tempResponseText = tempResponseText.replace(/\\\\r/g, '');
            tempResponseText = tempResponseText.replace(/\\\n/g, '');
            tempResponseText = tempResponseText.replace(/\\\r/g, '');
            tempResponseText = tempResponseText.replace(/\\n/g, '');
            tempResponseText = tempResponseText.replace(/\\r/g, '');
            //tempResponseText = tempResponseText.replace(/\n/g, '');
            tempResponseText = tempResponseText.replace(/\r/g, '');
            tempResponseText = tempResponseText.replace(/\"/g, '"');
            tempResponseText = tempResponseText.replace(/\n/g, '\\n');
            tempResponseText = tempResponseText.substr(0, tempResponseText.indexOf("}") + 1);
            var tempResponse = $.parseJSON(tempResponseText);
            $("#lblMessageImport").removeClass("messageNotice");
            $("#lblMessageImport").addClass("messageError");
            viewAdmin.messageImportLabel(viewAdmin.objAdminLanguageLabels().lblPleaseCheckForErrors);
            if (tempResponse == undefined || tempResponseText == "") {
                viewAdmin.messageImport("An unknown error occured while uploading your file(s).");
            } else {
                viewAdmin.messageImport(tempResponse.result);
            }
            if (tempResponse != undefined && tempResponse.closeImport.toUpperCase() == "TRUE") { // VB RETURNS UPPER CASE FIRST LETTER
                viewAdmin.txtCloseCancelContinue_Import(viewAdmin.objAdminLanguageLabels().lblClose);
            } else if (tempResponse != undefined && tempResponse.continueImport.toUpperCase() == "TRUE") {
                viewAdmin.txtCloseCancelContinue_Import(viewAdmin.objAdminLanguageLabels().lblContinue);
            }
        } catch (pException) {
            if (tempResponseText == undefined || tempResponseText == "") {
                viewAdmin.messageImport("An unknown error occured while uploading your file(s): " + pException.message);
            } else {
                viewAdmin.messageImport(+pException.message + " | IMPORT RESULTS: " + tempResponseText);
            }
        }
        viewAdmin.enableImport(false);
        $('#btnImport').addClass('grcBlueDisabledBtn');
        viewAdmin.enableCloseCancelContinue(true);
        $(".k-widget.k-upload").find("ul").remove();
    },

    onUploadCancel: function () {
        viewAdmin.messageImportLabel("");
        viewAdmin.enableImport(false);
        $('#btnImport').addClass('grcBlueDisabledBtn');
        viewAdmin.enableCloseCancelContinue(true);
    },

    onCloseCancelContinue_Import: function () {
        viewAdmin.messageImportLabel("");
        if (viewAdmin.txtCloseCancelContinue_Import() == viewAdmin.objAdminLanguageLabels().lblCancel || viewAdmin.txtCloseCancelContinue_Import() == viewAdmin.objAdminLanguageLabels().lblClose) {
            $(".k-widget.k-upload").find("ul").remove();
            viewAdmin.enableImport(false);
            $('#btnImport').addClass('grcBlueDisabledBtn');
            windowAdmin.data("kendoWindow").close();
            windowAdminTabStrip.select(0);
            global_IsAdminWindowOpen = false;
        } else {
            $(".k-widget.k-upload").find("ul").remove();
            viewAdmin.enableImport(false);
            $('#btnImport').addClass('grcBlueDisabledBtn');
            var tab = windowAdminTabStrip.select();
            var nextTab = tab.next();
            windowAdminTabStrip.select(nextTab);
        }
    },
    //// END ADMIN IMPORT FUNCTIONS
    ////////////////////////



    ////////////////////////
    ////////////////////////
    //// REC RESPONSE FUNCTIONS
    onSendRecEmail: function () {
        var todaysDate = new Date();
        var tempGUID = Math.uuid();
        var tempCurrentLink = "_BASE1_RecResponse/Auth/?p1=" + tempGUID;
        var emailBreak = false;
        var tempFileNo = "";
        var tempFilePrefix = "";
        var tempPracticeCode = "";
        var tempHazard = "";
        var tempTab = "";

        //// CLEAR PREVOIUS MESSAGE
        $("#lblMessageRec").addClass("messageNotice");
        viewAdmin.messageRec("");

        //// CHECK FOR SPECIAL CHARS
        if (isInvalidChar(viewAdmin.recRecipientsFullName()) || isInvalidEmail(viewAdmin.recRecipientsEmailAddress())) {
            $("#lblMessageRec").removeClass("messageNotice");
            $("#lblMessageRec").addClass("messageError");
            viewAdmin.messageRec("The full name or email address you entered is invalid. Please try again.");
            emailBreak = true;
        } else {
            //// WRITE TO DATABASE
            //// LOOK UP EXISTING RECORD, IF PRACTICE CODE AND FILENO EXIST THEN WRITE AGAIN
            //// OR CREATE A NEW RECORD
            var tempRRLog = new es.objects.RRLog();

            es.dataProvider.baseURL = SITEBASEURL + DATASERVERENDPOINT;
            if (tempRRLog.loadByPrimaryKey(viewAdmin.objRec().RRLogId())) {
                if (viewAdmin.recLoaded) {
                    //// OVERWRITE THE EXISTING RRLOG
                    tempRRLogID = tempRRLog.Id();
                    tempRRLog.DateStamp(todaysDate);
                    tempRRLog.LinkActivatedDate(undefined);
                    tempRRLog.LinkActivatedByEmail(undefined);
                    tempRRLog.LinkActivatedBy(undefined);
                    tempRRLog.Sender(getUserIdName(viewAdmin.gSafeGuid));
                    tempRRLog.RecipientName(viewAdmin.recRecipientsFullName());
                    tempRRLog.RecipientEmail(viewAdmin.recRecipientsEmailAddress());
                    tempRRLog.LinkActive(true);
                    tempRRLog.Activity("ADMIN");
                    tempRRLog.RFU1Date(undefined);
                    tempRRLog.RFU2Date(undefined);
                    tempRRLog.RFU3Date(undefined);
                    // FIX THE HAZARD IF NEEDED
                    tempTab = viewAdmin.currentTab;
                    switch (tempTab) {
                        case "678": case "790": case "799":
                            tempHazard = viewAdmin.cboHazardValue();
                            tempRRLog.Hazard(tempHazard);
                            break;
                    }
                    //// IF CURRENT LINK OR RRLOGGUID DOES NOT EXIST, MAKE A NEW ONE
                    if (viewAdmin.objRec().RRLogGuid() == undefined || viewAdmin.objRec().CurrentLink() == undefined || viewAdmin.objRec().RRLogGuid().length < 1 || viewAdmin.objRec().CurrentLink().length < 1) {
                        tempRRLog.RRLogGuid(tempGUID);
                        tempRRLog.CurrentLink(tempCurrentLink);
                    } else {
                        tempGUID = tempRRLog.RRLogGuid();
                        tempCurrentLink = tempRRLog.CurrentLink();
                    }
                    tempRRLog.save();
                } else {
                    //// CREATE NEW RRLOG
                    //// GET INFORMATION
                    tempFileNo = getFileNo(viewAdmin.gSafeGuid);
                    tempFilePrefix = getFilePrefix(viewAdmin.gSafeGuid);
                    tempPracticeCode = global_PracticeCode;
                    tempHazard = "";
                    tempTab = viewAdmin.currentTab;
                    switch (tempTab) {
                        case "678": case "790": case "799":
                            tempHazard = viewAdmin.cboHazardValue();
                            break;
                        default:
                            tempHazard = "";
                            break;
                    }
                    tempRRLog.RRLogGuid(tempGUID);
                    tempRRLog.CurrentLink(tempCurrentLink);
                    tempRRLog.FilePrefix(tempFilePrefix);
                    tempRRLog.FileNo(tempFileNo);
                    tempRRLog.PracticeCode(tempPracticeCode);
                    tempRRLog.Hazard(tempHazard);
                    tempRRLog.DateStamp(todaysDate);
                    tempRRLog.LinkActivatedDate(undefined);
                    tempRRLog.LinkActivatedByEmail(undefined);
                    tempRRLog.LinkActivatedBy(undefined);
                    tempRRLog.Sender(getUserIdName(viewAdmin.gSafeGuid));
                    tempRRLog.RecipientName(viewAdmin.recRecipientsFullName());
                    tempRRLog.RecipientEmail(viewAdmin.recRecipientsEmailAddress());
                    tempRRLog.Activity("ADMIN");
                    tempRRLog.LinkActive(true);
                    tempRRLog.LanguagePreference("english");
                    tempRRLog.save();
                }
            } else {
                //alert("Error while creating the log for the Rec Response Email. Please log out and try again.");
                //emailBreak = true;
                //// CREATE NEW RRLOG
                //// GET INFORMATION
                tempFileNo = getFileNo(viewAdmin.gSafeGuid);
                tempFilePrefix = getFilePrefix(viewAdmin.gSafeGuid);
                tempPracticeCode = global_PracticeCode;
                tempHazard = "";
                tempTab = viewAdmin.currentTab;
                switch (tempTab) {
                    case "678": case "790": case "799":
                        tempHazard = viewAdmin.cboHazardValue();
                    default:
                        tempHazard = "";
                        break;
                }
                tempRRLog.RRLogGuid(tempGUID);
                tempRRLog.CurrentLink(tempCurrentLink);
                tempRRLog.FilePrefix(tempFilePrefix);
                tempRRLog.FileNo(tempFileNo);
                tempRRLog.PracticeCode(tempPracticeCode);
                tempRRLog.Hazard(tempHazard);
                tempRRLog.DateStamp(todaysDate);
                tempRRLog.LinkActivatedDate(undefined);
                tempRRLog.LinkActivatedByEmail(undefined);
                tempRRLog.LinkActivatedBy(undefined);
                tempRRLog.Sender(getUserIdName(viewAdmin.gSafeGuid));
                tempRRLog.RecipientName(viewAdmin.recRecipientsFullName());
                tempRRLog.RecipientEmail(viewAdmin.recRecipientsEmailAddress());
                tempRRLog.Activity("ADMIN");
                tempRRLog.LinkActive(true);
                tempRRLog.LanguagePreference("english");
                tempRRLog.save();
            }
        }

        //// SEND REC RESPONSE EMAIL
        //// CALL THE SERVER SIDE EMAIL HANDLER, IF RESPONSE IS SUCCESS THEN OPEN SUCCESS WINDOW, ELSE OPEN FAIL WINDOW
        if (!emailBreak) {
            $.ajax({
                type: "GET",
                async: true,
                cache: false,
                dataType: "text",
                url: "../../RecResponse_{{VER}}/Email/EmailIt_RecResponse01.ashx",
                data: {
                    pGSafeGUID: viewAdmin.gSafeGuid,
                    pRRLogGuid: tempGUID,
                    pCurrentLink: tempCurrentLink,
                    pRecipientFullName: viewAdmin.recRecipientsFullName(),
                    pRecipientEmail: viewAdmin.recRecipientsEmailAddress(),
                    pInspectionDate: viewAdmin.objRec().InspectionDate().format("yyyy-MM-dd"),
                    pCreateNewLink:true
                },
                success: function (data, status) {
                    if (data == "success") {
                        tempRRLog.save();
                        $("#Admin_RecResponse_RecipientsFullName").removeAttr("readonly");
                        $("#Admin_RecResponse_RecipientsEmailAddress").removeAttr("readonly");
                        $("#Admin_RecResponse_RecipientsFullName").addClass("editRequired");
                        $("#Admin_RecResponse_RecipientsEmailAddress").addClass("editRequired");
                        $("#lblMessageRec").removeClass("messageError");
                        $("#lblMessageRec").addClass("messageNotice");
                        viewAdmin.enableCboRecResponse_Hazard(true);
                        cboRecResponse_Hazard.find(".noedit").removeClass("noedit").addClass("editRequired");
                        viewAdmin.cboHazardValue(viewAdmin.cboHazard()[0]);
                        viewAdmin.messageRec("Your email has been sent successfully.");
                        viewAdmin.txtCloseCancelContinue_Rec(viewAdmin.objAdminLanguageLabels().lblClose);
                        viewAdmin.enableSendRecResponseEmail(false);
                        $('#btnSendRecEmail').addClass('grcBlueDisabledBtn');
                        viewAdmin.enableResendRecResponseEmail(true);
                        $('#btnReSendRecEmail').removeClass('grcBlueDisabledBtn');
                    } else {
                        $("#Admin_RecResponse_RecipientsFullName").removeAttr("readonly");
                        $("#Admin_RecResponse_RecipientsEmailAddress").removeAttr("readonly");
                        $("#Admin_RecResponse_RecipientsFullName").addClass("editRequired");
                        $("#Admin_RecResponse_RecipientsEmailAddress").addClass("editRequired");
                        $("#lblMessageRec").removeClass("messageNotice");
                        $("#lblMessageRec").addClass("messageError");
                        viewAdmin.enableCboRecResponse_Hazard(true);
                        cboRecResponse_Hazard.find(".noedit").removeClass("noedit").addClass("editRequired");
                        viewAdmin.cboHazardValue(viewAdmin.cboHazard()[0]);
                        viewAdmin.messageRec("An error has occurred. Your email has NOT been sent.");
                        viewAdmin.txtCloseCancelContinue_Rec(viewAdmin.objAdminLanguageLabels().lblCancel);
                    }
                },
                error: function (data, status) {
                    $("#Admin_RecResponse_RecipientsFullName").removeAttr("readonly");
                    $("#Admin_RecResponse_RecipientsEmailAddress").removeAttr("readonly");
                    $("#Admin_RecResponse_RecipientsFullName").addClass("editRequired");
                    $("#Admin_RecResponse_RecipientsEmailAddress").addClass("editRequired");
                    $("#lblMessageRec").removeClass("messageNotice");
                    $("#lblMessageRec").addClass("messageError");
                    viewAdmin.enableCboRecResponse_Hazard(true);
                    cboRecResponse_Hazard.find(".noedit").removeClass("noedit").addClass("editRequired");
                    viewAdmin.cboHazardValue(viewAdmin.cboHazard()[0]);
                    viewAdmin.messageRec("An error has occurred. Your email has NOT been sent.");
                    viewAdmin.txtCloseCancelContinue_Rec(viewAdmin.objAdminLanguageLabels().lblCancel);
                }
            });
        }
    },

    onReSendRecEmail: function () {
        var todaysDate = new Date();
        var tempGUID = Math.uuid();
        var tempCurrentLink = "";
        var emailBreak = false;

        //// CLEAR PREVOIUS MESSAGE
        $("#lblMessageRec").addClass("messageNotice");
        viewAdmin.messageRec("");

        var tempRRLog = new es.objects.RRLog();
        es.dataProvider.baseURL = SITEBASEURL + DATASERVERENDPOINT;
        if (tempRRLog.loadByPrimaryKey(viewAdmin.objRec().RRLogId())) {
            if (viewAdmin.recLoaded) {
                //// IF CURRENT LINK OR RRLOGGUID DOES NOT EXIST BREAK OUT AND DO NOT SEND
                if ((viewAdmin.objRec().RRLogGuid() == undefined || viewAdmin.objRec().RRLogGuid().length < 1) && (viewAdmin.objRec().CurrentLink() == undefined || viewAdmin.objRec().CurrentLink().length < 1)) {
                    tempCurrentLink = "_BASE1_RecResponse/Auth/?p1=" + tempGUID;
                } else {
                    tempGUID = tempRRLog.RRLogGuid();
                    tempCurrentLink = tempRRLog.CurrentLink();
                }

                //// SAVE THE NEW NAME AND EMAIL
                tempRRLog.RRLogGuid(tempGUID);
                tempRRLog.CurrentLink(tempCurrentLink);
                tempRRLog.Sender(getUserIdName(viewAdmin.gSafeGuid));
                tempRRLog.RecipientName(viewAdmin.recRecipientsFullName());
                tempRRLog.RecipientEmail(viewAdmin.recRecipientsEmailAddress());
                tempRRLog.LinkActive(true);
                tempRRLog.LanguagePreference("english");
                es.dataProvider.baseURL = SITEBASEURL + DATASERVERENDPOINT;
                tempRRLog.save();

                //// CHECK FOR SPECIAL CHARS
                if (isInvalidChar(viewAdmin.recRecipientsFullName()) || isInvalidEmail(viewAdmin.recRecipientsEmailAddress())) {
                    $("#lblMessageRec").removeClass("messageNotice");
                    $("#lblMessageRec").addClass("messageError");
                    viewAdmin.messageRec("The full name or email address you entered is invalid. Please try again.");
                    emailBreak = true;
                } else {

                    //// SEND REC RESPONSE EMAIL
                    if (!emailBreak) {
                        $.ajax({
                            type: "GET",
                            async: true,
                            cache: false,
                            dataType: "text",
                            url: "../../RecResponse_{{VER}}/Email/EmailIt_RecResponse01.ashx",
                            data: {
                                pGSafeGUID: viewAdmin.gSafeGuid,
                                pRRLogGuid: tempGUID,
                                pCurrentLink: tempCurrentLink,
                                pRecipientFullName: viewAdmin.recRecipientsFullName(),
                                pRecipientEmail: viewAdmin.recRecipientsEmailAddress(),
                                pInspectionDate: viewAdmin.objRec().InspectionDate().format("yyyy-MM-dd"),
                                pCreateNewLink: false
                            },
                            success: function (data, status) {
                                if (data == "success") {
                                    //// CONFIRM WITH MESSAGE
                                    $("#Admin_RecResponse_RecipientsFullName").attr("readonly", "readonly");
                                    $("#Admin_RecResponse_RecipientsEmailAddress").attr("readonly", "readonly");
                                    $("#Admin_RecResponse_RecipientsFullName").removeClass("editRequired");
                                    $("#Admin_RecResponse_RecipientsEmailAddress").removeClass("editRequired");
                                    $("#lblMessageRec").removeClass("messageError");
                                    $("#lblMessageRec").addClass("messageNotice");
                                    viewAdmin.enableCboRecResponse_Hazard(false);
                                    cboRecResponse_Hazard.find(".editRequired").removeClass("editRequired").addClass("noedit");
                                    viewAdmin.cboHazardValue("");
                                    viewAdmin.messageRec("Your email has been resent successfully.");
                                    viewAdmin.txtCloseCancelContinue_Rec(viewAdmin.objAdminLanguageLabels().lblClose);
                                    viewAdmin.enableSendRecResponseEmail(false);
                                    $('#btnSendRecEmail').addClass('grcBlueDisabledBtn');
                                    viewAdmin.enableResendRecResponseEmail(false);
                                    $('#btnReSendRecEmail').addClass('grcBlueDisabledBtn');
                                } else {
                                    $("#Admin_RecResponse_RecipientsFullName").removeAttr("readonly");
                                    $("#Admin_RecResponse_RecipientsEmailAddress").removeAttr("readonly");
                                    $("#Admin_RecResponse_RecipientsFullName").addClass("editRequired");
                                    $("#Admin_RecResponse_RecipientsEmailAddress").addClass("editRequired");
                                    $("#lblMessageRec").removeClass("messageNotice");
                                    $("#lblMessageRec").addClass("messageError");
                                    viewAdmin.enableCboRecResponse_Hazard(true);                                     
                                    cboRecResponse_Hazard.find(".noedit").removeClass("noedit").addClass("editRequired");
                                    viewAdmin.cboHazardValue(viewAdmin.cboHazard()[0]);
                                    viewAdmin.messageRec("An error has occurred. Your email has NOT been resent.");
                                    viewAdmin.txtCloseCancelContinue_Rec(viewAdmin.objAdminLanguageLabels().lblCancel);
                                    viewAdmin.enableResendRecResponseEmail(true);
                                    $('#btnReSendRecEmail').removeClass('grcBlueDisabledBtn');
                                }
                            },
                            error: function (data, status) {
                                $("#Admin_RecResponse_RecipientsFullName").removeAttr("readonly");
                                $("#Admin_RecResponse_RecipientsEmailAddress").removeAttr("readonly");
                                $("#Admin_RecResponse_RecipientsFullName").addClass("editRequired");
                                $("#Admin_RecResponse_RecipientsEmailAddress").addClass("editRequired");
                                $("#lblMessageRec").removeClass("messageNotice");
                                $("#lblMessageRec").addClass("messageError");
                                viewAdmin.enableCboRecResponse_Hazard(true);                                     
                                cboRecResponse_Hazard.find(".noedit").removeClass("noedit").addClass("editRequired");
                                viewAdmin.cboHazardValue(viewAdmin.cboHazard()[0]);
                                viewAdmin.messageRec("An error has occurred. Your email has NOT been resent.");
                                viewAdmin.txtCloseCancelContinue_Rec(viewAdmin.objAdminLanguageLabels().lblCancel);
                                viewAdmin.enableResendRecResponseEmail(true);
                                $('#btnReSendRecEmail').removeClass('grcBlueDisabledBtn');
                            }
                        });
                    }
                }
            }
        }
    },

    onCloseCancelContinue_Rec: function () {
        if (viewAdmin.txtCloseCancelContinue_Rec() == viewAdmin.objAdminLanguageLabels().lblCancel || viewAdmin.txtCloseCancelContinue_Rec() == viewAdmin.objAdminLanguageLabels().lblClose) {
            windowAdmin.data("kendoWindow").close();
            windowAdminTabStrip.select(0);
            global_IsAdminWindowOpen = false;
        } else {
            var tab = windowAdminTabStrip.select();
            var nextTab = tab.next();
            windowAdminTabStrip.select(nextTab);
        }
    },

    onClearRecResponse: function () {
        viewAdmin.recRecipientsFullName("");
        viewAdmin.recRecipientsEmailAddress("");
    },

    onBuildAdminLink: function (fileName) {
        buildFileOpenLink(fileName, viewAdmin.gSafeGuid, "", "", false);
    },

    onGoToCurrentLink: function (currentLink) {
        //window.open(currentLink);
    },
    //// END REC RESPONSE FUNCTIONS
    ////////////////////////



    ////////////////////////
    ////////////////////////
    //// DOCUMENT MANAGER FUNCTIONS
    onCloseCancelContinue_Document: function () {
        if (viewAdmin.enableDocumentSelect()) {
            viewAdmin.txtCloseCancelContinue_Document(viewAdmin.objAdminLanguageLabels().lblCancel);
            viewAdmin.objDoc().DateOfInspection(kendo.toString(cancelDoc.DateOfInspection));
            viewAdmin.objDoc().DateMailedToClient(kendo.toString(cancelDoc.DateMailedToClient));
            viewAdmin.objDoc().LinkToReport(cancelDoc.LinkToReport);
            viewAdmin.objDoc().LinkToReport2(cancelDoc.LinkToReport2);
            viewAdmin.objDoc().LinkToDiagram(cancelDoc.LinkToDiagram);
            //Admin_Document_DateOfInspection.value(kendo.toString(viewAdmin.objDoc().DateOfInspection()));
            //Admin_Document_DateMailedToClient.value(kendo.toString(viewAdmin.objDoc().DateMailedToClient()));
            if (viewAdmin.objDoc().DateMailedToClient() == undefined || viewAdmin.objDoc().DateMailedToClient() == "Mon Jan 1 00:00:00 EST 1900") { Admin_Document_DateMailedToClient.value(""); } else { Admin_Document_DateMailedToClient.value(kendo.toString(viewAdmin.objDoc().DateMailedToClient())); }
            if (viewAdmin.objDoc().DateOfInspection() == undefined || viewAdmin.objDoc().DateOfInspection() == "Mon Jan 1 00:00:00 EST 1900") { Admin_Document_DateOfInspection.value(""); } else { Admin_Document_DateOfInspection.value(kendo.toString(viewAdmin.objDoc().DateOfInspection())); }
            viewAdmin.enableDocumentTopButtons(true);
            viewAdmin.enableDocumentSelect(false);
            $('#btnSave_DocumentManager').addClass('grcGreenDisabledBtn');
            $('#btnSelectLEReport').addClass('grcBlueDisabledBtn');
            $('#btnClearURLEReport').addClass('grcBlueDisabledBtn');
            $('#btnClearDiagram').addClass('grcBlueDisabledBtn');
            $('#btnSelectDiagram').addClass('grcBlueDisabledBtn');
            $('#btnSelectERReport').addClass('grcBlueDisabledBtn');
            $('#btnClearERReport').addClass('grcBlueDisabledBtn');
            viewAdmin.enableDocumentDelete(false);
            $('#btnDelete_DocumentManager').addClass('grcRedDisabledBtn');
            viewAdmin.disableDocFields();
        } else {
            if (viewAdmin.txtCloseCancelContinue_Document() == viewAdmin.objAdminLanguageLabels().lblCancel || viewAdmin.txtCloseCancelContinue_Document() == viewAdmin.objAdminLanguageLabels().lblClose) {
                viewAdmin.enableDocumentTopButtons(true);
                viewAdmin.enableDocumentSelect(false);
                $('#btnSave_DocumentManager').addClass('grcGreenDisabledBtn');
                $('#btnSelectLEReport').addClass('grcBlueDisabledBtn');
                $('#btnClearURLEReport').addClass('grcBlueDisabledBtn');
                $('#btnClearDiagram').addClass('grcBlueDisabledBtn');
                $('#btnSelectDiagram').addClass('grcBlueDisabledBtn');
                $('#btnSelectERReport').addClass('grcBlueDisabledBtn');
                $('#btnClearERReport').addClass('grcBlueDisabledBtn');
                viewAdmin.enableDocumentDelete(false);
                $('#btnDelete_DocumentManager').addClass('grcRedDisabledBtn');
                windowAdmin.data("kendoWindow").close();
                windowAdminTabStrip.select(0);
                global_IsAdminWindowOpen = false;
                viewAdmin.disableDocFields();
            } else {
                viewAdmin.enableDocumentTopButtons(true);
                viewAdmin.enableDocumentSelect(false);
                $('#btnSave_DocumentManager').addClass('grcGreenDisabledBtn');
                $('#btnSelectLEReport').addClass('grcBlueDisabledBtn');
                $('#btnClearURLEReport').addClass('grcBlueDisabledBtn');
                $('#btnClearDiagram').addClass('grcBlueDisabledBtn');
                $('#btnSelectDiagram').addClass('grcBlueDisabledBtn');
                $('#btnSelectERReport').addClass('grcBlueDisabledBtn');
                $('#btnClearERReport').addClass('grcBlueDisabledBtn');
                viewAdmin.enableDocumentDelete(false);
                $('#btnDelete_DocumentManager').addClass('grcRedDisabledBtn');
                var tab = windowAdminTabStrip.select();
                var nextTab = tab.next();
                windowAdminTabStrip.select(nextTab);
                viewAdmin.disableDocFields();
            }
        }
        cancelDoc.DateOfInspection = "";
        cancelDoc.DateMailedToClient = "";
        cancelDoc.LinkToReport = "";
        cancelDoc.LinkToReport2 = "";
        cancelDoc.LinkToDiagram = "";
        previousDoc.DateOfInspection = "";
        previousDoc.DateMailedToClient = "";
        previousDoc.LinkToReport = "";
        previousDoc.LinkToReport2 = "";
        previousDoc.LinkToDiagram = "";
    },

    onOpenReportPicker: function (rptMode) {
        switch (rptMode) {
            case 1:
                viewAdmin.selectReportMode = "er";
                break;
            case 2:
                viewAdmin.selectReportMode = "le";
                break;
            case 3:
                viewAdmin.selectReportMode = "diagram";
                break;
            default:
                viewAdmin.selectReportMode = "";
                break;
        }
        if (viewAdmin.selectReportMode == "diagram") {
            $("#divDoc_Form").fadeOut(function () {
                $("#divDoc_DiagramPicker").fadeIn();
            });
        } else {
            $("#divDoc_Form").fadeOut(function () {
                $("#divDoc_ReportPicker").fadeIn();
            });
        }
    },

    onCancelReportPicker: function () {
        $("#divDoc_ReportPicker").fadeOut(function () {
            $("#divDoc_Form").fadeIn();
        });
    },

    onCancelDiagramPicker: function () {
        $("#divDoc_DiagramPicker").fadeOut(function () {
            $("#divDoc_Form").fadeIn();
        });
    },

    onClearDocManager: function () {
        viewAdmin.disableDocFields();
    },

    onAddDocument: function () {
        viewAdmin.messageDoc("");

        //// VALIDATE
        var okToAddDoc = true;
        var tempGripps = new es.objects.ReportArchiveCollection();
        var tempInspectDate = new Date();
        var tempDateMailedToClient = new Date();
        var zReportDate = new Date();
        var zDateToClient = new Date();

        //        es.dataProvider.baseURL = SITEBASEURL + DATASERVERENDPOINT;
        //        if (!tempGripps.GetGrippsDateCompleted(viewAdmin.gSafeGuid + "|" + viewAdmin.objDoc().PracticeCode())) {
        //            if (tempGripps().length > 0) {
        //                zReportDate = tempGripps()[0].ReportDate();
        //                zDateToClient = tempGripps()[0].DateToClient();
        //            }       
        //        tempInspectDate = zReportDate;
        //        tempDateMailedToClient = zDateToClient;
        if (viewAdmin.objDoc().DateOfInspectionCurrent() == undefined || viewAdmin.objDoc().DateOfInspectionCurrent() == null || viewAdmin.objDoc().DateOfInspectionCurrent().toString().indexOf('1899') > -1 || viewAdmin.objDoc().DateOfInspectionCurrent().toString().indexOf('1900') > -1) {
            tempInspectDate = new Date();
            zReportDate = new Date();
        } else {
            tempInspectDate = viewAdmin.objDoc().DateOfInspectionCurrent();
            zReportDate = viewAdmin.objDoc().DateOfInspectionCurrent();
        }
        if (viewAdmin.objDoc().DateMailedToClientCurrent() == undefined || viewAdmin.objDoc().DateMailedToClientCurrent() == null || viewAdmin.objDoc().DateMailedToClientCurrent().toString().indexOf('1899') > -1 || viewAdmin.objDoc().DateMailedToClientCurrent().toString().indexOf('1900') > -1) {
            tempDateMailedToClient = new Date();
            zDateToClient = new Date();
        } else {
            tempDateMailedToClient = viewAdmin.objDoc().DateMailedToClientCurrent();
            zDateToClient = viewAdmin.objDoc().DateMailedToClientCurrent();
        }
        // END NEW ADDITIONAL LOGIC

        if (Admin_Document_DateOfInspection.value() < zReportDate) {
            if (Admin_Document_DateOfInspection.value() != null && Admin_Document_DateOfInspection.value() != undefined && Admin_Document_DateOfInspection.value() != "") {
                okToAddDoc = true;
            } else {
                Admin_Document_DateOfInspection.value(new Date());
                viewAdmin.objDoc().DateOfInspection(new Date());
                tempInspectDate = new Date();
                tempDateMailedToClient = new Date();
                okToAddDoc = true;
            }
        } else {
            var yesno = confirm(viewAdmin.objAdminLanguageLabels().lblDocumentAlreadyExists);
            if (yesno) {
                okToAddDoc = true;
                tempInspectDate = new Date();
                tempDateMailedToClient = new Date();
            } else {
                okToAddDoc = false;
            }
        }
        //        } else {
        //            okToAddDoc = false;
        //            $("#lblMessageDoc").removeClass("messageNotice");
        //            $("#lblMessageDoc").addClass("messageError");
        //            viewAdmin.messageDoc(viewAdmin.objAdminLanguageLabels().lblErrorAddingNew);
        //        }

        //// SETUP FOR ADD
        if (okToAddDoc) {
            viewAdmin.docAddEditMode = "add";
            viewAdmin.enableDocumentTopButtons(false);
            viewAdmin.enableDocumentSelect(true);
            $('#btnSave_DocumentManager').removeClass('grcGreenDisabledBtn');
            $('#btnSelectLEReport').removeClass('grcBlueDisabledBtn');
            $('#btnClearURLEReport').removeClass('grcBlueDisabledBtn');
            $('#btnClearDiagram').removeClass('grcBlueDisabledBtn');
            $('#btnSelectDiagram').removeClass('grcBlueDisabledBtn');
            $('#btnSelectERReport').removeClass('grcBlueDisabledBtn');
            $('#btnClearERReport').removeClass('grcBlueDisabledBtn');
            viewAdmin.enableDocumentDelete(false);
            $('#btnDelete_DocumentManager').addClass('grcRedDisabledBtn');
            viewAdmin.txtCloseCancelContinue_Document(viewAdmin.objAdminLanguageLabels().lblCancel);
            viewAdmin.enableDocFields();
            //// SAVE FIELDS FOR CANCEL AND PREVIOUS
            if (viewAdmin.objDoc().DateOfInspection() == undefined) { cancelDoc.DateOfInspection = null; } else { cancelDoc.DateOfInspection = kendo.toString(viewAdmin.objDoc().DateOfInspection()); }
            if (viewAdmin.objDoc().DateMailedToClient() == undefined) { cancelDoc.DateMailedToClient = null; } else { cancelDoc.DateMailedToClient = kendo.toString(viewAdmin.objDoc().DateMailedToClient()); }
            cancelDoc.LinkToReport = viewAdmin.objDoc().LinkToReport();
            cancelDoc.LinkToReport2 = viewAdmin.objDoc().LinkToReport2();
            cancelDoc.LinkToDiagram = viewAdmin.objDoc().LinkToDiagram();
            if (viewAdmin.objDoc().DateOfInspection() == undefined) { previousDoc.DateOfInspection = null; } else { previousDoc.DateOfInspection = kendo.toString(viewAdmin.objDoc().DateOfInspection()); }
            if (viewAdmin.objDoc().DateMailedToClient() == undefined) { previousDoc.DateMailedToClient = null; } else { previousDoc.DateMailedToClient = kendo.toString(viewAdmin.objDoc().DateMailedToClient()); }
            previousDoc.LinkToReport = viewAdmin.objDoc().LinkToReport();
            previousDoc.LinkToReport2 = viewAdmin.objDoc().LinkToReport2();
            previousDoc.LinkToDiagram = viewAdmin.objDoc().LinkToDiagram();
            //// CLEAR THE FIELDS FOR AN ADD
            if (tempDateMailedToClient == undefined || tempDateMailedToClient == null || tempDateMailedToClient.toString().indexOf('1899') > -1 || tempDateMailedToClient.toString().indexOf('1900') > -1) { Admin_Document_DateMailedToClient.value(new Date()); } else { Admin_Document_DateMailedToClient.value(tempDateMailedToClient); }
            if (tempInspectDate == undefined || tempInspectDate == null || tempInspectDate.toString().indexOf('1899') > -1 || tempInspectDate.toString().indexOf('1900') > -1) { Admin_Document_DateOfInspection.value(new Date()); } else { Admin_Document_DateOfInspection.value(tempInspectDate); }
            viewAdmin.objDoc().LinkToReport("");
            viewAdmin.objDoc().LinkToReport2("");
            //viewAdmin.objDoc().LinkToDiagram(""); // LEAVE ANY EXISTING DIAGRAM SO THE USER DOES NOT HAVE TO LOOK UP AGAIN.
        }
    },

    onEditDocument: function () {
        viewAdmin.messageDoc("");
        if (viewAdmin.collDoc()[0].FileNo() == "not found" || viewAdmin.collDoc()[0].FileNo() == "Not Available") {
            $("#lblMessageDoc").removeClass("messageError");
            $("#lblMessageDoc").addClass("messageNotice");
            viewAdmin.messageDoc(viewAdmin.objAdminLanguageLabels().lblCannotEditDocumentRecord);
        } else {
            viewAdmin.docAddEditMode = "edit";
            viewAdmin.enableDocumentTopButtons(false);
            viewAdmin.enableDocumentSelect(true);
            $('#btnSave_DocumentManager').removeClass('grcGreenDisabledBtn');
            $('#btnSelectLEReport').removeClass('grcBlueDisabledBtn');
            $('#btnClearDiagram').removeClass('grcBlueDisabledBtn');
            $('#btnSelectDiagram').removeClass('grcBlueDisabledBtn');
            $('#btnSelectERReport').removeClass('grcBlueDisabledBtn');
            $('#btnClearERReport').removeClass('grcBlueDisabledBtn');
            viewAdmin.enableDocumentDelete(true);
            $('#btnDelete_DocumentManager').removeClass('grcRedDisabledBtn');
            viewAdmin.txtCloseCancelContinue_Document(viewAdmin.objAdminLanguageLabels().lblCancel);
            viewAdmin.enableDocFields();
            if (viewAdmin.objDoc().DateOfInspection() == undefined) { cancelDoc.DateOfInspection = null; } else { cancelDoc.DateOfInspection = kendo.toString(viewAdmin.objDoc().DateOfInspection()); }
            if (viewAdmin.objDoc().DateMailedToClient() == undefined) { cancelDoc.DateMailedToClient = null; } else { cancelDoc.DateMailedToClient = kendo.toString(viewAdmin.objDoc().DateMailedToClient()); }
            cancelDoc.LinkToReport = viewAdmin.objDoc().LinkToReport();
            cancelDoc.LinkToReport2 = viewAdmin.objDoc().LinkToReport2();
            cancelDoc.LinkToDiagram = viewAdmin.objDoc().LinkToDiagram();
            previousDoc.DateOfInspection = "";
            previousDoc.DateMailedToClient = "";
            previousDoc.LinkToReport = "";
            previousDoc.LinkToReport2 = "";
            previousDoc.LinkToDiagram = "";
        }
    },

    onDeleteDocument: function () {
        viewAdmin.messageDoc("");
        var yesno = confirm(viewAdmin.objAdminLanguageLabels().lblAreYouSurePermanentlyDeleteRecord);
        if (yesno) {
            //viewAdmin.collDoc.markAsDeleted(viewAdmin.objDoc());
            var tempDoc = new es.objects.ReportArchive();
            es.dataProvider.baseURL = SITEBASEURL + DATASERVERENDPOINT;
            if (tempDoc.loadByPrimaryKey(viewAdmin.objDoc().ReportArchiveID())) {
                tempDoc.markAsDeleted();
                tempDoc.save();
                viewAdmin.onLoadDocManagerTab();
                refreshPage();
                viewAdmin.txtCloseCancelContinue_Document(viewAdmin.objAdminLanguageLabels().lblCancel);
                viewAdmin.enableDocumentTopButtons(true);
                viewAdmin.enableDocumentSelect(false);
                $('#btnSave_DocumentManager').addClass('grcGreenDisabledBtn');
                $('#btnSelectLEReport').addClass('grcBlueDisabledBtn');
                $('#btnClearURLEReport').addClass('grcBlueDisabledBtn');
                $('#btnClearDiagram').addClass('grcBlueDisabledBtn');
                $('#btnSelectDiagram').addClass('grcBlueDisabledBtn');
                $('#btnSelectERReport').addClass('grcBlueDisabledBtn');
                $('#btnClearERReport').addClass('grcBlueDisabledBtn');
                viewAdmin.enableDocumentDelete(false);
                $('#btnDelete_DocumentManager').addClass('grcRedDisabledBtn');
                viewAdmin.disableDocFields();
                cancelDoc.DateOfInspection = "";
                cancelDoc.DateMailedToClient = "";
                cancelDoc.LinkToReport = "";
                cancelDoc.LinkToReport2 = "";
                cancelDoc.LinkToDiagram = "";
                previousDoc.DateOfInspection = "";
                previousDoc.DateMailedToClient = "";
                previousDoc.LinkToReport = "";
                previousDoc.LinkToReport2 = "";
                previousDoc.LinkToDiagram = "";
            } else {
                $("#lblMessageDoc").removeClass("messageNotice");
                $("#lblMessageDoc").addClass("messageError");
                viewAdmin.messageDoc(viewAdmin.objAdminLanguageLabels().lblErrorWhileDeleteDoc);
                viewAdmin.onCloseCancelContinue_Document();
            }
        }
    },

    onSaveDocument: function () {
        //// VALIDATE
        var okToSave = true;
        if (viewAdmin.objDoc().LinkToReport().length < 1 && viewAdmin.objDoc().LinkToReport2().length < 1 && viewAdmin.objDoc().LinkToDiagram().length < 1) {
            okToSave = false;
            $("#lblMessageDoc").removeClass("messageNotice");
            $("#lblMessageDoc").addClass("messageError");
            viewAdmin.messageDoc(viewAdmin.objAdminLanguageLabels().lblSelectOneReport);
        }
        //if (Admin_Document_DateOfInspection.value() == undefined || Admin_Document_DateMailedToClient.value() == undefined) {
        if (Admin_Document_DateOfInspection.value() == undefined) {
            okToSave = false;
            $("#lblMessageDoc").removeClass("messageNotice");
            $("#lblMessageDoc").addClass("messageError");
            viewAdmin.messageDoc(viewAdmin.objAdminLanguageLabels().lblProvideDates);
        }

        if (okToSave) {
            var tempDoc = new es.objects.ReportArchive();
            tempDoc.MetaPracticeID(viewAdmin.metaPracticeID);
            if (viewAdmin.docAddEditMode == "edit") {
                es.dataProvider.baseURL = SITEBASEURL + DATASERVERENDPOINT;
                if (tempDoc.loadByPrimaryKey(viewAdmin.objDoc().ReportArchiveID())) {
                    tempDoc.FileNo(viewAdmin.objDoc().FileNo());
                    tempDoc.ReportDate(Admin_Document_DateOfInspection.value());
                    tempDoc.Report1(viewAdmin.objDoc().LinkToReport());
                    tempDoc.Report2(viewAdmin.objDoc().LinkToReport2());
                    tempDoc.Diagram(viewAdmin.objDoc().LinkToDiagram());
                    tempDoc.Practice(viewAdmin.objDoc().PracticeName());
                    tempDoc.DateToClient(Admin_Document_DateMailedToClient.value());
                    tempDoc.DatePosted(new Date());
                    es.dataProvider.baseURL = SITEBASEURL + DATASERVERENDPOINT;
                    // ZERO OUT TIME PART OF DATES // .setHours(0,0,0)
                    if (tempDoc.DatePosted()) { tempDoc.DatePosted().setHours(0, 0, 0); }
                    if (tempDoc.DateToClient()) { tempDoc.DateToClient().setHours(0, 0, 0); }
                    if (tempDoc.DateTransferred()) { tempDoc.DateTransferred().setHours(0, 0, 0); }
                    if (tempDoc.PreviousDateCompleted()) { tempDoc.PreviousDateCompleted().setHours(0, 0, 0); }
                    if (tempDoc.ReportDate()) { tempDoc.ReportDate().setHours(0, 0, 0); }
                    tempDoc.save();
                    viewAdmin.onLoadDocManagerTab();
                    refreshPage();
                    $("#lblMessageDoc").removeClass("messageError");
                    $("#lblMessageDoc").addClass("messageNotice");
                    viewAdmin.messageDoc(viewAdmin.objAdminLanguageLabels().lblRecordSaved);
                    viewAdmin.txtCloseCancelContinue_Document(viewAdmin.objAdminLanguageLabels().lblContinue);
                    viewAdmin.enableDocumentTopButtons(true);
                    viewAdmin.enableDocumentSelect(false);
                    $('#btnSave_DocumentManager').addClass('grcGreenDisabledBtn');
                    $('#btnSelectLEReport').addClass('grcBlueDisabledBtn');
                    $('#btnClearURLEReport').addClass('grcBlueDisabledBtn');
                    $('#btnClearDiagram').addClass('grcBlueDisabledBtn');
                    $('#btnSelectDiagram').addClass('grcBlueDisabledBtn');
                    $('#btnSelectERReport').addClass('grcBlueDisabledBtn');
                    $('#btnClearERReport').addClass('grcBlueDisabledBtn');
                    viewAdmin.enableDocumentDelete(false);
                    $('#btnDelete_DocumentManager').addClass('grcRedDisabledBtn');
                    viewAdmin.disableDocFields();
                    cancelDoc.DateOfInspection = "";
                    cancelDoc.DateMailedToClient = "";
                    cancelDoc.LinkToReport = "";
                    cancelDoc.LinkToReport2 = "";
                    cancelDoc.LinkToDiagram = "";
                    previousDoc.DateOfInspection = "";
                    previousDoc.DateMailedToClient = "";
                    previousDoc.LinkToReport = "";
                    previousDoc.LinkToReport2 = "";
                    previousDoc.LinkToDiagram = "";
                } else {
                    $("#lblMessageDoc").removeClass("messageNotice");
                    $("#lblMessageDoc").addClass("messageError");
                    viewAdmin.messageDoc(viewAdmin.objAdminLanguageLabels().lblRecordNotSaved);
                }
            } else {
                //tempDoc().Id();
                tempDoc.FileNo(viewAdmin.objDoc().FileNo());
                tempDoc.ReportDate(Admin_Document_DateOfInspection.value());
                tempDoc.Report1(viewAdmin.objDoc().LinkToReport());
                tempDoc.Report2(viewAdmin.objDoc().LinkToReport2());
                tempDoc.Diagram(viewAdmin.objDoc().LinkToDiagram());
                tempDoc.Practice(viewAdmin.objDoc().PracticeName());
                tempDoc.DateToClient(Admin_Document_DateMailedToClient.value());
                //tempDoc.PreviousDateCompleted(previousDoc.DateOfInspection); 
                //tempDoc.PreviousDateCompleted(null);
                if (previousDoc.LinkToDiagram == "" && previousDoc.LinkToReport == "" && previousDoc.LinkToReport2 == "") {
                    tempDoc.PreviousDateCompleted(null);
                } else {
                    tempDoc.PreviousDateCompleted(previousDoc.DateOfInspection);
                }
                tempDoc.PreviousReport1(previousDoc.LinkToReport);
                tempDoc.PreviousDiagram(previousDoc.LinkToDiagram);
                tempDoc.DatePosted(new Date());
                //tempDoc.DateTransferred(new Date("1/1/1900"));
                es.dataProvider.baseURL = SITEBASEURL + DATASERVERENDPOINT;
                // ZERO OUT TIME PART OF DATES // .setHours(0,0,0)
                if (tempDoc.DatePosted()) { tempDoc.DatePosted().setHours(0, 0, 0); }
                if (tempDoc.DateToClient()) { tempDoc.DateToClient().setHours(0, 0, 0); }
                if (tempDoc.DateTransferred()) { tempDoc.DateTransferred().setHours(0, 0, 0); }
                if (tempDoc.PreviousDateCompleted()) { tempDoc.PreviousDateCompleted().setHours(0, 0, 0); }
                if (tempDoc.ReportDate()) { tempDoc.ReportDate().setHours(0, 0, 0); }
                tempDoc.save();
                viewAdmin.onLoadDocManagerTab();
                refreshPage();
                $("#lblMessageDoc").removeClass("messageError");
                $("#lblMessageDoc").addClass("messageNotice");
                viewAdmin.messageDoc(viewAdmin.objAdminLanguageLabels().lblRecordSaved);
                viewAdmin.txtCloseCancelContinue_Document(viewAdmin.objAdminLanguageLabels().lblContinue);
                viewAdmin.enableDocumentTopButtons(true);
                viewAdmin.enableDocumentSelect(false);
                $('#btnSave_DocumentManager').addClass('grcGreenDisabledBtn');
                $('#btnSelectLEReport').addClass('grcBlueDisabledBtn');
                $('#btnClearURLEReport').addClass('grcBlueDisabledBtn');
                $('#btnClearDiagram').addClass('grcBlueDisabledBtn');
                $('#btnSelectDiagram').addClass('grcBlueDisabledBtn');
                $('#btnSelectERReport').addClass('grcBlueDisabledBtn');
                $('#btnClearERReport').addClass('grcBlueDisabledBtn');
                viewAdmin.enableDocumentDelete(false);
                $('#btnDelete_DocumentManager').addClass('grcRedDisabledBtn');
                viewAdmin.disableDocFields();
                cancelDoc.DateOfInspection = "";
                cancelDoc.DateMailedToClient = "";
                cancelDoc.LinkToReport = "";
                cancelDoc.LinkToReport2 = "";
                cancelDoc.LinkToDiagram = "";
                previousDoc.DateOfInspection = "";
                previousDoc.DateMailedToClient = "";
                previousDoc.LinkToReport = "";
                previousDoc.LinkToReport2 = "";
                previousDoc.LinkToDiagram = "";
            }
        }
    },

    onClearERReport: function () {
        viewAdmin.objDoc().LinkToReport("");
        viewAdmin.disableDocFields();
        viewAdmin.enableDocFields();
    },

    onClearURLEReport: function () {
        viewAdmin.objDoc().LinkToReport2("");
        viewAdmin.disableDocFields();
        viewAdmin.enableDocFields();
    },

    onClearDiagram: function () {
        viewAdmin.objDoc().LinkToDiagram("");
        viewAdmin.disableDocFields();
        viewAdmin.enableDocFields();
    },

    enableDocFields: function () {
        Admin_Document_DateOfInspection.enable(true);
        Admin_Document_DateOfInspection.wrapper.find(".k-icon").removeClass("noedit").addClass("editRequired");
        Admin_Document_DateOfInspection.wrapper.find(".k-picker-wrap").removeClass("noedit").addClass("editRequired");
        Admin_Document_DateOfInspection.wrapper.find(".k-autocomplete").removeClass("noedit").addClass("editRequired");
        Admin_Document_DateMailedToClient.enable(true);
        Admin_Document_DateMailedToClient.wrapper.find(".k-icon").removeClass("noedit").addClass("editRequired");
        Admin_Document_DateMailedToClient.wrapper.find(".k-picker-wrap").removeClass("noedit").addClass("editRequired");
        Admin_Document_DateMailedToClient.wrapper.find(".k-autocomplete").removeClass("noedit").addClass("editRequired");
        $("#Admin_Document_LinkERReport").removeClass("noedit").addClass("editRequired");
        $("#Admin_Document_LinkURLEReport").removeClass("noedit").addClass("editRequired");
        $("#Admin_Document_LinkDiagram").removeClass("noedit").addClass("editRequired");
    },

    disableDocFields: function () {
        Admin_Document_DateOfInspection.enable(false);
        Admin_Document_DateOfInspection.wrapper.find(".k-icon").removeClass("editRequired").addClass("noedit");
        Admin_Document_DateOfInspection.wrapper.find(".k-picker-wrap").removeClass("editRequired").addClass("noedit");
        Admin_Document_DateOfInspection.wrapper.find(".k-autocomplete").removeClass("editRequired").addClass("noedit");
        Admin_Document_DateMailedToClient.enable(false);
        Admin_Document_DateMailedToClient.wrapper.find(".k-icon").removeClass("editRequired").addClass("noedit");
        Admin_Document_DateMailedToClient.wrapper.find(".k-picker-wrap").removeClass("editRequired").addClass("noedit");
        Admin_Document_DateMailedToClient.wrapper.find(".k-autocomplete").removeClass("editRequired").addClass("noedit");
        $("#Admin_Document_LinkERReport").removeClass("editRequired").addClass("noedit");
        $("#Admin_Document_LinkURLEReport").removeClass("editRequired").addClass("noedit");
        $("#Admin_Document_LinkDiagram").removeClass("editRequired").addClass("noedit");
    },
    //// END DOCUMENT MANAGER FUNCTIONS
    ////////////////////////


    ////////////////////////
    ////////////////////////
    //// ADMIN USER ACTIVITY FUNCTIONS
    onLoadUserForm: function (pEzyUserId) {
        var zServiceName = "GetAdminUserFormData";
        var zParms = ko.toJSON({
            "pEzyUserId": pEzyUserId
        });
        global.callRestService(SITEBASEURL + RESTSERVERENDPOINT, zServiceName, zParms, viewAdmin.onLoadUserFormSuccess, viewAdmin.onLoadUserFormError, null);
    },
    onLoadUserFormSuccess: function (pResults, pParms) {
        try {
            if (pResults) {
                if (pResults.isSuccess) {
                    if (pResults.data.users) {
                        document.getElementById("radEmailNone").checked = true;
                        viewAdmin.emailFlag("emailNone");
                        viewAdmin.editNewMode = "edit";
                        viewAdmin.messageUserDetails("");
                        viewAdmin.enableDeleteUser(true);
                        $("#divUserActivity_UserGrid").fadeOut(function () {
                            $("#divUserActivity_UserDetail").fadeIn();
                            $("#divUserActivity_DetailButtons").fadeIn();
                        });
                        viewAdmin.objUser(viewAdmin.buildUserObjectFromData(pResults.data.users[0]));
                        viewAdmin.buildUserDetails();
                        viewAdmin.All_Init(false);
                        viewAdmin.All_Rpt(false);
                        viewAdmin.All_1stFU(false);
                        viewAdmin.All_2ndFU(false);
                        viewAdmin.All_3rdFU(false);
                        viewAdmin.All_1stOD(false);
                        viewAdmin.All_2ndOD(false);
                        viewAdmin.All_3rdOD(false);
                        viewAdmin.All_PastDue(false);
                    } else {
                        viewAdmin.objUser(buildAdminWindowEmptyUser());
                    }
                } else {
                    //viewAdmin.objAdminLanguageLabels().lblErrorLoadUser + "
                    alert("An error occurred while building User Activity form data: " + pResults.message);
                }
            } else {
                //viewAdmin.objAdminLanguageLabels().lblErrorLoadUser + "
                alert("An unknown error occurred while building User Activity form data. " + pResults);
            }
        } catch (pException) {
            //viewAdmin.objAdminLanguageLabels().lblErrorLoadUser + "
            alert("An error occurred while building User Activity form data: " + pException.message);
        }
    },
    onLoadUserFormError: function (pResults, pMessage, pErrorDetail, pParms) {
        alert("Error while accessing User Activity form data call. " + pMessage + " - " + pErrorDetail);
    },

    onLoadUserGrid: function () {
        var zServiceName = "GetAdminUserGridData";
        var zParms = ko.toJSON({
            "gSafeGuid": viewAdmin.gSafeGuid
        });
        global.callRestService(SITEBASEURL + RESTSERVERENDPOINT, zServiceName, zParms, viewAdmin.onLoadUserGridSuccess, viewAdmin.onLoadUserGridError, null);
    },
    onLoadUserGridSuccess: function (pResults, pParms) {
        try {
            if (pResults) {
                if (pResults.isSuccess) {
                    // SET THE LOCAL USERS DATA COLLECTION
                    if (pResults.data.users) {
                        viewAdmin.collUserGrid = pResults.data.users;
                    } else {
                        viewAdmin.collUserGrid = null;
                    }
                    // BUILD DROPDOWN LISTS DATA
                    if (pResults.data.dropdown) {
                        viewAdmin.buildUserDropdowns(pResults.data.dropdown);
                    }
                    // BUILD THE REST OF THE DATA
                    viewAdmin.createUserGridColumnTitles();
                    viewAdmin.createUserGridDataSourceObject();
                    viewAdmin.createUserGridObject();
                    viewAdmin.buildUsersGrid();
                    gridUsers.dataSource.data(viewAdmin.collGridDS());
                    gridUsers.dataSource.page(1);
                } else {
                    alert("An error occurred while building User Activity data: " + pResults.message);
                }
            } else {
                alert("An unknown error occurred while building User Activity data. " + pResults);
            }
        } catch (pException) {
            alert("An error occurred while building User Activity data: " + pException.message);
        }
    },
    onLoadUserGridError: function (pResults, pMessage, pErrorDetail, pParms) {
        alert("Error while accessing User Activity data call. " + pMessage + " - " + pErrorDetail);
    },

    onLoadEmptyUserGrid: function () {
        viewAdmin.createUserGridColumnTitles();
        viewAdmin.createUserGridDataSourceObject();
        viewAdmin.createUserGridObject();
        viewAdmin.buildEmptyUsersGrid();
        gridUsers.dataSource.data(viewAdmin.collGridDS());
        gridUsers.dataSource.page(1);
    },

    onCloseCancelContinue_UserActivity: function () {
        viewAdmin.messageUserDetails("");
        windowAdmin.data("kendoWindow").close();
        windowAdminTabStrip.select(0);
        global_IsAdminWindowOpen = false;
    },

    onAddNewUser: function () {
        viewAdmin.editNewMode = "new";
        document.getElementById("radEmailNone").checked = true;
        viewAdmin.emailFlag("emailNone");
        viewAdmin.objUser(buildAdminWindowEmptyUser());
        viewAdmin.messageUserDetails("");
        viewAdmin.customAccessTextValue("");
        viewAdmin.divisionValue("");
        viewAdmin.facilityValue("");
        viewAdmin.plantValue("");
        viewAdmin.clientLocNoValue("");
        viewAdmin.cityValue("");
        viewAdmin.stProvValue("");
        viewAdmin.countryValue("");
        viewAdmin.loadEmptyUserCheckboxes();
        viewAdmin.objUser().colActiveUser(true);
        viewAdmin.enableDeleteUser(false);
        $('#btnUserDelete').addClass('grcRedDisabledBtn');
        $("#divUserActivity_UserGrid").fadeOut(function () {
            //$("#divUserActivityContainer").addClass("windowAdminContentScroll");
            $("#divUserActivity_UserDetail").fadeIn();
            $("#divUserActivity_DetailButtons").fadeIn();
        });


    },

    onSaveUser: function () {
        viewAdmin.validateUserServerUser();
    },

    validateUserServerUser: function () {
        var zEmail = viewAdmin.objUser().colEmail();
        var zFilePrefix = getFilePrefix(viewAdmin.gSafeGuid);
        var zServiceName = "ValidateAdminUserForm";
        var zParms = ko.toJSON({
            "pEmail": zEmail,
            "pFilePrefix": zFilePrefix
        });
        global.callRestService(SITEBASEURL + RESTSERVERENDPOINT, zServiceName, zParms, viewAdmin.validateUserServerSuccess, viewAdmin.validateUserServerError, null);
    },
    validateUserServerSuccess: function (pResults, pParms) {
        try {
            if (pResults) {
                if (pResults.isSuccess) {
                    if (pResults.isValid) {
                        // PROCEED WITH SAVE PROCESS
                        viewAdmin.processSaveUser();
                    } else {
                        alert(pResults.message);
                    }
                } else {
                    alert("An error occurred while building user server validation data: " + pResults.message);
                }
            } else {
                alert("An unknown error occurred while building user server validation data. " + pResults);
            }
        } catch (pException) {
            alert("An error occurred while building user server validation data: " + pException.message);
        }
    },
    validateUserServerError: function (pResults, pMessage, pErrorDetail, pParms) {
        alert("Error while accessing user server validation data call. " + pMessage + " - " + pErrorDetail);
    },

    processSaveUser: function () {
        //// VALIDATE EMPTY FIELDS
        viewAdmin.messageUserDetails("");
        var tempUserSaveValid = true;
        if (viewAdmin.objUser().colFullName() == undefined || viewAdmin.objUser().colFullName() == "") {
            viewAdmin.messageUserDetails(viewAdmin.objAdminLanguageLabels().lblPleaseProvideFullName);
            tempUserSaveValid = false;
        } else if (viewAdmin.objUser().colEmail() == undefined || viewAdmin.objUser().colEmail() == "") {
            viewAdmin.messageUserDetails(viewAdmin.objAdminLanguageLabels().lblPleaseProvideEmail);
            tempUserSaveValid = false;
        //} else if (viewAdmin.objUser().colPassword() == undefined || viewAdmin.objUser().colPassword() == "") {
        //    viewAdmin.messageUserDetails(viewAdmin.objAdminLanguageLabels().lblPleaseProvidePassword);
        //    tempUserSaveValid = false;
        }

        //// VALIDATE CHECKBOXES WITH DROPDOWN VALUES
        // CUSTOM ACCESS
        if (viewAdmin.objUser().colCustomAccess() == true && (viewAdmin.customAccessTextValue() == undefined || viewAdmin.customAccessTextValue() == "")) {
            viewAdmin.messageUserDetails(viewAdmin.objAdminLanguageLabels().lblPleaseProvideCustomAccess);
            tempUserSaveValid = false;
        }
        if (viewAdmin.objUser().colCustomAccess() == false && (viewAdmin.customAccessTextValue() != undefined && viewAdmin.customAccessTextValue() != "")) {
            viewAdmin.messageUserDetails(viewAdmin.objAdminLanguageLabels().lblPleaseProvideCustomAccess);
            tempUserSaveValid = false;
        }
        // DIVISION
        if (viewAdmin.objUser().colDivisionManager() == true && (viewAdmin.divisionValue() == undefined || viewAdmin.divisionValue() == "")) {
            viewAdmin.messageUserDetails(viewAdmin.objAdminLanguageLabels().lblPleaseProvideDivision);
            tempUserSaveValid = false;
        }
        if (viewAdmin.objUser().colDivisionManager() == false && (viewAdmin.divisionValue() != undefined && viewAdmin.divisionValue() != "")) {
            viewAdmin.messageUserDetails(viewAdmin.objAdminLanguageLabels().lblPleaseProvideDivision);
            tempUserSaveValid = false;
        }
        // LOCATION
        if (viewAdmin.objUser().colPlantManager() == true && (viewAdmin.plantValue() == undefined || viewAdmin.plantValue() == "")) {
            viewAdmin.messageUserDetails(viewAdmin.objAdminLanguageLabels().lblPleaseProvideLocation);
            tempUserSaveValid = false;
        }
        if (viewAdmin.objUser().colPlantManager() == false && (viewAdmin.plantValue() != undefined && viewAdmin.plantValue() != "")) {
            viewAdmin.messageUserDetails(viewAdmin.objAdminLanguageLabels().lblPleaseProvideLocation);
            tempUserSaveValid = false;
        }
        // CLIENT LOC NO
        if (viewAdmin.objUser().colClientLocNoManager() == true && (viewAdmin.clientLocNoValue() == undefined || viewAdmin.clientLocNoValue() == "")) {
            viewAdmin.messageUserDetails(viewAdmin.objAdminLanguageLabels().lblPleaseProvideClientLocNo);
            tempUserSaveValid = false;
        }
        if (viewAdmin.objUser().colClientLocNoManager() == false && (viewAdmin.clientLocNoValue() != undefined && viewAdmin.clientLocNoValue() != "")) {
            viewAdmin.messageUserDetails(viewAdmin.objAdminLanguageLabels().lblPleaseProvideClientLocNo);
            tempUserSaveValid = false;
        }
        // FACILITY
        if (viewAdmin.objUser().colFacilityManager() == true && (viewAdmin.facilityValue() == undefined || viewAdmin.facilityValue() == "")) {
            viewAdmin.messageUserDetails(viewAdmin.objAdminLanguageLabels().lblPleaseProvideFacility);
            tempUserSaveValid = false;
        }
        if (viewAdmin.objUser().colFacilityManager() == false && (viewAdmin.facilityValue() != undefined && viewAdmin.facilityValue() != "")) {
            viewAdmin.messageUserDetails(viewAdmin.objAdminLanguageLabels().lblPleaseProvideFacility);
            tempUserSaveValid = false;
        }
        // CITY
        if (viewAdmin.objUser().colCityManager() == true && (viewAdmin.cityValue() == undefined || viewAdmin.cityValue() == "")) {
            viewAdmin.messageUserDetails(viewAdmin.objAdminLanguageLabels().lblPleaseProvideCity);
            tempUserSaveValid = false;
        }
        if (viewAdmin.objUser().colCityManager() == false && (viewAdmin.cityValue() != undefined && viewAdmin.cityValue() != "")) {
            viewAdmin.messageUserDetails(viewAdmin.objAdminLanguageLabels().lblPleaseProvideCity);
            tempUserSaveValid = false;
        }
        // ST PROV
        if (viewAdmin.objUser().colStProvManager() == true && (viewAdmin.stProvValue() == undefined || viewAdmin.stProvValue() == "")) {
            viewAdmin.messageUserDetails(viewAdmin.objAdminLanguageLabels().lblPleaseProvideStProv);
            tempUserSaveValid = false;
        }
        if (viewAdmin.objUser().colStProvManager() == false && (viewAdmin.stProvValue() != undefined && viewAdmin.stProvValue() != "")) {
            viewAdmin.messageUserDetails(viewAdmin.objAdminLanguageLabels().lblPleaseProvideStProv);
            tempUserSaveValid = false;
        }
        // COUNTRY
        if (viewAdmin.objUser().colCountryManager() == true && (viewAdmin.countryValue() == undefined || viewAdmin.countryValue() == "")) {
            viewAdmin.messageUserDetails(viewAdmin.objAdminLanguageLabels().lblPleaseProvideCountry);
            tempUserSaveValid = false;
        }
        if (viewAdmin.objUser().colCountryManager() == false && (viewAdmin.countryValue() != undefined && viewAdmin.countryValue() != "")) {
            viewAdmin.messageUserDetails(viewAdmin.objAdminLanguageLabels().lblPleaseProvideCountry);
            tempUserSaveValid = false;
        }

        // AT LEAST ONE MANAGER
        if (viewAdmin.objUser().colCustomAccess() != true &&
            viewAdmin.objUser().colDivisionManager() != true &&
            viewAdmin.objUser().colPlantManager() != true &&
            viewAdmin.objUser().colDocumentAccess() != true &&
            viewAdmin.objUser().colClientLocNoManager() != true &&
            viewAdmin.objUser().colFacilityManager() != true &&
            viewAdmin.objUser().colCityManager() != true &&
            viewAdmin.objUser().colStProvManager() != true &&
            viewAdmin.objUser().colCountryManager() != true &&
            viewAdmin.objUser().colRiskManager() != true) {
            viewAdmin.messageUserDetails(viewAdmin.objAdminLanguageLabels().lblPleaseSelectOneTypeAccess);
            tempUserSaveValid = false;
        }

        // WCF = ValidateAdminUserForm(pEmail As String, pFilePrefix As String)
        // VALIDATE THAT EMAIL + PASSWORD + FILEPREFIX CANNOT EXIST - NEW: VALIDATE EMAIL AND FILEPREFIX
        //if (viewAdmin.editNewMode == "new") {
        //    var tempEmailPassCombo = new es.objects.EzyUsersCollection();
        //    es.dataProvider.baseURL = SITEBASEURL + DATASERVERENDPOINT;
        //    if (!tempEmailPassCombo.GetEzyUserByEmail(viewAdmin.objUser().colEmail())) {
        //        if (tempEmailPassCombo().length > 0) {
        //            for (x = 0; x < tempEmailPassCombo().length; x++) {
        //                if (tempEmailPassCombo()[x].Email() == viewAdmin.objUser().colEmail() && tempEmailPassCombo()[x].Password() == viewAdmin.objUser().colPassword() && tempEmailPassCombo()[x].FilePrefix() == getFilePrefix(viewAdmin.gSafeGuid)) {
        //                    viewAdmin.messageUserDetails(viewAdmin.objAdminLanguageLabels().lblEmailPasswordCombo);
        //                    tempUserSaveValid = false;
        //                }
        //            }
        //        }
        //    }
        //}

        if (tempUserSaveValid) {
            viewAdmin.objUser().colRInit(viewAdmin.buildUserFollowUpsString(1));
            viewAdmin.objUser().colRReport(viewAdmin.buildUserFollowUpsString(2));
            viewAdmin.objUser().colRfu1(viewAdmin.buildUserFollowUpsString(3));
            viewAdmin.objUser().colRfu2(viewAdmin.buildUserFollowUpsString(4));
            viewAdmin.objUser().colRfu3(viewAdmin.buildUserFollowUpsString(5));
            viewAdmin.objUser().colROverdue1(viewAdmin.buildUserFollowUpsString(6));
            viewAdmin.objUser().colROverdue2(viewAdmin.buildUserFollowUpsString(7));
            viewAdmin.objUser().colROverdue3(viewAdmin.buildUserFollowUpsString(8));
            viewAdmin.objUser().colExpOverdue(viewAdmin.buildUserFollowUpsString(9));
            viewAdmin.objUser().colRExpd(viewAdmin.buildUserFollowUpsString(10));
            viewAdmin.objUser().colCustomAccessText(viewAdmin.customAccessTextValue());
            viewAdmin.objUser().colDivision(viewAdmin.divisionValue());
            viewAdmin.objUser().colPlant(viewAdmin.plantValue());
            viewAdmin.objUser().colFacilityText(viewAdmin.facilityValue());
            viewAdmin.objUser().colClientLocNoText(viewAdmin.clientLocNoValue());
            viewAdmin.objUser().colCityText(viewAdmin.cityValue());
            viewAdmin.objUser().colStProvText(viewAdmin.stProvValue());
            viewAdmin.objUser().colCountryText(viewAdmin.countryValue());

            if (viewAdmin.editNewMode == "edit") {
                // DO NOTHING                
            } else {
                var tempDate = new Date();
                viewAdmin.objUser().colUserID(viewAdmin.objUser().colEmail() + "_" + tempDate.getSeconds().toString() + tempDate.getMilliseconds().toString());
                viewAdmin.objUser().colFilePrefix(getFilePrefix(viewAdmin.gSafeGuid));
            }
            var zSaveObject = viewAdmin.buildUserSaveObject();
            var zServiceName = "SaveUser";
            var zParms = ko.toJSON({
                "pJSON": JSON.stringify(zSaveObject)
            });
            global.callRestService(SITEBASEURL + RESTSERVERENDPOINT, zServiceName, zParms, viewAdmin.processSaveUserSuccess, viewAdmin.processSaveUserError, null);
        }
    },
    processSaveUserSuccess: function (pResults, pParms) {
        try {
            if (pResults) {
                if (pResults.isSuccess) {
                    if (viewAdmin.editNewMode == "edit") {
                        //viewAdmin.objUser().colsave();
                        viewAdmin.onLoadUserGrid();
                        viewAdmin.onCancelUser();
                        var cell = $("#" + parseInt(viewAdmin.objUser().colEzyUserID()));
                        var row = cell.closest("tr");
                        gridUsers.select(row);
                    } else {
                        viewAdmin.onLoadUserGrid();
                        viewAdmin.onCancelUser();
                    }
                } else {
                    alert("An error occurred while building User Activity save data: " + pResults.message);
                }
            } else {
                alert("An unknown error occurred while building User Activity save data. " + pResults);
            }
        } catch (pException) {
            alert("An error occurred while building User Activity save data: " + pException.message);
        }
    },
    processSaveUserError: function (pResults, pMessage, pErrorDetail, pParms) {
        alert("Error while accessing User Activity save data call. " + pMessage + " - " + pErrorDetail);
    },

    onDeleteUser: function () {
        var yesno = confirm(viewAdmin.objAdminLanguageLabels().lblAreYouSureDeleteUser);
        if (yesno) {
            var zServiceName = "RemoveEzyUser";
            var zParms = ko.toJSON({
                "pEzyUserId": viewAdmin.objUser().colEzyUserID()
            });
            global.callRestService(SITEBASEURL + RESTSERVERENDPOINT, zServiceName, zParms, viewAdmin.onDeleteUserSuccess, viewAdmin.onDeleteUserError, null);
        }
    },
    onDeleteUserSuccess: function (pResults, pParms) {
        try {
            if (pResults) {
                if (pResults.isSuccess) {
                    viewAdmin.onLoadUserGrid();
                    viewAdmin.onCancelUser();
                    viewAdmin.messageUserDetails("");
                } else {
                    alert("An error occurred while building User Activity delete data: " + pResults.message);
                }
            } else {
                alert("An unknown error occurred while building User Activity delete data. " + pResults);
            }
        } catch (pException) {
            alert("An error occurred while building User Activity delete data: " + pException.message);
        }
    },
    onDeleteUserError: function (pResults, pMessage, pErrorDetail, pParms) {
        alert("Error while accessing User Activity delete data call. " + pMessage + " - " + pErrorDetail);
    },

    onLoadUsersByEmail: function (pEmail) {
        var zServiceName = "GetUserByEmail";
        var zParms = ko.toJSON({
            "pEmail": pEmail
        });
        global.callRestService(SITEBASEURL + RESTSERVERENDPOINT, zServiceName, zParms, viewAdmin.onLoadUsersByEmailSuccess, viewAdmin.onLoadUsersByEmailError, null);
    },
    onLoadUsersByEmailSuccess: function (pResults, pParms) {
        try {
            if (pResults) {
                if (pResults.isSuccess) {
                    if (pResults.data) {
                        if (pResults.data.length > 0) {
                            var msg = "";
                            for (x = 0; x < pResults.data.length; x++) {
                                msg = msg + "------------------------------------------------\n\r";
                                msg = msg + "File Prefix: " + pResults.data[x].colFilePrefix + "\n\r";
                                msg = msg + "User ID: " + pResults.data[x].colUserID + "\n\r";
                                msg = msg + "Password: " + "(not available)" + "\n\r"; //pResults.data[x].colPassword + "\n\r";
                                if (pResults.data[x].colCCActive == true) { msg = msg + "CC Active: " + pResults.data[x].colCCActive.toString() + "\n\r"; }
                                if (pResults.data[x].colGRCAdministrator != undefined && pResults.data[x].colGRCAdministrator != null && pResults.data[x].colGRCAdministrator != "") {
                                    if (pResults.data[x].colGRCAdministrator.length > 0) { msg = msg + "GRC Administrator Type: " + pResults.data[x].colGRCAdministrator + "\n\r"; }
                                }
                            }
                            alert("The user email you entered has been found in the following records. Please review the details in the grid before proceeding.\n\r\n\r" + msg);
                        }
                    }
                } else {
                    alert("An error occurred while building user list from email search: " + pResults.message);
                }
            } else {
                alert("An unknown error occurred while building user list from email search. " + pResults);
            }
        } catch (pException) {
            alert("An error occurred while building user list from email search: " + pException.message);
        }
    },
    onLoadUsersByEmailError: function (pResults, pMessage, pErrorDetail, pParms) {
        alert("Error while accessing user list from email data call. " + pMessage + " - " + pErrorDetail);
    },

    onCancelUser: function () {
        $("#divUserActivity_DetailButtons").fadeOut();
        $("#divUserActivity_UserDetail").fadeOut(function () {
            $("#divUserActivity_UserGrid").fadeIn();
            viewAdmin.messageUserDetails("");
            viewAdmin.onClearUser();
        });
    },

    onResetUserForm: function () {
        $("#divUserActivity_DetailButtons").css("display", "none");
        $("#divUserActivity_UserDetail").css("display", "none");
        $("#divUserActivity_UserGrid").fadeIn();
        viewAdmin.messageUserDetails("");
        viewAdmin.onClearUser();
    },

    onClearUser: function () {
        document.getElementById("radEmailNone").checked = true;
        viewAdmin.emailFlag("emailNone");
        viewAdmin.objUser(buildAdminWindowEmptyUser());
        viewAdmin.loadEmptyUserObject();
    },

    onExportUsers: function () {
        //// BUILD THE DATA FROM THE GRID
        gridUsers.saveChanges();
        var gridXMLString = "";
        var Header = "";
        var Content = "";
        var Footer = "";

        setTimeout(function () {
            Header = buildXMLUserHeader();
            Content = buildXMLString_Users(gridUsers.dataSource._view);  //(gridUsers.dataSource._view); //zUsers
            Footer = buildXMLUserFooter();
            gridXMLString = Header + Content + Footer;

            // REMOVE DANGEROUS CHARACTERS
            gridXMLString = gridXMLString.replace(/(\r\n|\n|\r)/gm, " "); // REMOVE ALL LINE BRAKES
            gridXMLString = gridXMLString.replace(/(\r\t|\t|\r)/gm, " "); // REMOVE ALL TABS
            gridXMLString = gridXMLString.replace(/(\")/gm, "'"); // REPLACE ALL ESCAPED DOUBLE QUOTES WITH SINGLE QUOTES
            gridXMLString = gridXMLString.replace(/(<)/gm, "||OPEN||"); // REPLACE ALL OPEN BRACKETS
            gridXMLString = gridXMLString.replace(/(>)/gm, "||CLOSE||"); // REPLACE ALL CLOSING BRACKETS

            //// CREATE A FORM DOM ELEMENT
            var form = document.createElement("form");
            form.setAttribute("id", "frmExport");
            form.setAttribute("method", "post");
            //form.setAttribute("target", "_blank");
            form.setAttribute("action", "../Exports/UserExport.ashx");
            document.body.appendChild(form);

            //// CREATE A HIDDEN INPUT DOM ELEMENT
            var hiddenField = document.createElement("input");
            hiddenField.setAttribute("type", "hidden");
            hiddenField.setAttribute("id", "fldHidden");
            hiddenField.setAttribute("name", "XMLData");
            hiddenField.setAttribute("value", gridXMLString);
            form.appendChild(hiddenField);

            //// SUBMIT THE FORM AND DELETE IT SO IT CAN BE RUN AGAIN
            form.submit();
            form.removeChild(hiddenField);
            document.body.removeChild(form);
        }, 1000);
    },

    onDropdownCloseCustomAccess: function () {
        //// TURN OFF OTHER CHECKBOXES AND CLEAR DROPDOWNS
        viewAdmin.objUser().colCustomAccess(true); //true
        viewAdmin.objUser().colRiskManager(false);
        viewAdmin.objUser().colDivisionManager(false);
        viewAdmin.objUser().colPlantManager(false);
        viewAdmin.objUser().colClientLocNoManager(false);
        viewAdmin.objUser().colFacilityManager(false);
        viewAdmin.objUser().colCityManager(false);
        viewAdmin.objUser().colStProvManager(false);
        viewAdmin.objUser().colCountryManager(false);
        viewAdmin.divisionValue("");
        viewAdmin.facilityValue("");
        viewAdmin.plantValue("");
        viewAdmin.clientLocNoValue("");
        viewAdmin.cityValue("");
        viewAdmin.stProvValue("");
        viewAdmin.countryValue("");
    },

    onDropdownCloseDivision: function () {
        //// TURN OFF OTHER CHECKBOXES AND CLEAR DROPDOWNS
        viewAdmin.objUser().colDivisionManager(true); //true
        viewAdmin.objUser().colRiskManager(false);
        viewAdmin.objUser().colCustomAccess(false);
        viewAdmin.objUser().colPlantManager(false);
        viewAdmin.objUser().colClientLocNoManager(false);
        viewAdmin.objUser().colFacilityManager(false);
        viewAdmin.objUser().colCityManager(false);
        viewAdmin.objUser().colStProvManager(false);
        viewAdmin.objUser().colCountryManager(false);
        viewAdmin.customAccessTextValue("");
        viewAdmin.facilityValue("");
        viewAdmin.plantValue("");
        viewAdmin.clientLocNoValue("");
        viewAdmin.cityValue("");
        viewAdmin.stProvValue("");
        viewAdmin.countryValue("");
    },

    onDropdownCloseFacility: function () {
        //// TURN OFF OTHER CHECKBOXES AND CLEAR DROPDOWNS
        viewAdmin.objUser().colPlantManager(false);
        viewAdmin.objUser().colRiskManager(false);
        viewAdmin.objUser().colCustomAccess(false);
        viewAdmin.objUser().colDivisionManager(false);
        viewAdmin.objUser().colClientLocNoManager(false);
        viewAdmin.objUser().colFacilityManager(true); //true
        viewAdmin.objUser().colCityManager(false);
        viewAdmin.objUser().colStProvManager(false);
        viewAdmin.objUser().colCountryManager(false);
        viewAdmin.customAccessTextValue("");
        viewAdmin.divisionValue("");
        //viewAdmin.facilityValue("");
        viewAdmin.plantValue("");
        viewAdmin.clientLocNoValue("");
        viewAdmin.cityValue("");
        viewAdmin.stProvValue("");
        viewAdmin.countryValue("");
    },

    onDropdownCloseLocation: function () {
        // TURN OFF OTHER CHECKBOXES AND CLEAR DROPDOWNS
        viewAdmin.objUser().colRiskManager(false);
        viewAdmin.objUser().colCustomAccess(false);
        viewAdmin.objUser().colDivisionManager(false);
        viewAdmin.objUser().colPlantManager(true); //true
        viewAdmin.objUser().colClientLocNoManager(false);
        viewAdmin.objUser().colFacilityManager(false);
        viewAdmin.objUser().colCityManager(false);
        viewAdmin.objUser().colStProvManager(false);
        viewAdmin.objUser().colCountryManager(false);
        viewAdmin.customAccessTextValue("");
        viewAdmin.divisionValue("");
        viewAdmin.facilityValue("");
        //viewAdmin.plantValue("");
        viewAdmin.clientLocNoValue("");
        viewAdmin.cityValue("");
        viewAdmin.stProvValue("");
        viewAdmin.countryValue("");
    },

    onDropdownCloseClientLocNo: function () {
        // TURN OFF OTHER CHECKBOXES AND CLEAR DROPDOWNS
        viewAdmin.objUser().colPlantManager(false);
        viewAdmin.objUser().colRiskManager(false);
        viewAdmin.objUser().colCustomAccess(false);
        viewAdmin.objUser().colDivisionManager(false);
        viewAdmin.objUser().colClientLocNoManager(true); //true
        viewAdmin.objUser().colFacilityManager(false);
        viewAdmin.objUser().colCityManager(false);
        viewAdmin.objUser().colStProvManager(false);
        viewAdmin.objUser().colCountryManager(false);
        viewAdmin.customAccessTextValue("");
        viewAdmin.divisionValue("");
        viewAdmin.facilityValue("");
        viewAdmin.plantValue("");
        //viewAdmin.clientLocNoValue("");
        viewAdmin.cityValue("");
        viewAdmin.stProvValue("");
        viewAdmin.countryValue("");
    },

    onDropdownCloseCity: function () {
        // TURN OFF OTHER CHECKBOXES AND CLEAR DROPDOWNS
        viewAdmin.objUser().colPlantManager(false);
        viewAdmin.objUser().colRiskManager(false);
        viewAdmin.objUser().colCustomAccess(false);
        viewAdmin.objUser().colDivisionManager(false);
        viewAdmin.objUser().colClientLocNoManager(false);
        viewAdmin.objUser().colFacilityManager(false);
        viewAdmin.objUser().colCityManager(true); //true
        viewAdmin.objUser().colStProvManager(false);
        viewAdmin.objUser().colCountryManager(false);
        viewAdmin.customAccessTextValue("");
        viewAdmin.divisionValue("");
        viewAdmin.facilityValue("");
        viewAdmin.plantValue("");
        viewAdmin.clientLocNoValue("");
        //viewAdmin.cityValue("");
        viewAdmin.stProvValue("");
        viewAdmin.countryValue("");
    },

    onDropdownCloseStProv: function () {
        // TURN OFF OTHER CHECKBOXES AND CLEAR DROPDOWNS
        viewAdmin.objUser().colPlantManager(false);
        viewAdmin.objUser().colRiskManager(false);
        viewAdmin.objUser().colCustomAccess(false);
        viewAdmin.objUser().colDivisionManager(false);
        viewAdmin.objUser().colClientLocNoManager(false);
        viewAdmin.objUser().colFacilityManager(false);
        viewAdmin.objUser().colCityManager(false);
        viewAdmin.objUser().colStProvManager(true); //true
        viewAdmin.objUser().colCountryManager(false);
        viewAdmin.customAccessTextValue("");
        viewAdmin.divisionValue("");
        viewAdmin.facilityValue("");
        viewAdmin.plantValue("");
        viewAdmin.clientLocNoValue("");
        viewAdmin.cityValue("");
        //viewAdmin.stProvValue("");
        viewAdmin.countryValue("");
    },

    onDropdownCloseCountry: function () {
        // TURN OFF OTHER CHECKBOXES AND CLEAR DROPDOWNS
        viewAdmin.objUser().colPlantManager(false);
        viewAdmin.objUser().colRiskManager(false);
        viewAdmin.objUser().colCustomAccess(false);
        viewAdmin.objUser().colDivisionManager(false);
        viewAdmin.objUser().colClientLocNoManager(false);
        viewAdmin.objUser().colFacilityManager(false);
        viewAdmin.objUser().colCityManager(false);
        viewAdmin.objUser().colStProvManager(false);
        viewAdmin.objUser().colCountryManager(true); //true
        viewAdmin.customAccessTextValue("");
        viewAdmin.divisionValue("");
        viewAdmin.plantValue("");
        viewAdmin.facilityValue("");
        viewAdmin.clientLocNoValue("");
        viewAdmin.cityValue("");
        viewAdmin.stProvValue("");
        //viewAdmin.countryValue("");
    },

    buildUserSaveObject: function () {
        var zReturn = {};
        try {
            // CREATE THE DETAILS
            for (var zItem in viewAdmin.objUser()) {
                zReturn[zItem] = viewAdmin.objUser()[zItem]();
                if (zReturn[zItem] == undefined) {
                    zReturn[zItem] = null;
                }
            }
            // CREATE THE EMAIL FLAG
            zReturn["emailFlags"] = {
                "emailNewUser": false,
                "emailResetPassword": false,
                "emailUnlockAccount": false,
            }
            if (viewAdmin.emailFlag()) {
                if (viewAdmin.emailFlag().toLowerCase() != "emailnone") {
                    zReturn["emailFlags"][viewAdmin.emailFlag()] = true;
                }
            }
        } catch (pException) {
            zReturn = null;
        }
        return zReturn;
    },

    buildUserDetails: function () {
        //// INIT COLUMN SEARCH FOR FBIWSL
        if (viewAdmin.objUser().colRInit() != undefined) {
            var zTemp = viewAdmin.objUser().colRInit().toLowerCase();
            if (zTemp.indexOf("f") > -1) { viewAdmin.Fire_Init(true); } else { viewAdmin.Fire_Init(false); }
            if (zTemp.indexOf("b") > -1) { viewAdmin.BM_Init(true); } else { viewAdmin.BM_Init(false); }
            if (zTemp.indexOf("i") > -1) { viewAdmin.IR_Init(true); } else { viewAdmin.IR_Init(false); }
            //if (zTemp.indexOf("w") > -1) { viewAdmin.Wind_Init(true); } else { viewAdmin.Wind_Init(false); }
            //if (zTemp.indexOf("s") > -1) { viewAdmin.Seismic_Init(true); } else { viewAdmin.Seismic_Init(false); }
            //if (zTemp.indexOf("l") > -1) { viewAdmin.Flood_Init(true); } else { viewAdmin.Flood_Init(false); }
            if (zTemp.indexOf("w") > -1 || zTemp.indexOf("s") > -1 || zTemp.indexOf("l") > -1 || zTemp.indexOf("n") > -1) { viewAdmin.NatHaz_Init(true); } else { viewAdmin.NatHaz_Init(false); }
            if (zTemp.indexOf("d") > -1) { viewAdmin.DivServ_Init(true); } else { viewAdmin.DivServ_Init(false); }
            if (zTemp.indexOf("p") > -1) { viewAdmin.ProcSafe_Init(true); } else { viewAdmin.ProcSafe_Init(false); }
        }
        //// RPT COLUMN SEARCH FOR FBIWSL
        if (viewAdmin.objUser().colRReport() != undefined) {
            var zTemp = viewAdmin.objUser().colRReport().toLowerCase();
            if (zTemp.indexOf("f") > -1) { viewAdmin.Fire_Rpt(true); } else { viewAdmin.Fire_Rpt(false); }
            if (zTemp.indexOf("b") > -1) { viewAdmin.BM_Rpt(true); } else { viewAdmin.BM_Rpt(false); }
            if (zTemp.indexOf("i") > -1) { viewAdmin.IR_Rpt(true); } else { viewAdmin.IR_Rpt(false); }
            //if (zTemp.indexOf("w") > -1) { viewAdmin.Wind_Rpt(true); } else { viewAdmin.Wind_Rpt(false); }
            //if (zTemp.indexOf("s") > -1) { viewAdmin.Seismic_Rpt(true); } else { viewAdmin.Seismic_Rpt(false); }
            //if (zTemp.indexOf("l") > -1) { viewAdmin.Flood_Rpt(true); } else { viewAdmin.Flood_Rpt(false); }
            if (zTemp.indexOf("w") > -1 || zTemp.indexOf("s") > -1 || zTemp.indexOf("l") > -1 || zTemp.indexOf("n") > -1) { viewAdmin.NatHaz_Rpt(true); } else { viewAdmin.NatHaz_Rpt(false); }
            if (zTemp.indexOf("d") > -1) { viewAdmin.DivServ_Rpt(true); } else { viewAdmin.DivServ_Rpt(false); }
            if (zTemp.indexOf("p") > -1) { viewAdmin.ProcSafe_Rpt(true); } else { viewAdmin.ProcSafe_Rpt(false); }
        }
        //// RFU1 COLUMN SEARCH FOR FBIWSL
        if (viewAdmin.objUser().colRfu1() != undefined) {
            var zTemp = viewAdmin.objUser().colRfu1().toLowerCase();
            if (zTemp.indexOf("f") > -1) { viewAdmin.Fire_1stFU(true); } else { viewAdmin.Fire_1stFU(false); }
            if (zTemp.indexOf("b") > -1) { viewAdmin.BM_1stFU(true); } else { viewAdmin.BM_1stFU(false); }
            if (zTemp.indexOf("i") > -1) { viewAdmin.IR_1stFU(true); } else { viewAdmin.IR_1stFU(false); }
            //if (zTemp.indexOf("w") > -1) { viewAdmin.Wind_1stFU(true); } else { viewAdmin.Wind_1stFU(false); }
            //if (zTemp.indexOf("s") > -1) { viewAdmin.Seismic_1stFU(true); } else { viewAdmin.Seismic_1stFU(false); }
            //if (zTemp.indexOf("l") > -1) { viewAdmin.Flood_1stFU(true); } else { viewAdmin.Flood_1stFU(false); }
            if (zTemp.indexOf("w") > -1 || zTemp.indexOf("s") > -1 || zTemp.indexOf("l") > -1 || zTemp.indexOf("n") > -1) { viewAdmin.NatHaz_1stFU(true); } else { viewAdmin.NatHaz_1stFU(false); }
            if (zTemp.indexOf("d") > -1) { viewAdmin.DivServ_1stFU(true); } else { viewAdmin.DivServ_1stFU(false); }
            if (zTemp.indexOf("p") > -1) { viewAdmin.ProcSafe_1stFU(true); } else { viewAdmin.ProcSafe_1stFU(false); }
        }
        //// RFU2 COLUMN SEARCH FOR FBIWSL
        if (viewAdmin.objUser().colRfu2() != undefined) {
            var zTemp = viewAdmin.objUser().colRfu2().toLowerCase();
            if (zTemp.indexOf("f") > -1) { viewAdmin.Fire_2ndFU(true); } else { viewAdmin.Fire_2ndFU(false); }
            if (zTemp.indexOf("b") > -1) { viewAdmin.BM_2ndFU(true); } else { viewAdmin.BM_2ndFU(false); }
            if (zTemp.indexOf("i") > -1) { viewAdmin.IR_2ndFU(true); } else { viewAdmin.IR_2ndFU(false); }
            //if (zTemp.indexOf("w") > -1) { viewAdmin.Wind_2ndFU(true); } else { viewAdmin.Wind_2ndFU(false); }
            //if (zTemp.indexOf("s") > -1) { viewAdmin.Seismic_2ndFU(true); } else { viewAdmin.Seismic_2ndFU(false); }
            //if (zTemp.indexOf("l") > -1) { viewAdmin.Flood_2ndFU(true); } else { viewAdmin.Flood_2ndFU(false); }
            if (zTemp.indexOf("w") > -1 || zTemp.indexOf("s") > -1 || zTemp.indexOf("l") > -1 || zTemp.indexOf("n") > -1) { viewAdmin.NatHaz_2ndFU(true); } else { viewAdmin.NatHaz_2ndFU(false); }
            if (zTemp.indexOf("d") > -1) { viewAdmin.DivServ_2ndFU(true); } else { viewAdmin.DivServ_2ndFU(false); }
            if (zTemp.indexOf("p") > -1) { viewAdmin.ProcSafe_2ndFU(true); } else { viewAdmin.ProcSafe_2ndFU(false); }
        }
        //// RFU3 COLUMN SEARCH FOR FBIWSL
        if (viewAdmin.objUser().colRfu3() != undefined) {
            var zTemp = viewAdmin.objUser().colRfu3().toLowerCase();
            if (zTemp.indexOf("f") > -1) { viewAdmin.Fire_3rdFU(true); } else { viewAdmin.Fire_3rdFU(false); }
            if (zTemp.indexOf("b") > -1) { viewAdmin.BM_3rdFU(true); } else { viewAdmin.BM_3rdFU(false); }
            if (zTemp.indexOf("i") > -1) { viewAdmin.IR_3rdFU(true); } else { viewAdmin.IR_3rdFU(false); }
            //if (zTemp.indexOf("w") > -1) { viewAdmin.Wind_3rdFU(true); } else { viewAdmin.Wind_3rdFU(false); }
            //if (zTemp.indexOf("s") > -1) { viewAdmin.Seismic_3rdFU(true); } else { viewAdmin.Seismic_3rdFU(false); }
            //if (zTemp.indexOf("l") > -1) { viewAdmin.Flood_3rdFU(true); } else { viewAdmin.Flood_3rdFU(false); }
            if (zTemp.indexOf("w") > -1 || zTemp.indexOf("s") > -1 || zTemp.indexOf("l") > -1 || zTemp.indexOf("n") > -1) { viewAdmin.NatHaz_3rdFU(true); } else { viewAdmin.NatHaz_3rdFU(false); }
            if (zTemp.indexOf("d") > -1) { viewAdmin.DivServ_3rdFU(true); } else { viewAdmin.DivServ_3rdFU(false); }
            if (zTemp.indexOf("p") > -1) { viewAdmin.ProcSafe_3rdFU(true); } else { viewAdmin.ProcSafe_3rdFU(false); }
        }
        //// ROverdue1 COLUMN SEARCH FOR FBIWSL
        if (viewAdmin.objUser().colROverdue1() != undefined) {
            var zTemp = viewAdmin.objUser().colROverdue1().toLowerCase();
            if (zTemp.indexOf("f") > -1) { viewAdmin.Fire_1stOD(true); } else { viewAdmin.Fire_1stOD(false); }
            if (zTemp.indexOf("b") > -1) { viewAdmin.BM_1stOD(true); } else { viewAdmin.BM_1stOD(false); }
            if (zTemp.indexOf("i") > -1) { viewAdmin.IR_1stOD(true); } else { viewAdmin.IR_1stOD(false); }
            //if (zTemp.indexOf("w") > -1) { viewAdmin.Wind_1stOD(true); } else { viewAdmin.Wind_1stOD(false); }
            //if (zTemp.indexOf("s") > -1) { viewAdmin.Seismic_1stOD(true); } else { viewAdmin.Seismic_1stOD(false); }
            //if (zTemp.indexOf("l") > -1) { viewAdmin.Flood_1stOD(true); } else { viewAdmin.Flood_1stOD(false); }
            if (zTemp.indexOf("w") > -1 || zTemp.indexOf("s") > -1 || zTemp.indexOf("l") > -1 || zTemp.indexOf("n") > -1) { viewAdmin.NatHaz_1stOD(true); } else { viewAdmin.NatHaz_1stOD(false); }
            if (zTemp.indexOf("d") > -1) { viewAdmin.DivServ_1stOD(true); } else { viewAdmin.DivServ_1stOD(false); }
            if (zTemp.indexOf("p") > -1) { viewAdmin.ProcSafe_1stOD(true); } else { viewAdmin.ProcSafe_1stOD(false); }
        }
        //// ROverdue2 COLUMN SEARCH FOR FBIWSL
        if (viewAdmin.objUser().colROverdue2() != undefined) {
            var zTemp = viewAdmin.objUser().colROverdue2().toLowerCase();
            if (zTemp.indexOf("f") > -1) { viewAdmin.Fire_2ndOD(true); } else { viewAdmin.Fire_2ndOD(false); }
            if (zTemp.indexOf("b") > -1) { viewAdmin.BM_2ndOD(true); } else { viewAdmin.BM_2ndOD(false); }
            if (zTemp.indexOf("i") > -1) { viewAdmin.IR_2ndOD(true); } else { viewAdmin.IR_2ndOD(false); }
            //if (zTemp.indexOf("w") > -1) { viewAdmin.Wind_2ndOD(true); } else { viewAdmin.Wind_2ndOD(false); }
            //if (zTemp.indexOf("s") > -1) { viewAdmin.Seismic_2ndOD(true); } else { viewAdmin.Seismic_2ndOD(false); }
            //if (zTemp.indexOf("l") > -1) { viewAdmin.Flood_2ndOD(true); } else { viewAdmin.Flood_2ndOD(false); }
            if (zTemp.indexOf("w") > -1 || zTemp.indexOf("s") > -1 || zTemp.indexOf("l") > -1 || zTemp.indexOf("n") > -1) { viewAdmin.NatHaz_2ndOD(true); } else { viewAdmin.NatHaz_2ndOD(false); }
            if (zTemp.indexOf("d") > -1) { viewAdmin.DivServ_2ndOD(true); } else { viewAdmin.DivServ_2ndOD(false); }
            if (zTemp.indexOf("p") > -1) { viewAdmin.ProcSafe_2ndOD(true); } else { viewAdmin.ProcSafe_2ndOD(false); }
        }
        //// ROverdue3 COLUMN SEARCH FOR FBIWSL
        if (viewAdmin.objUser().colROverdue3() != undefined) {
            var zTemp = viewAdmin.objUser().colROverdue3().toLowerCase();
            if (zTemp.indexOf("f") > -1) { viewAdmin.Fire_3rdOD(true); } else { viewAdmin.Fire_3rdOD(false); }
            if (zTemp.indexOf("b") > -1) { viewAdmin.BM_3rdOD(true); } else { viewAdmin.BM_3rdOD(false); }
            if (zTemp.indexOf("i") > -1) { viewAdmin.IR_3rdOD(true); } else { viewAdmin.IR_3rdOD(false); }
            //if (zTemp.indexOf("w") > -1) { viewAdmin.Wind_3rdOD(true); } else { viewAdmin.Wind_3rdOD(false); }
            //if (zTemp.indexOf("s") > -1) { viewAdmin.Seismic_3rdOD(true); } else { viewAdmin.Seismic_3rdOD(false); }
            //if (zTemp.indexOf("l") > -1) { viewAdmin.Flood_3rdOD(true); } else { viewAdmin.Flood_3rdOD(false); }
            if (zTemp.indexOf("w") > -1 || zTemp.indexOf("s") > -1 || zTemp.indexOf("l") > -1 || zTemp.indexOf("n") > -1) { viewAdmin.NatHaz_3rdOD(true); } else { viewAdmin.NatHaz_3rdOD(false); }
            if (zTemp.indexOf("d") > -1) { viewAdmin.DivServ_3rdOD(true); } else { viewAdmin.DivServ_3rdOD(false); }
            if (zTemp.indexOf("p") > -1) { viewAdmin.ProcSafe_3rdOD(true); } else { viewAdmin.ProcSafe_3rdOD(false); }
        }
        //// PastDue COLUMN SEARCH FOR FBIWSL
        if (viewAdmin.objUser().colExpOverdue() != undefined) {
            var zTemp = viewAdmin.objUser().colExpOverdue().toLowerCase();
            if (zTemp.indexOf("f") > -1) { viewAdmin.Fire_PastDue(true); } else { viewAdmin.Fire_PastDue(false); }
            if (zTemp.indexOf("b") > -1) { viewAdmin.BM_PastDue(true); } else { viewAdmin.BM_PastDue(false); }
            if (zTemp.indexOf("i") > -1) { viewAdmin.IR_PastDue(true); } else { viewAdmin.IR_PastDue(false); }
            //if (zTemp.indexOf("w") > -1) { viewAdmin.Wind_PastDue(true); } else { viewAdmin.Wind_PastDue(false); }
            //if (zTemp.indexOf("s") > -1) { viewAdmin.Seismic_PastDue(true); } else { viewAdmin.Seismic_PastDue(false); }
            //if (zTemp.indexOf("l") > -1) { viewAdmin.Flood_PastDue(true); } else { viewAdmin.Flood_PastDue(false); }
            if (zTemp.indexOf("w") > -1 || zTemp.indexOf("s") > -1 || zTemp.indexOf("l") > -1 || zTemp.indexOf("n") > -1) { viewAdmin.NatHaz_PastDue(true); } else { viewAdmin.NatHaz_PastDue(false); }
            if (zTemp.indexOf("d") > -1) { viewAdmin.DivServ_PastDue(true); } else { viewAdmin.DivServ_PastDue(false); }
            if (zTemp.indexOf("p") > -1) { viewAdmin.ProcSafe_PastDue(true); } else { viewAdmin.ProcSafe_PastDue(false); }
        }
        //// Expd COLUMN SEARCH FOR FBIWSL
        if (viewAdmin.objUser().colRExpd() != undefined) {
            var zTemp = viewAdmin.objUser().colRExpd().toLowerCase();
            if (zTemp.indexOf("f") > -1) { viewAdmin.Fire_ExpdFU(true); } else { viewAdmin.Fire_ExpdFU(false); }
            if (zTemp.indexOf("b") > -1) { viewAdmin.BM_ExpdFU(true); } else { viewAdmin.BM_ExpdFU(false); }
            if (zTemp.indexOf("i") > -1) { viewAdmin.IR_ExpdFU(true); } else { viewAdmin.IR_ExpdFU(false); }
            //if (zTemp.indexOf("w") > -1) { viewAdmin.Wind_ExpdFU(true); } else { viewAdmin.Wind_ExpdFU(false); }
            //if (zTemp.indexOf("s") > -1) { viewAdmin.Seismic_ExpdFU(true); } else { viewAdmin.Seismic_ExpdFU(false); }
            //if (zTemp.indexOf("l") > -1) { viewAdmin.Flood_ExpdFU(true); } else { viewAdmin.Flood_ExpdFU(false); }
            if (zTemp.indexOf("w") > -1 || zTemp.indexOf("s") > -1 || zTemp.indexOf("l") > -1 || zTemp.indexOf("n") > -1) { viewAdmin.NatHaz_ExpdFU(true); } else { viewAdmin.NatHaz_ExpdFU(false); }
            if (zTemp.indexOf("d") > -1) { viewAdmin.DivServ_ExpdFU(true); } else { viewAdmin.DivServ_ExpdFU(false); }
            if (zTemp.indexOf("d") > -1) { viewAdmin.ProcSafe_ExpdFU(true); } else { viewAdmin.ProcSafe_ExpdFU(false); }
        }

        //// SET DEFAULTS IF EXIST
        viewAdmin.customAccessTextValue("");
        viewAdmin.divisionValue("");
        viewAdmin.facilityValue("");
        viewAdmin.plantValue("");
        viewAdmin.clientLocNoValue("");
        viewAdmin.cityValue("");
        viewAdmin.stProvValue("");
        viewAdmin.countryValue("");
        if (viewAdmin.objUser().colCustomAccessText() != undefined) { viewAdmin.customAccessTextValue(viewAdmin.objUser().colCustomAccessText()); } else { viewAdmin.customAccessTextValue(""); }
        if (viewAdmin.objUser().colDivision() != undefined) { viewAdmin.divisionValue(viewAdmin.objUser().colDivision()); } else { viewAdmin.divisionValue(""); }
        if (viewAdmin.objUser().colPlant() != undefined) { viewAdmin.plantValue(viewAdmin.objUser().colPlant()); } else { viewAdmin.plantValue(""); }
        if (viewAdmin.objUser().colFacilityText() != undefined) { viewAdmin.facilityValue(viewAdmin.objUser().colFacilityText()); } else { viewAdmin.facilityValue(""); }
        if (viewAdmin.objUser().colClientLocNoText() != undefined) { viewAdmin.clientLocNoValue(viewAdmin.objUser().colClientLocNoText()); } else { viewAdmin.clientLocNoValue(""); }
        if (viewAdmin.objUser().colCityText() != undefined) { viewAdmin.cityValue(viewAdmin.objUser().colCityText()); } else { viewAdmin.cityValue(""); }
        if (viewAdmin.objUser().colStProvText() != undefined) { viewAdmin.stProvValue(viewAdmin.objUser().colStProvText()); } else { viewAdmin.stProvValue(""); }
        if (viewAdmin.objUser().colCountryText() != undefined) { viewAdmin.countryValue(viewAdmin.objUser().colCountryText()); } else { viewAdmin.countryValue(""); }
    },

    buildUserDropdowns: function (pObject) {
        // BUILD USER DROPDOWNS
        var zFound = false;
        if (pObject.City) {
            zFound = false;
            for (var x = 0; x < pObject.City.length; x++) {
                if (!pObject.City[x] || pObject.City[x] == "") {
                    pObject.City[x] = "";
                    zFound = true;
                }
            }
            if (!zFound) { pObject.City.unshift(""); }
            viewAdmin.cityArray(pObject.City);
        }
        if (pObject.ClientLocNo) {
            zFound = false;
            for (var x = 0; x < pObject.ClientLocNo.length; x++) {
                if (!pObject.ClientLocNo[x] || pObject.ClientLocNo[x] == "") {
                    pObject.ClientLocNo[x] = "";
                    zFound = true;
                }
            }
            if (!zFound) { pObject.ClientLocNo.unshift(""); }
            viewAdmin.clientLocNoArray(pObject.ClientLocNo);
        }
        if (pObject.Country) {
            zFound = false;
            for (var x = 0; x < pObject.Country.length; x++) {
                if (!pObject.Country[x] || pObject.Country[x] == "") {
                    pObject.Country[x] = "";
                    zFound = true;
                }
            }
            if (!zFound) { pObject.Country.unshift(""); }
            viewAdmin.countryArray(pObject.Country);
        }
        if (pObject.CustomerAccess) {
            zFound = false;
            for (var x = 0; x < pObject.CustomerAccess.length; x++) {
                if (!pObject.CustomerAccess[x] || pObject.CustomerAccess[x] == "") {
                    pObject.CustomerAccess[x] = "";
                    zFound = true;
                }
            }
            if (!zFound) { pObject.CustomerAccess.unshift(""); }
            viewAdmin.customAccessTextArray(pObject.CustomerAccess);
        }
        if (pObject.Division) {
            zFound = false;
            for (var x = 0; x < pObject.Division.length; x++) {
                if (!pObject.Division[x] || pObject.Division[x] == "") {
                    pObject.Division[x] = "";
                    zFound = true;
                }
            }
            if (!zFound) { pObject.Division.unshift(""); }
            viewAdmin.divisionArray(pObject.Division);
        }
        if (pObject.Facility) {
            zFound = false;
            for (var x = 0; x < pObject.Facility.length; x++) {
                if (!pObject.Facility[x] || pObject.Facility[x] == "") {
                    pObject.Facility[x] = "";
                    zFound = true;
                }
            }
            if (!zFound) { pObject.Facility.unshift(""); }
            viewAdmin.facilityArray(pObject.Facility);
        }
        if (pObject.Location) {
            zFound = false;
            for (var x = 0; x < pObject.Location.length; x++) {
                if (!pObject.Location[x] || pObject.Location[x] == "") {
                    pObject.Location[x] = "";
                    zFound = true;
                }
            }
            if (!zFound) { pObject.Location.unshift(""); }
            viewAdmin.plantArray(pObject.Location);
        }
        if (pObject.StProv) {
            zFound = false;
            for (var x = 0; x < pObject.StProv.length; x++) {
                if (!pObject.StProv[x] || pObject.StProv[x] == "") {
                    pObject.StProv[x] = "";
                    zFound = true;
                }
            }
            if (!zFound) { pObject.StProv.unshift(""); }
            viewAdmin.stProvArray(pObject.StProv);
        }
    },

    buildUserFollowUpsString: function (followUpType) {
        var zReturn = "";
        switch (followUpType) {
            case 1:
                //// RINIT
                if (viewAdmin.Fire_Init()) { zReturn = zReturn + "F"; }
                if (viewAdmin.BM_Init()) { zReturn = zReturn + "B"; }
                if (viewAdmin.IR_Init()) { zReturn = zReturn + "I"; }
                //if (viewAdmin.Wind_Init()) { zReturn = zReturn + "W"; }
                //if (viewAdmin.Seismic_Init()) { zReturn = zReturn + "S"; }
                //if (viewAdmin.Flood_Init()) { zReturn = zReturn + "L"; }
                if (viewAdmin.NatHaz_Init()) { zReturn = zReturn + "N"; }
                if (viewAdmin.DivServ_Init()) { zReturn = zReturn + "D"; }
                if (viewAdmin.ProcSafe_Init()) { zReturn = zReturn + "P"; }
                break;
            case 2:
                //// RREPORT
                if (viewAdmin.Fire_Rpt()) { zReturn = zReturn + "F"; }
                if (viewAdmin.BM_Rpt()) { zReturn = zReturn + "B"; }
                if (viewAdmin.IR_Rpt()) { zReturn = zReturn + "I"; }
                //if (viewAdmin.Wind_Rpt()) { zReturn = zReturn + "W"; }
                //if (viewAdmin.Seismic_Rpt()) { zReturn = zReturn + "S"; }
                //if (viewAdmin.Flood_Rpt()) { zReturn = zReturn + "L"; }
                if (viewAdmin.NatHaz_Rpt()) { zReturn = zReturn + "N"; }
                if (viewAdmin.DivServ_Rpt()) { zReturn = zReturn + "D"; }
                if (viewAdmin.ProcSafe_Rpt()) { zReturn = zReturn + "P"; }
                break;
            case 3:
                //// RFU1
                if (viewAdmin.Fire_1stFU()) { zReturn = zReturn + "F"; }
                if (viewAdmin.BM_1stFU()) { zReturn = zReturn + "B"; }
                if (viewAdmin.IR_1stFU()) { zReturn = zReturn + "I"; }
                //if (viewAdmin.Wind_1stFU()) { zReturn = zReturn + "W"; }
                //if (viewAdmin.Seismic_1stFU()) { zReturn = zReturn + "S"; }
                //if (viewAdmin.Flood_1stFU()) { zReturn = zReturn + "L"; }
                if (viewAdmin.NatHaz_1stFU()) { zReturn = zReturn + "N"; }
                if (viewAdmin.DivServ_1stFU()) { zReturn = zReturn + "D"; }
                if (viewAdmin.ProcSafe_1stFU()) { zReturn = zReturn + "P"; }
                break;
            case 4:
                //// RFU2
                if (viewAdmin.Fire_2ndFU()) { zReturn = zReturn + "F"; }
                if (viewAdmin.BM_2ndFU()) { zReturn = zReturn + "B"; }
                if (viewAdmin.IR_2ndFU()) { zReturn = zReturn + "I"; }
                //if (viewAdmin.Wind_2ndFU()) { zReturn = zReturn + "W"; }
                //if (viewAdmin.Seismic_2ndFU()) { zReturn = zReturn + "S"; }
                //if (viewAdmin.Flood_2ndFU()) { zReturn = zReturn + "L"; }
                if (viewAdmin.NatHaz_2ndFU()) { zReturn = zReturn + "N"; }
                if (viewAdmin.DivServ_2ndFU()) { zReturn = zReturn + "D"; }
                if (viewAdmin.ProcSafe_2ndFU()) { zReturn = zReturn + "P"; }
                break;
            case 5:
                //// RFU3
                if (viewAdmin.Fire_3rdFU()) { zReturn = zReturn + "F"; }
                if (viewAdmin.BM_3rdFU()) { zReturn = zReturn + "B"; }
                if (viewAdmin.IR_3rdFU()) { zReturn = zReturn + "I"; }
                //if (viewAdmin.Wind_3rdFU()) { zReturn = zReturn + "W"; }
                //if (viewAdmin.Seismic_3rdFU()) { zReturn = zReturn + "S"; }
                //if (viewAdmin.Flood_3rdFU()) { zReturn = zReturn + "L"; }
                if (viewAdmin.NatHaz_3rdFU()) { zReturn = zReturn + "N"; }
                if (viewAdmin.DivServ_3rdFU()) { zReturn = zReturn + "D"; }
                if (viewAdmin.ProcSafe_3rdFU()) { zReturn = zReturn + "P"; }
                break;
            case 6:
                //// ROVERDUE1
                if (viewAdmin.Fire_1stOD()) { zReturn = zReturn + "F"; }
                if (viewAdmin.BM_1stOD()) { zReturn = zReturn + "B"; }
                if (viewAdmin.IR_1stOD()) { zReturn = zReturn + "I"; }
                //if (viewAdmin.Wind_1stOD()) { zReturn = zReturn + "W"; }
                //if (viewAdmin.Seismic_1stOD()) { zReturn = zReturn + "S"; }
                //if (viewAdmin.Flood_1stOD()) { zReturn = zReturn + "L"; }
                if (viewAdmin.NatHaz_1stOD()) { zReturn = zReturn + "N"; }
                if (viewAdmin.DivServ_1stOD()) { zReturn = zReturn + "D"; }
                if (viewAdmin.ProcSafe_1stOD()) { zReturn = zReturn + "P"; }
                break;
            case 7:
                //// ROVERDUE2
                if (viewAdmin.Fire_2ndOD()) { zReturn = zReturn + "F"; }
                if (viewAdmin.BM_2ndOD()) { zReturn = zReturn + "B"; }
                if (viewAdmin.IR_2ndOD()) { zReturn = zReturn + "I"; }
                //if (viewAdmin.Wind_2ndOD()) { zReturn = zReturn + "W"; }
                //if (viewAdmin.Seismic_2ndOD()) { zReturn = zReturn + "S"; }
                //if (viewAdmin.Flood_2ndOD()) { zReturn = zReturn + "L"; }
                if (viewAdmin.NatHaz_2ndOD()) { zReturn = zReturn + "N"; }
                if (viewAdmin.DivServ_2ndOD()) { zReturn = zReturn + "D"; }
                if (viewAdmin.ProcSafe_2ndOD()) { zReturn = zReturn + "P"; }
                break;
            case 8:
                //// ROVERDUE3
                if (viewAdmin.Fire_3rdOD()) { zReturn = zReturn + "F"; }
                if (viewAdmin.BM_3rdOD()) { zReturn = zReturn + "B"; }
                if (viewAdmin.IR_3rdOD()) { zReturn = zReturn + "I"; }
                //if (viewAdmin.Wind_3rdOD()) { zReturn = zReturn + "W"; }
                //if (viewAdmin.Seismic_3rdOD()) { zReturn = zReturn + "S"; }
                //if (viewAdmin.Flood_3rdOD()) { zReturn = zReturn + "L"; }
                if (viewAdmin.NatHaz_3rdOD()) { zReturn = zReturn + "N"; }
                if (viewAdmin.DivServ_3rdOD()) { zReturn = zReturn + "D"; }
                if (viewAdmin.ProcSafe_3rdOD()) { zReturn = zReturn + "P"; }
                break;
            case 9:
                //// RPASTDUE
                if (viewAdmin.Fire_PastDue()) { zReturn = zReturn + "F"; }
                if (viewAdmin.BM_PastDue()) { zReturn = zReturn + "B"; }
                if (viewAdmin.IR_PastDue()) { zReturn = zReturn + "I"; }
                //if (viewAdmin.Wind_PastDue()) { zReturn = zReturn + "W"; }
                //if (viewAdmin.Seismic_PastDue()) { zReturn = zReturn + "S"; }
                //if (viewAdmin.Flood_PastDue()) { zReturn = zReturn + "L"; }
                if (viewAdmin.NatHaz_PastDue()) { zReturn = zReturn + "N"; }
                if (viewAdmin.DivServ_PastDue()) { zReturn = zReturn + "D"; }
                if (viewAdmin.ProcSafe_PastDue()) { zReturn = zReturn + "P"; }
                break;
            case 10:
                //// RExpdFU
                if (viewAdmin.Fire_ExpdFU()) { zReturn = zReturn + "F"; }
                if (viewAdmin.BM_ExpdFU()) { zReturn = zReturn + "B"; }
                if (viewAdmin.IR_ExpdFU()) { zReturn = zReturn + "I"; }
                //if (viewAdmin.Wind_ExpdFU()) { zReturn = zReturn + "W"; }
                //if (viewAdmin.Seismic_ExpdFU()) { zReturn = zReturn + "S"; }
                //if (viewAdmin.Flood_ExpdFU()) { zReturn = zReturn + "L"; }
                if (viewAdmin.NatHaz_ExpdFU()) { zReturn = zReturn + "N"; }
                if (viewAdmin.DivServ_ExpdFU()) { zReturn = zReturn + "D"; }
                if (viewAdmin.ProcSafe_ExpdFU()) { zReturn = zReturn + "P"; }
                break;
        }
        return zReturn;
    },

    createUserGridObject: function () {
        gridUsers = $("#gridUsers").kendoGrid({
            dataSource: dsUsers,
            width: 665,
            height: 330,
            pageable: false,
            scrollable: true,
            sortable: false,
            filterable: true,
            editable: false,
            selectable: "row",
            columns: [
            //{ command: { text: viewAdmin.objAdminLanguageLabels().lblEdit, click: onEditUser }, title: "", width: "60px", template: kendo.template($("#templateEditButton").html()) },
                {width: "80px", template: kendo.template($("#templateEditButton").html()), filterable: false, sortable: false },
                { field: "EzyUserID", width: "0px", title: "", filterable: false, sortable: false, template: "<a class='hiddenID' name='#=EzyUserID#' id='#=EzyUserID#'>#=EzyUserID#</a>" },
                { field: "FullName", width: "200px", title: viewAdmin.objAdminLanguageLabels().lblFullName, template: "#= FullName.length > 170 ? FullName.substr(0, 170) + ' ...': FullName #" },
                { field: "Email", width: "300px", title: viewAdmin.objAdminLanguageLabels().lblEmail, template: "#= Email.length > 270 ? Email.substr(0, 270) + ' ...': Email #" },
                { field: "UserID", width: "225px", title: viewAdmin.objAdminLanguageLabels().lblUserID, template: "#= UserID.length > 195 ? UserID.substr(0, 195) + ' ...': UserID #" },
                { field: "Password", width: "100px", title: viewAdmin.objAdminLanguageLabels().lblPassword },
                { field: "DateTimeStamp", width: "100px", title: viewAdmin.objAdminLanguageLabels().lblDateAdded, template: "#= (DateTimeStamp == null || DateTimeStamp == undefined || DateTimeStamp == 'undefined' || DateTimeStamp == '' || DateTimeStamp == 'Mon Jan 1 00:00:00 EST 1900') ? ' ' : kendo.toString(DateTimeStamp, 'dd-MMM-yy') #" },
                { field: "LastLogin", width: "100px", title: viewAdmin.objAdminLanguageLabels().lblLastLogin, template: "#= (LastLogin == null || LastLogin == undefined || LastLogin == 'undefined' || LastLogin == '' || LastLogin == 'Mon Jan 1 00:00:00 EST 1900') ? ' ' : kendo.toString(LastLogin, 'dd-MMM-yy') #" },
                { field: "ActiveUser", width: "85px", title: viewAdmin.objAdminLanguageLabels().lblActiveUser },
                { field: "ThirdParty", width: "85px", title: viewAdmin.objAdminLanguageLabels().lblThirdParty },
                { field: "Internal", width: "85px", title: viewAdmin.objAdminLanguageLabels().lblInternal },
                { field: "GRCAdministrator", width: "85px", title: viewAdmin.objAdminLanguageLabels().lblGRCAdmin },
                { field: "RiskManager", width: "100px", title: viewAdmin.objAdminLanguageLabels().lblAccountAccess },
                { field: "DocumentAccess", width: "85px", title: viewAdmin.objAdminLanguageLabels().lblDocumentAccess },
                { field: "CustomAccess", width: "85px", title: viewAdmin.objAdminLanguageLabels().lblCustAccess },
                { field: "CustomAccessText", width: "150px", title: viewAdmin.objAdminLanguageLabels().lblCustomAccessText, template: "#= CustomAccessText.length > 120 ? CustomAccessText.substr(0, 120) + ' ...': CustomAccessText #" },
                { field: "DivisionManager", width: "100px", title: viewAdmin.objAdminLanguageLabels().lblDivisionManager },
                { field: "Division", width: "200px", title: viewAdmin.objAdminLanguageLabels().lblDiv, template: "#= Division.length > 170 ? Division.substr(0, 170) + ' ...': Division #" },
                { field: "PlantManager", width: "100px", title: viewAdmin.objAdminLanguageLabels().lblPlantManager },
                { field: "Plant", width: "100px", title: viewAdmin.objAdminLanguageLabels().lblPlant },
                { field: "Phone", width: "125px", title: viewAdmin.objAdminLanguageLabels().lblPhone },
                { field: "Fax", width: "125px", title: viewAdmin.objAdminLanguageLabels().lblFax },
                { field: "Comments", width: "250px", title: viewAdmin.objAdminLanguageLabels().lblComments, template: "#= Comments.length > 220 ? Comments.substr(0, 220) + ' ...': Comments #" },
                { field: "CCActive", width: "125px", title: viewAdmin.objAdminLanguageLabels().lblCCgActivity },
                { field: "RInit", width: "100px", title: viewAdmin.objAdminLanguageLabels().lblRInit },
                { field: "RReport", width: "100px", title: viewAdmin.objAdminLanguageLabels().lblRReport },
                { field: "RFU1", width: "100px", title: viewAdmin.objAdminLanguageLabels().lblRFU1 },
                { field: "RFU2", width: "100px", title: viewAdmin.objAdminLanguageLabels().lblRFU2 },
                { field: "RFU3", width: "100px", title: viewAdmin.objAdminLanguageLabels().lblRFU3 },
                { field: "ROverdue1", width: "100px", title: viewAdmin.objAdminLanguageLabels().lblROverdue1 },
                { field: "ROverdue2", width: "100px", title: viewAdmin.objAdminLanguageLabels().lblROverdue2 },
                { field: "ROverdue3", width: "100px", title: viewAdmin.objAdminLanguageLabels().lblROverdue3 },
                { field: "ExpOverdue", width: "100px", title: viewAdmin.objAdminLanguageLabels().lblExpOverdue },
                { field: "WO", width: "100px", title: viewAdmin.objAdminLanguageLabels().lblWorkOrder }
            ]
        }).data("kendoGrid");
    },

    createUserGridColumnTitles: function () {
        viewAdmin.userColumnTitles = [];
        viewAdmin.userColumnTitles.push();
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblFullName);
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblUserID);
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblPassword);
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lbllblDateAdded);
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblLastLogin);
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblActiveUser);
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblThirdParty);
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblInternal);
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lbl);
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblAccountAccess);
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblDocumentAccess);
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblCustAccess);
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblCustomAccessText);
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblDivisionManager);
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblDiv);
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblPlantManager);
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblPlant);
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblPhone);
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblFax);
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblEmail);
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblComments);
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblCCgActivity);
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblRInit);
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblRReport);
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblRFU1);
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblRFU2);
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblRFU3);
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblROverdue1);
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblROverdue2);
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblROverdue3);
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblExpOverdue);
        viewAdmin.userColumnTitles.push(viewAdmin.objAdminLanguageLabels().lbllblWorkOrder);
    },

    createUserGridDataSourceObject: function () {
        dsUsers = new kendo.data.DataSource({
            serverOperation: false,
            data: viewAdmin.collGridDS(),
            schema: {
                model: {
                    id: "EzyUserID",
                    fields: {
                        EzyUserID: { type: "string", editable: false },
                        UserID: { type: "string", editable: true },
                        Password: { type: "string", editable: true },
                        FullName: { type: "string", editable: true },
                        RiskManager: { type: "string", editable: true },
                        DivisionManager: { type: "string", editable: true },
                        Division: { type: "string", editable: true },
                        PlantManager: { type: "string", editable: true },
                        Plant: { type: "string", editable: true },
                        Administrator: { type: "string", editable: true },
                        DocumentAccess: { type: "string", editable: true },
                        CustomAccess: { type: "string", editable: true },
                        CustomAccessText: { type: "string", editable: true },
                        OperatorStamp: { type: "string", editable: true },
                        DateTimeStamp: { type: "date", editable: true },
                        Phone: { type: "string", editable: true },
                        Fax: { type: "string", editable: true },
                        Email: { type: "string", editable: true },
                        NotificationStamp: { type: "date", editable: true },
                        ActiveUser: { type: "string", editable: true },
                        FilePrefix: { type: "string", editable: true },
                        LastLogin: { type: "date", editable: true },
                        LastPWChange: { type: "date", editable: true },
                        ExpEmailCode: { type: "string", editable: true },
                        Internal: { type: "string", editable: true },
                        Comments: { type: "string", editable: true },
                        CCActive: { type: "string", editable: true },
                        RInit: { type: "string", editable: true },
                        RFU1: { type: "string", editable: true },
                        RFU2: { type: "string", editable: true },
                        RFU3: { type: "string", editable: true },
                        RReport: { type: "string", editable: true },
                        ROverdue1: { type: "string", editable: true },
                        ROverdue2: { type: "string", editable: true },
                        ROverdue3: { type: "string", editable: true },
                        ExpOverdue: { type: "string", editable: true },
                        WO: { type: "string", editable: true },
                        calist: { type: "string", editable: true },
                        divlist: { type: "string", editable: true },
                        loclist: { type: "string", editable: true },
                        ThirdParty: { type: "string", editable: true },
                        GRCAdministrator: { type: "string", editable: true },
                        LastRecentUpdate: { type: "date", editable: true },
                        DisableEmail: { type: "string", editable: true }
                    }
                }
            }
        });
    },

    buildUsersGrid: function () {
        viewAdmin.collGridDS([]);
        for (y = 0; y < viewAdmin.collUserGrid.length; y++) {
            viewAdmin.collGridDS().push({
                EzyUserID: viewAdmin.collUserGrid[y].colEzyUserID,
                FullName: viewAdmin.collUserGrid[y].colFullName,
                UserID: viewAdmin.collUserGrid[y].colUserID,
                Password: viewAdmin.collUserGrid[y].colPassword,
                DateTimeStamp: viewAdmin.collUserGrid[y].colDateTimeStamp,
                LastLogin: viewAdmin.collUserGrid[y].colLastLogin,
                ActiveUser: viewAdmin.collUserGrid[y].colActiveUser,
                ThirdParty: viewAdmin.collUserGrid[y].colThirdparty,
                Internal: viewAdmin.collUserGrid[y].colInternal,
                GRCAdministrator: viewAdmin.collUserGrid[y].colGrcadministrator,
                RiskManager: viewAdmin.collUserGrid[y].colRiskManager,
                DocumentAccess: viewAdmin.collUserGrid[y].colDocumentAccess,
                ClientAdministration: viewAdmin.collUserGrid[y].colClientAdministration,
                CustomAccess: viewAdmin.collUserGrid[y].colCustomAccess,
                CustomAccessText: viewAdmin.collUserGrid[y].colCustomAccessText,
                DivisionManager: viewAdmin.collUserGrid[y].colDivisionManager,
                Division: viewAdmin.collUserGrid[y].colDivision,
                PlantManager: viewAdmin.collUserGrid[y].colPlantManager,
                Plant: viewAdmin.collUserGrid[y].colPlant,
                Phone: viewAdmin.collUserGrid[y].colPhone,
                Fax: viewAdmin.collUserGrid[y].colFax,
                Email: viewAdmin.collUserGrid[y].colEmail,
                Comments: viewAdmin.collUserGrid[y].colComments,
                CCActive: viewAdmin.collUserGrid[y].colCCActive,
                RInit: viewAdmin.collUserGrid[y].colRInit,
                RReport: viewAdmin.collUserGrid[y].colRReport,
                RFU1: viewAdmin.collUserGrid[y].colRfu1,
                RFU2: viewAdmin.collUserGrid[y].colRfu2,
                RFU3: viewAdmin.collUserGrid[y].colRfu3,
                ROverdue1: viewAdmin.collUserGrid[y].colROverdue1,
                ROverdue2: viewAdmin.collUserGrid[y].colROverdue2,
                ROverdue3: viewAdmin.collUserGrid[y].colROverdue3,
                ExpOverdue: viewAdmin.collUserGrid[y].colExpOverdue,
                WO: viewAdmin.collUserGrid[y].colWo
            });
        }
    },

    buildEmptyUsersGrid: function () {
        document.getElementById("radEmailNone").checked = true;
        viewAdmin.emailFlag("emailNone");
        var tempUser = buildAdminWindowEmptyUser();
        tempUser.addNew();
        viewAdmin.collGridDS([]);
        viewAdmin.collGridDS().push({
            EzyUserID: tempUser[0].colEzyUserID,
            FullName: tempUser[0].colFullName,
            UserID: tempUser[0].colUserID,
            Password: tempUser[0].colPassword,
            DateTimeStamp: tempUser[0].colDateTimeStamp,
            LastLogin: tempUser[0].colLastLogin,
            ActiveUser: tempUser[0].colActiveUser,
            ThirdParty: tempUser[0].colThirdParty,
            Internal: tempUser[0].colInternal,
            GRCAdministrator: tempUser[0].colGrcadministrator,
            RiskManager: tempUser[0].colRiskManager,
            DocumentAccess: tempUser[0].colDocumentAccess,
            CustomAccess: tempUser[0].colCustomAccess,
            CustomAccessText: tempUser[0].colCustomAccessText,
            DivisionManager: tempUser[0].colDivisionManager,
            Division: tempUser[0].colDivision,
            PlantManager: tempUser[0].colPlantManager,
            Plant: tempUser[0].colPlant,
            Phone: tempUser[0].colPhone,
            Fax: tempUser[0].colFax,
            Email: tempUser[0].colEmail,
            Comments: tempUser[0].colComments,
            CCActive: tempUser[0].colCCActive,
            RInit: tempUser[0].colRInit,
            RReport: tempUser[0].colRReport,
            RFU1: tempUser[0].colRfu1,
            RFU2: tempUser[0].colRfu2,
            RFU3: tempUser[0].colRfu3,
            ROverdue1: tempUser[0].colROverdue1,
            ROverdue2: tempUser[0].colROverdue2,
            ROverdue3: tempUser[0].colROverdue3,
            ExpOverdue: tempUser[0].colExpOverdue,
            WO: tempUser[0].colWo
        });
    },
    //// END USER ACTIVITY FUNCTIONS
    ////////////////////////


    ////////////////////////
    ////////////////////////
    //// PLAN PROJECT REVIEW FUNCTIONS
    onCloseCancelContinue_PlanProject: function () {
        windowAdmin.data("kendoWindow").close();
        windowAdminTabStrip.select(0);
        global_IsAdminWindowOpen = false;
    },

    onAddNewPlanProject: function () {
        viewAdmin.editNewModePlanProject = "new";
        viewAdmin.objPlanProject(viewAdmin.collPlanProject.addNew());
        Admin_PlanProject_Received.value("");
        Admin_PlanProject_Reviewed.value("");
        viewAdmin.planProjectFileNoValue(getFileNo(viewAdmin.gSafeGuid));
        if (!global_IsMainGaugePage) {
            cboPlanProject_FileNo.find(".k-dropdown-wrap").removeClass("editRequired");
            viewAdmin.enablePlanProjectFileNo(false);
        } else {
            cboPlanProject_FileNo.find(".k-dropdown-wrap").addClass("editRequired");
            viewAdmin.enablePlanProjectFileNo(true);
        }
        viewAdmin.messagePlanProjectDetails("");
        viewAdmin.enableDeletePlanProject(false);
        $('#btnPlanProjectDelete').addClass('grcRedDisabledBtn');
        $("#divPlanProject_FilePicker").fadeOut();
        $("#divPlanProject_PlanProjectGrid").fadeOut(function () {
            $("#divPlanProject_PlanProjectDetailForm").fadeIn();
        });
        if (PracticeType) {
            PracticeType.find(".k-dropdown-wrap").addClass("editRequired");
            viewAdmin.practiceTypeValue("520");
            viewAdmin.enablePracticeType(true);
        }
    },

    onSavePlanProject: function () {
        viewAdmin.messagePlanProjectDetails("");
        var tempUserSaveValid = true;
        var tempTab = viewAdmin.currentTab;
        var cell = undefined;
        var row = undefined;

        //// VALIDATE FIELDS
        if (viewAdmin.objPlanProject().ProjectNo() > 32750) {
            tempUserSaveValid = false;
            $("#lblMessagePlanProjectDetails").removeClass("messageNotice");
            $("#lblMessagePlanProjectDetails").addClass("messageError");
            viewAdmin.messagePlanProjectDetails(viewAdmin.objAdminLanguageLabels().lblPleaseEnterValidProjectNumber);
        }
        if (viewAdmin.objPlanProject().ProjectNo() < -32750) {
            tempUserSaveValid = false;
            $("#lblMessagePlanProjectDetails").removeClass("messageNotice");
            $("#lblMessagePlanProjectDetails").addClass("messageError");
            viewAdmin.messagePlanProjectDetails(viewAdmin.objAdminLanguageLabels().lblPleaseEnterValidProjectNumber);
        }
        if (viewAdmin.objPlanProject().Contact() == undefined || viewAdmin.objPlanProject().Contact().length < 1) {
            tempUserSaveValid = false;
            $("#lblMessagePlanProjectDetails").removeClass("messageNotice");
            $("#lblMessagePlanProjectDetails").addClass("messageError");
            viewAdmin.messagePlanProjectDetails(viewAdmin.objAdminLanguageLabels().lblPleaseEnterSubmittedBy);
        }
        if (viewAdmin.objPlanProject().Subject() == undefined || viewAdmin.objPlanProject().Subject().length < 1) {
            tempUserSaveValid = false;
            $("#lblMessagePlanProjectDetails").removeClass("messageNotice");
            $("#lblMessagePlanProjectDetails").addClass("messageError");
            viewAdmin.messagePlanProjectDetails(viewAdmin.objAdminLanguageLabels().lblPleaseEnterProject);
        }
        if (viewAdmin.objPlanProject().Consultant() == undefined || viewAdmin.objPlanProject().Consultant().length < 1) {
            tempUserSaveValid = false;
            $("#lblMessagePlanProjectDetails").removeClass("messageNotice");
            $("#lblMessagePlanProjectDetails").addClass("messageError");
            viewAdmin.messagePlanProjectDetails(viewAdmin.objAdminLanguageLabels().lblPleaseEnterConsultant);
        }
        if (Admin_PlanProject_Reviewed.value() == undefined || Admin_PlanProject_Reviewed.value().length < 1) {
            tempUserSaveValid = false;
            $("#lblMessagePlanProjectDetails").removeClass("messageNotice");
            $("#lblMessagePlanProjectDetails").addClass("messageError");
            viewAdmin.messagePlanProjectDetails(viewAdmin.objAdminLanguageLabels().lblPleaseEnterReviewedDate);
        }
        if (viewAdmin.objPlanProject().ToReview() == undefined || viewAdmin.objPlanProject().ToReview().length < 1) {
            tempUserSaveValid = false;
            $("#lblMessagePlanProjectDetails").removeClass("messageNotice");
            $("#lblMessagePlanProjectDetails").addClass("messageError");
            viewAdmin.messagePlanProjectDetails(viewAdmin.objAdminLanguageLabels().lblPleaseEnterFileToReview);
        }
        var zToday = new Date();
        // RECEIVED VALUE CANNOT BE MORE THAN TODAY
        if (Admin_PlanProject_Received.value() != null && Admin_PlanProject_Received.value() > zToday) {
            tempUserSaveValid = false;
            $("#lblMessagePlanProjectDetails").removeClass("messageNotice");
            $("#lblMessagePlanProjectDetails").addClass("messageError");
            viewAdmin.messagePlanProjectDetails(viewAdmin.objAdminLanguageLabels().lblPleaseEnterValidRecievedDate);
        }
        if (Admin_PlanProject_Received.value() == null && $("#Admin_PlanProject_Received").val() != null && $("#Admin_PlanProject_Received").val() != "") {
            var zTempDate = global.convertGRCStringToDate($("#Admin_PlanProject_Received").val());
            if (zTempDate > zToday) {
                tempUserSaveValid = false;
                $("#lblMessagePlanProjectDetails").removeClass("messageNotice");
                $("#lblMessagePlanProjectDetails").addClass("messageError");
                viewAdmin.messagePlanProjectDetails(viewAdmin.objAdminLanguageLabels().lblPleaseEnterValidRecievedDate);
            }
        }
        // REVIEWED VALUE CANNOT BE MORE THAN TODAY
        if (Admin_PlanProject_Reviewed.value() != null && Admin_PlanProject_Reviewed.value() > zToday) {
            tempUserSaveValid = false;
            $("#lblMessagePlanProjectDetails").removeClass("messageNotice");
            $("#lblMessagePlanProjectDetails").addClass("messageError");
            viewAdmin.messagePlanProjectDetails(viewAdmin.objAdminLanguageLabels().lblPleaseEnterValidReviewedDate);
        }
        if (Admin_PlanProject_Reviewed.value() == null && $("#Admin_PlanProject_Reviewed").val() != null && $("#Admin_PlanProject_Reviewed").val() != "") {
            var zTempDate = global.convertGRCStringToDate($("#Admin_PlanProject_Reviewed").val());
            if (zTempDate > zToday) {
                tempUserSaveValid = false;
                $("#lblMessagePlanProjectDetails").removeClass("messageNotice");
                $("#lblMessagePlanProjectDetails").addClass("messageError");
                viewAdmin.messagePlanProjectDetails(viewAdmin.objAdminLanguageLabels().lblPleaseEnterValidReviewedDate);
            }
        }

        //// TRANSFER DATA FROM DOM WIDGETS TO OBJECT IN VIEW
        viewAdmin.objPlanProject().Received(Admin_PlanProject_Received.value());
        viewAdmin.objPlanProject().Mailed(Admin_PlanProject_Reviewed.value());
        viewAdmin.objPlanProject().FileNo(viewAdmin.planProjectFileNoValue());

        if (tempUserSaveValid) {
            if (viewAdmin.editNewModePlanProject == "edit") {
                //es.dataProvider.baseURL = SITEBASEURL + DATASERVERENDPOINT;
                //viewAdmin.objPlanProject().save();
                var tempObjPlanProject = undefined;
                switch (tempTab) {
                    case "9": case "782": case "791":
                        tempObjPlanProject = new es.objects.FirePlanReview();
                        break;
                    case "10": case "783": case "792":
                        tempObjPlanProject = new es.objects.BMPlanReview();
                        break;
                    default:
                        if (viewAdmin.practiceTypeValue() == "510") {
                            tempObjPlanProject = new es.objects.BMPlanReview();
                        } else {
                            tempObjPlanProject = new es.objects.FirePlanReview();
                        }
                        break;
                }
                es.dataProvider.baseURL = SITEBASEURL + DATASERVERENDPOINT;
                tempObjPlanProject.loadByPrimaryKey(viewAdmin.objPlanProject().Id());
                tempObjPlanProject.FileNo(viewAdmin.objPlanProject().FileNo());
                tempObjPlanProject.Contact(viewAdmin.objPlanProject().Contact());
                tempObjPlanProject.ContactPhone(viewAdmin.objPlanProject().ContactPhone());
                tempObjPlanProject.Subject(viewAdmin.objPlanProject().Subject());
                tempObjPlanProject.Consultant(viewAdmin.objPlanProject().Consultant());
                tempObjPlanProject.Received(viewAdmin.objPlanProject().Received());
                tempObjPlanProject.Mailed(viewAdmin.objPlanProject().Mailed());
                tempObjPlanProject.ToReview(viewAdmin.objPlanProject().ToReview());
                tempObjPlanProject.ProjectNo(viewAdmin.objPlanProject().ProjectNo());
                tempObjPlanProject.Comments(viewAdmin.objPlanProject().Comments());
                es.dataProvider.baseURL = SITEBASEURL + DATASERVERENDPOINT;
                tempObjPlanProject.save();
            } else {
                var tempCollPlanProject = undefined;
                switch (tempTab) {
                    case "9": case "782": case "791":
                        tempCollPlanProject = new es.objects.FirePlanReviewCollection();
                        break;
                    case "10": case "783": case "792":
                        tempCollPlanProject = new es.objects.BMPlanReviewCollection();
                        break;
                    default:
                        if (viewAdmin.practiceTypeValue() == "510") {
                            tempCollPlanProject = new es.objects.BMPlanReviewCollection();
                        } else {
                            tempCollPlanProject = new es.objects.FirePlanReviewCollection();
                        }
                        break;
                }
                var tempObjPlanProject = tempCollPlanProject.addNew();
                //tempObjPlanProject.Id(viewAdmin.objPlanProject().Id());
                tempObjPlanProject.FileNo(viewAdmin.planProjectFileNoValue());
                tempObjPlanProject.Contact(viewAdmin.objPlanProject().Contact());
                tempObjPlanProject.ContactPhone(viewAdmin.objPlanProject().ContactPhone());
                tempObjPlanProject.Subject(viewAdmin.objPlanProject().Subject());
                tempObjPlanProject.Consultant(viewAdmin.objPlanProject().Consultant());
                tempObjPlanProject.Received(Admin_PlanProject_Received.value());
                tempObjPlanProject.Mailed(Admin_PlanProject_Reviewed.value());
                tempObjPlanProject.ToReview(viewAdmin.objPlanProject().ToReview());
                tempObjPlanProject.ProjectNo(viewAdmin.objPlanProject().ProjectNo());
                tempObjPlanProject.Comments(viewAdmin.objPlanProject().Comments());
                es.dataProvider.baseURL = SITEBASEURL + DATASERVERENDPOINT;
                tempCollPlanProject.save();
            }
            switch (tempTab) {
                case "1":
                    viewAdmin.onLoadAllPlanProjectGrid();
                    viewAdmin.onCancelPlanProject();
                    if (viewAdmin.editNewModePlanProject == "edit") {
                        cell = $("#" + parseInt(viewAdmin.objPlanProject().Id()));
                        row = cell.closest("tr");
                    }
                    break;
                case "9": case "782": case "791":
                    viewAdmin.onLoadFirePlanProjectGrid();
                    viewAdmin.onCancelPlanProject();
                    if (viewAdmin.editNewModePlanProject == "edit") {
                        cell = $("#" + parseInt(viewAdmin.objPlanProject().Id()));
                        row = cell.closest("tr");
                    }
                    break;
                case "10": case "783": case "792":
                    viewAdmin.onLoadBMPlanProjectGrid();
                    viewAdmin.onCancelPlanProject();
                    if (viewAdmin.editNewModePlanProject == "edit") {
                        cell = $("#" + parseInt(viewAdmin.objPlanProject().Id()));
                        row = cell.closest("tr");
                    }
                    break;
                default:
                    viewAdmin.onLoadAllPlanProjectGrid();
                    viewAdmin.onCancelPlanProject();
                    if (viewAdmin.editNewModePlanProject == "edit") {
                        cell = $("#" + parseInt(viewAdmin.objPlanProject().Id()));
                        row = cell.closest("tr");
                    }
                    break;
            }
        }
    },

    onDeletePlanProject: function () {
        viewAdmin.messagePlanProjectDetails("");
        var tempTab = viewAdmin.currentTab;
        var tempPlanProject = undefined;
        var yesno = confirm(viewAdmin.objAdminLanguageLabels().lblAreYouSureDeletePlanProject);
        if (yesno) {
            switch (tempTab) {
                case "9": case "782": case "791":
                    tempPlanProject = new es.objects.FirePlanReview();
                    break;
                case "10": case "783": case "792":
                    tempPlanProject = new es.objects.BMPlanReview();
                    break;
                default:
                    if (viewAdmin.practiceTypeValue() == "510") {
                        tempPlanProject = new es.objects.BMPlanReview();
                    } else {
                        tempPlanProject = new es.objects.FirePlanReview();
                    }
                    break;
            }
            es.dataProvider.baseURL = SITEBASEURL + DATASERVERENDPOINT;
            if (tempPlanProject.loadByPrimaryKey(viewAdmin.objPlanProject().Id())) {
                tempPlanProject.markAsDeleted();
                tempPlanProject.save();
                Admin_PlanProject_Received.value("");
                Admin_PlanProject_Reviewed.value("");
                switch (tempTab) {
                    case "9": case "782": case "791":
                        viewAdmin.onLoadFirePlanProjectGrid();
                        break;
                    case "10": case "783": case "792":
                        viewAdmin.onLoadBMPlanProjectGrid();
                        break;
                    default:
                        viewAdmin.onLoadAllPlanProjectGrid();
                        break;
                }
                viewAdmin.onCancelPlanProject();
            } else {
                viewAdmin.messagePlanProjectDetails(viewAdmin.objAdminLanguageLabels().lblErrorDeletePlanProject);
            }
        }
    },

    onCancelPlanProject: function () {
        $("#divPlanProject_FilePicker").fadeOut();
        $("#divPlanProject_PlanProjectDetailForm").fadeOut(function () {
            $("#divPlanProject_PlanProjectGrid").fadeIn();
            viewAdmin.messagePlanProjectDetails("");
            Admin_PlanProject_Received.value("");
            Admin_PlanProject_Reviewed.value("");
        });
    },

    onResetPlanProject: function () {
        $("#divPlanProject_FilePicker").css("display", "none");
        $("#divPlanProject_PlanProjectDetailForm").css("display", "none");
        $("#divPlanProject_PlanProjectGrid").fadeIn();
        viewAdmin.messagePlanProjectDetails("");
        Admin_PlanProject_Received.value("");
        Admin_PlanProject_Reviewed.value("");
    },

    onExportPlanProject: function () {
    },

    onCancelPlanProjectPicker: function () {
        $("#divPlanProject_PlanProjectGrid").fadeOut();
        $("#divPlanProject_FilePicker").fadeOut(function () {
            $("#divPlanProject_PlanProjectDetailForm").fadeIn();
            viewAdmin.messagePlanProjectDetails("");
        });
    },

    onClearToReview: function () {
        viewAdmin.objPlanProject().ToReview("");
    },

    onOpenToReviewPicker: function () {
        viewAdmin.messagePlanProjectDetails("");
        $("#divPlanProject_PlanProjectGrid").fadeOut();
        $("#divPlanProject_PlanProjectDetailForm").fadeOut(function () {
            $("#divPlanProject_FilePicker").fadeIn();
        });
    },

    buildPlanProjectDetails: function () {
    },

    onBuildAdminPlanProjectLink: function (fileName) {
        //var tempExt = fileName.substring(fileName.length - 6, fileName.length);
        //if (tempExt.indexOf("pdf" > -1) || tempExt.indexOf("xls" > -1) || tempExt.indexOf("xlsx" > -1)) {
        buildFileOpenLink(fileName, viewAdmin.gSafeGuid, "", "", false);
        //}
    },

    createPlanProjectGridObject: function () {
        gridPlanProject = $("#gridPlanProject").kendoGrid({
            dataSource: dsPlanProject,
            width: 665,
            height: 305,
            pageable: false,
            scrollable: true,
            sortable: false,
            filterable: true,
            editable: false,
            selectable: "row",
            columns: [
                { width: "80px", template: kendo.template($("#templatePlanProjectEditButton").html()), filterable: false, sortable: false },
                { field: "Id", width: "0px", title: "", filterable: false, sortable: false, template: "<a class='hiddenID' name='#=Id#' id='#=Id#'>#=Id#</a>" },
                { field: "FileNo", width: "75px", title: viewAdmin.objAdminLanguageLabels().lblFileNo },
                { field: "PracticeCode", width: "100px", title: viewAdmin.objAdminLanguageLabels().lblPracticeCode },
                { field: "ProjectNo", width: "75px", title: viewAdmin.objAdminLanguageLabels().lblProjectNo },
                { field: "Contact", width: "150px", title: viewAdmin.objAdminLanguageLabels().lblSubmittedBy },
                { field: "ContactPhone", width: "250px", title: viewAdmin.objAdminLanguageLabels().lblEmailPhone, template: "#= ContactPhone.length > 220 ? ContactPhone.substr(0, 220) + ' ...': ContactPhone #" },
                { field: "Subject", width: "300px", title: viewAdmin.objAdminLanguageLabels().lblProject, template: "#= Subject.length > 270 ? Subject.substr(0, 270) + ' ...': Subject #" },
                { field: "Consultant", width: "175px", title: viewAdmin.objAdminLanguageLabels().lblConsultant, template: "#= Consultant.length > 145 ? Consultant.substr(0, 145) + ' ...': Consultant #" },
                { field: "Comments", width: "250px", title: viewAdmin.objAdminLanguageLabels().lblComments, template: "#= Comments.length > 220 ? Comments.substr(0, 220) + ' ...': Comments #" },
                { field: "Received", width: "100px", title: viewAdmin.objAdminLanguageLabels().lblReceived, template: "#= (Received == null || Received == undefined || Received == 'undefined' || Received == '' || Received == 'Mon Jan 1 00:00:00 EST 1900') ? ' ' : kendo.toString(Received, 'dd-MMM-yy') #" },
                { field: "Mailed", width: "100px", title: viewAdmin.objAdminLanguageLabels().lblReviewed, template: "#= (Mailed == null || Mailed == undefined || Mailed == 'undefined' || Mailed == '' || Mailed == 'Mon Jan 1 00:00:00 EST 1900') ? ' ' : kendo.toString(Mailed, 'dd-MMM-yy') #" },
                { field: "ToReview", width: "400px", title: viewAdmin.objAdminLanguageLabels().lblToReview, template: "#= ToReview.length > 260 ? ToReview.substr(0, 260) + ' ...': ToReview #" }
            ]
        }).data("kendoGrid");
    },

    createPlanProjectGridColumnTitles: function () {
        viewAdmin.planProjectColumnTitles = [];
        viewAdmin.planProjectColumnTitles.push();
        viewAdmin.planProjectColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblFileNo);
        viewAdmin.planProjectColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblPracticeCode);
        viewAdmin.planProjectColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblProjectNo);
        viewAdmin.planProjectColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblSubmittedBy);
        viewAdmin.planProjectColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblEmailPhone);
        viewAdmin.planProjectColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblProject);
        viewAdmin.planProjectColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblConsultant);
        viewAdmin.planProjectColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblComments);
        viewAdmin.planProjectColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblReceived);
        viewAdmin.planProjectColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblReviewed);
        viewAdmin.planProjectColumnTitles.push(viewAdmin.objAdminLanguageLabels().lblToReview);
    },

    createPlanProjectGridDataSourceObject: function () {
        dsPlanProject = new kendo.data.DataSource({
            serverOperation: false,
            data: viewAdmin.collGridPlanProjectDS(),
            schema: {
                model: {
                    id: "Id",
                    fields: {
                        Id: { type: "string", editable: false },
                        FileNo: { type: "string", editable: true },
                        PracticeCode: { type: "string", editable: false },
                        ProjectNo: { type: "string", editable: true },
                        Contact: { type: "string", editable: true },
                        ContactPhone: { type: "string", editable: true },
                        Subject: { type: "string", editable: true },
                        Consultant: { type: "string", editable: true },
                        Comments: { type: "string", editable: true },
                        Received: { type: "date", editable: true },
                        Mailed: { type: "date", editable: true },
                        ToReview: { type: "string", editable: true }
                    }
                }
            }
        });
    },

    buildPlanProjectGrid: function () {
        viewAdmin.collGridPlanProjectDS([]);
        for (y = 0; y < viewAdmin.collPlanProjectGrid().length; y++) {
            viewAdmin.collGridPlanProjectDS().push({
                Id: viewAdmin.collPlanProjectGrid()[y].Id(),
                FileNo: viewAdmin.collPlanProjectGrid()[y].FileNo(),
                PracticeCode: viewAdmin.collPlanProjectGrid()[y].PracticeCode(),
                ProjectNo: viewAdmin.collPlanProjectGrid()[y].ProjectNo(),
                Contact: viewAdmin.collPlanProjectGrid()[y].Contact(),
                ContactPhone: viewAdmin.collPlanProjectGrid()[y].ContactPhone(),
                Subject: viewAdmin.collPlanProjectGrid()[y].Subject(),
                Consultant: viewAdmin.collPlanProjectGrid()[y].Consultant(),
                Comments: viewAdmin.collPlanProjectGrid()[y].Comments(),
                Received: viewAdmin.collPlanProjectGrid()[y].Received(),
                Mailed: viewAdmin.collPlanProjectGrid()[y].Mailed(),
                ToReview: viewAdmin.collPlanProjectGrid()[y].ToReview()
            });
        }
    },
    //// PLAN PROJECT REVIEW FUNCTIONS
    ////////////////////////


    ////////////////////////
    ////////////////////////
    //// MISC FUNCTIONS
    replaceString: function (str, replaceStr, newStr) {
        var returnStr = "";
        var temp = "";
        for (var i = 0; i <= str.length; i++) {
            if (str[i] == replaceStr) {
                temp = newStr;
            }
            else {
                temp = str[i];
            }
            returnStr += temp;
        }
        return returnStr;
    }
    //// END MISC FUNCTIONS
    ////////////////////////
    ////////////////////////
};


///////////////////////////////////////////
//// SETUP BUTTONS
viewAdmin.currentTab = getCurrentTabId(viewAdmin.gSafeGuid);
viewAdmin.txtCloseCancelContinue_Document(viewAdmin.objAdminLanguageLabels().lblCancel);
viewAdmin.txtCloseCancelContinue_Import(viewAdmin.objAdminLanguageLabels().lblCancel);
viewAdmin.txtCloseCancelContinue_Rec(viewAdmin.objAdminLanguageLabels().lblCancel);
viewAdmin.txtCloseCancelContinue_User(viewAdmin.objAdminLanguageLabels().lblCancel);
viewAdmin.txtCloseCancelContinue_PlanProject(viewAdmin.objAdminLanguageLabels().lblCancel);
viewAdmin.messageImport(viewAdmin.objAdminLanguageLabels().lblResults);


///////////////////////////////////////////
//// SETUP DATASOURCE AND GRID
var dsUsers;
viewAdmin.createUserGridDataSourceObject();
var gridUsers;
viewAdmin.createUserGridObject();
var dsPlanProject;
viewAdmin.createPlanProjectGridDataSourceObject();
var gridPlanProject;
viewAdmin.createPlanProjectGridObject();



/////////////////////////////////////////////
////// LOAD DATA
viewAdmin.onLoadEmptyTabs();


///////////////////////////////////////////
//// ACTIVATE BINDINGS
ko.applyBindings(viewAdmin, $("#viewAdmin")[0]);

///////////////////////////////////////////
//// SETUP KENDOUI
//setTimeout(function () {
var windowAdminTabStrip = null;
setupAdminKendoTabStrip();
var windowAdminUpload = null;
var Admin_RecResponse_DateOfInspection = null;
var Admin_RecResponse_DateMailedToClient = null;
var Admin_RecResponse_LastEmailSentOn = null;
var Admin_Document_DateOfInspection = null;
var Admin_Document_DateMailedToClient = null;
var Admin_PlanProject_Received = null;
var Admin_PlanProject_Reviewed = null;

var cboRecResponse_Hazard = null;

var cboUser_CustomAccessText = null;
var cboUser_Division = null;
var cboUser_Plant = null;
var cboUser_ClientLocNo = null;
var cboUser_Facility = null;
var cboUser_City = null;
var cboUser_StProv = null;
var cboUser_Country = null;

var cboPlanProject_FileNo = null;
var PracticeType = null;

function setupAdminKendoTabStrip() {
    //// ADMIN TABSTRIP
    windowAdminTabStrip = $("#windowAdminTabStrip").kendoTabStrip({
        select: viewAdmin.onTabstripSelect,
        //activate: viewAdmin.onTabstripActivate,
        animation: { open: { effects: "fadeIn"} }
    }).data("kendoTabStrip");
    if (!global_IsMainGaugePage) {
        windowAdminTabStrip.select(0);
    } else {
        windowAdminTabStrip.select(0); //3
    }
    global_IsAdminWindowOpen = false;
}

function setupAdminKendo() {
    //// IMPORT UPLOADER
    windowAdminUpload = $("#windowAdminUpload").kendoUpload({
        async: {
            saveUrl: "../Imports/ImportHandler.ashx",
            autoUpload: false
        },
        localization: {
            select: "Select Files...",
            uploadSelectedFiles: "Start Import"
        },
        //complete: viewAdmin.onComplete,
        remove: viewAdmin.onUploadCancel,
        cancel: viewAdmin.onUploadCancel,
        select: viewAdmin.onUploadSelect,
        progress: viewAdmin.onUploadProgress,
        success: viewAdmin.onUploadSuccess,
        error: viewAdmin.onUploadError,
        upload: viewAdmin.onUpload
    }).data("kendoUpload");


    //// DATES
    var zToday = new Date();
    if (!global_IsMainGaugePage) {
        Admin_RecResponse_DateOfInspection = $("#Admin_RecResponse_DateOfInspection").kendoDatePicker({
            value: viewAdmin.objRec().InspectionDate(),
            format: "dd-MMM-yy"
        }).data("kendoDatePicker");
        Admin_RecResponse_DateOfInspection.wrapper.find(".k-picker-wrap").addClass("expand-padding").css("width", "148px").css("height", "13px").find(".k-select").hide();

        Admin_RecResponse_DateMailedToClient = $("#Admin_RecResponse_DateMailedToClient").kendoDatePicker({
            value: viewAdmin.objRec().InspectionEmailedDate(),
            format: "dd-MMM-yy"
        }).data("kendoDatePicker");
        Admin_RecResponse_DateMailedToClient.wrapper.find(".k-picker-wrap").addClass("expand-padding").css("width", "148px").css("height", "13px").find(".k-select").hide();

        Admin_RecResponse_LastEmailSentOn = $("#Admin_RecResponse_LastEmailSentOn").kendoDatePicker({
            value: viewAdmin.objRec().DateRecEmailed(),
            format: "dd-MMM-yy"
        }).data("kendoDatePicker");
        Admin_RecResponse_LastEmailSentOn.wrapper.find(".k-picker-wrap").addClass("expand-padding").css("width", "148px").css("height", "13px").find(".k-select").hide();

        Admin_Document_DateOfInspection = $("#Admin_Document_DateOfInspection").kendoDatePicker({
            value: viewAdmin.objDoc().DateOfInspection(),
            format: "dd-MMM-yy"
        }).data("kendoDatePicker");
        Admin_Document_DateOfInspection.wrapper
        .find(".k-picker-wrap").addClass("expand-padding").css("height", "14px")
        .find(".k-select").css("height", "14px").css("border-style", "none")
        .find(".k-icon").css("height", "12px").css("margin-top", "1px").css("background-position", "-32px -176px"); ;
        Admin_Document_DateOfInspection.enable(false);

        Admin_Document_DateMailedToClient = $("#Admin_Document_DateMailedToClient").kendoDatePicker({
            value: viewAdmin.objDoc().DateMailedToClient(),
            format: "dd-MMM-yy"
        }).data("kendoDatePicker");
        Admin_Document_DateMailedToClient.wrapper
        .find(".k-picker-wrap").addClass("expand-padding").css("height", "14px")
        .find(".k-select").css("height", "14px").css("border-style", "none")
        .find(".k-icon").css("height", "12px").css("margin-top", "1px").css("background-position", "-32px -176px");
        Admin_Document_DateMailedToClient.enable(false);
    }
    Admin_PlanProject_Received = $("#Admin_PlanProject_Received").kendoDatePicker({
        value: viewAdmin.objPlanProject().Received(),
        format: "dd-MMM-yy",
        max: zToday
    }).data("kendoDatePicker");
    Admin_PlanProject_Received.wrapper
    .find(".k-picker-wrap").addClass("expand-padding editRequired").css("border", "none")
    .find(".k-select").css("height", "14px").css("border-style", "none");
    //.find(".k-icon").css("height", "12px").css("margin-top", "1px").css("background-position", "-32px -176px");

    Admin_PlanProject_Reviewed = $("#Admin_PlanProject_Reviewed").kendoDatePicker({
        value: viewAdmin.objPlanProject().Mailed(),
        format: "dd-MMM-yy",
        max: zToday
    }).data("kendoDatePicker");
    Admin_PlanProject_Reviewed.wrapper
    .find(".k-picker-wrap").addClass("expand-padding editRequired").css("border", "none")
    .find(".k-select").css("height", "14px").css("border-style", "none");
    //.find(".k-icon").css("height", "12px").css("margin-top", "1px").css("background-position", "-32px -176px");


    //// DROPDOWNS
    cboRecResponse_Hazard = $("#cboRecResponse_Hazard");
    cboRecResponse_Hazard.find(".k-dropdown-wrap").addClass("expand-padding editRequired adminWindow_Inputs1").css("height", "14px").css("width", "148px").css("top", "1px");
    cboRecResponse_Hazard.find(".k-select").css("height", "14px");
    cboRecResponse_Hazard.find(".k-icon").css("height", "12px").css("margin-top", "2px").css("background-position", "0px -32px");

    cboUser_CustomAccessText = $("#cboUser_CustomAccessText");
    cboUser_CustomAccessText.find(".k-dropdown-wrap").addClass("expand-padding editRequired adminWindow_Inputs1").css("height", "14px").css("top", "-1px");
    cboUser_CustomAccessText.find(".k-select").css("height", "14px");
    cboUser_CustomAccessText.find(".k-icon").css("height", "12px").css("margin-top", "-2px").css("background-position", "0px -32px");

    cboUser_Division = $("#cboUser_Division");
    cboUser_Division.find(".k-dropdown-wrap").addClass("expand-padding editRequired adminWindow_Inputs1").css("height", "14px").css("top", "-1px");
    cboUser_Division.find(".k-select").css("height", "14px");
    cboUser_Division.find(".k-icon").css("height", "12px").css("margin-top", "-2px").css("background-position", "0px -32px");

    cboUser_Plant = $("#cboUser_Plant");
    cboUser_Plant.find(".k-dropdown-wrap").addClass("expand-padding editRequired adminWindow_Inputs1").css("height", "14px").css("top", "-1px");
    cboUser_Plant.find(".k-select").css("height", "14px");
    cboUser_Plant.find(".k-icon").css("height", "12px").css("margin-top", "-2px").css("background-position", "0px -32px");

    cboUser_ClientLocNo = $("#cboUser_ClientLocNo");
    cboUser_ClientLocNo.find(".k-dropdown-wrap").addClass("expand-padding editRequired adminWindow_Inputs1").css("height", "14px").css("top", "-1px");
    cboUser_ClientLocNo.find(".k-select").css("height", "14px");
    cboUser_ClientLocNo.find(".k-icon").css("height", "12px").css("margin-top", "-2px").css("background-position", "0px -32px");

    cboUser_Facility = $("#cboUser_Facility");
    cboUser_Facility.find(".k-dropdown-wrap").addClass("expand-padding editRequired adminWindow_Inputs1").css("height", "14px").css("top", "-1px");
    cboUser_Facility.find(".k-select").css("height", "14px");
    cboUser_Facility.find(".k-icon").css("height", "12px").css("margin-top", "-2px").css("background-position", "0px -32px");

    cboUser_City = $("#cboUser_City");
    cboUser_City.find(".k-dropdown-wrap").addClass("expand-padding editRequired adminWindow_Inputs1").css("height", "14px").css("top", "-1px");
    cboUser_City.find(".k-select").css("height", "14px");
    cboUser_City.find(".k-icon").css("height", "12px").css("margin-top", "-2px").css("background-position", "0px -32px");

    cboUser_StProv = $("#cboUser_StProv");
    cboUser_StProv.find(".k-dropdown-wrap").addClass("expand-padding editRequired adminWindow_Inputs1").css("height", "14px").css("top", "-1px");
    cboUser_StProv.find(".k-select").css("height", "14px");
    cboUser_StProv.find(".k-icon").css("height", "12px").css("margin-top", "-2px").css("background-position", "0px -32px");

    cboUser_Country = $("#cboUser_Country");
    cboUser_Country.find(".k-dropdown-wrap").addClass("expand-padding editRequired adminWindow_Inputs1").css("height", "14px").css("top", "-1px");
    cboUser_Country.find(".k-select").css("height", "14px");
    cboUser_Country.find(".k-icon").css("height", "12px").css("margin-top", "-2px").css("background-position", "0px -32px");

    cboPlanProject_FileNo = $("#cboPlanProject_FileNo");
    cboPlanProject_FileNo.find(".k-dropdown-wrap").addClass("expand-padding editRequired adminWindow_Inputs1").css("height", "14px").css("top", "-1px");
    cboPlanProject_FileNo.find(".k-select").css("height", "14px");
    cboPlanProject_FileNo.find(".k-icon").css("height", "12px").css("margin-top", "-2px").css("background-position", "0px -32px");

    if (global_IsMainGaugePage) {
        PracticeType = $("#PracticeType");
        PracticeType.find(".k-dropdown-wrap").addClass("expand-padding editRequired adminWindow_Inputs12").css("height", "16px").css("top", "-1px");
        PracticeType.find(".k-select").css("height", "16px");
        PracticeType.find(".k-icon").css("height", "16px").css("margin-top", "-1px").css("background-position", "0px -32px");
    }
}
//}, 1000);
//// END SETUP KENDOUI
///////////////////////////////////////////



/////////////////////////
//// MISC FUNCTIONS
function onEditUser(userId) {
    if (userId != 0) {
        viewAdmin.onLoadUserForm(userId);
    }
    return false;
}

function onEditPlanProject(planProjectId, pPracticeCode) {
    if(planProjectId != 0) {
        viewAdmin.editNewModePlanProject = "edit";
        viewAdmin.messagePlanProjectDetails("");
        viewAdmin.enableDeletePlanProject(true);
        cboPlanProject_FileNo.find(".k-dropdown-wrap").removeClass("editRequired");
        viewAdmin.enablePlanProjectFileNo(false);
        var tempTab = viewAdmin.currentTab;
        switch (tempTab) {
            case "1":
                viewAdmin.practiceTypeValue(pPracticeCode);
                if(PracticeType) {
                    PracticeType.find(".k-dropdown-wrap").removeClass("editRequired");
                    viewAdmin.enablePracticeType(false);
                }
                if (pPracticeCode == "510") {
                    viewAdmin.collPlanProject = new es.objects.BMPlanReviewCollection;
                    es.dataProvider.baseURL = SITEBASEURL + DATASERVERENDPOINT;
                    if (!viewAdmin.collPlanProject.GetBMPlanReviewByID(planProjectId)) { viewAdmin.objPlanProject(viewAdmin.collPlanProject()[0]); } else { alert(viewAdmin.objAdminLanguageLabels().lblErrorLoadPlanProject); }
                } else {
                    viewAdmin.collPlanProject = new es.objects.FirePlanReviewCollection;
                    es.dataProvider.baseURL = SITEBASEURL + DATASERVERENDPOINT;
                    if (!viewAdmin.collPlanProject.GetFirePlanReviewByID(planProjectId)) { viewAdmin.objPlanProject(viewAdmin.collPlanProject()[0]); } else { alert(viewAdmin.objAdminLanguageLabels().lblErrorLoadPlanProject); }
                }
                break;
            case "9": case "782": case "791":
                es.dataProvider.baseURL = SITEBASEURL + DATASERVERENDPOINT;
                if (!viewAdmin.collPlanProject.GetFirePlanReviewByID(planProjectId)) { viewAdmin.objPlanProject(viewAdmin.collPlanProject()[0]); } else { alert(viewAdmin.objAdminLanguageLabels().lblErrorLoadPlanProject); }
                break;
            case "10": case "783": case "792":
                es.dataProvider.baseURL = SITEBASEURL + DATASERVERENDPOINT;
                if (!viewAdmin.collPlanProject.GetBMPlanReviewByID(planProjectId)) { viewAdmin.objPlanProject(viewAdmin.collPlanProject()[0]); } else { alert(viewAdmin.objAdminLanguageLabels().lblErrorLoadPlanProject); }
                break;
            default:
                viewAdmin.practiceTypeValue(pPracticeCode);
                if(PracticeType) {
                    PracticeType.find(".k-dropdown-wrap").removeClass("editRequired");
                    viewAdmin.enablePracticeType(false);
                }
                if (pPracticeCode == "510") {
                    viewAdmin.collPlanProject = new es.objects.BMPlanReviewCollection;
                    es.dataProvider.baseURL = SITEBASEURL + DATASERVERENDPOINT;
                    if (!viewAdmin.collPlanProject.GetBMPlanReviewByID(planProjectId)) { viewAdmin.objPlanProject(viewAdmin.collPlanProject()[0]); } else { alert(viewAdmin.objAdminLanguageLabels().lblErrorLoadPlanProject); }
                } else {
                    viewAdmin.collPlanProject = new es.objects.FirePlanReviewCollection;
                    es.dataProvider.baseURL = SITEBASEURL + DATASERVERENDPOINT;
                    if (!viewAdmin.collPlanProject.GetFirePlanReviewByID(planProjectId)) { viewAdmin.objPlanProject(viewAdmin.collPlanProject()[0]); } else { alert(viewAdmin.objAdminLanguageLabels().lblErrorLoadPlanProject); }
                }
                break;
        }
        Admin_PlanProject_Received.value(viewAdmin.objPlanProject().Received());
        Admin_PlanProject_Reviewed.value(viewAdmin.objPlanProject().Mailed());
        viewAdmin.planProjectFileNoValue(viewAdmin.objPlanProject().FileNo());
        $("#divPlanProject_FilePicker").fadeOut();
        $("#divPlanProject_PlanProjectGrid").fadeOut(function () {
            $("#divPlanProject_PlanProjectDetailForm").fadeIn();
        });
    }
    return false;
}

function onUserRecCheckBoxClick(chkValue) {
    if (chkValue) {
        viewAdmin.objUser().colCCActive(true);
    } else {
        setTimeout( function() {
            viewAdmin.objUser().colCCActive(checkAllCheckBoxes());
        }, 250);
    }
}

function onUserCheckBoxClick(chkID) {
    switch(chkID) {
        case 1:
            viewAdmin.objUser().colRiskManager(false);
            viewAdmin.objUser().colPlantManager(false);
            viewAdmin.objUser().colDivisionManager(false);
            viewAdmin.objUser().colClientLocNoManager(false);
            viewAdmin.objUser().colFacilityManager(false);
            viewAdmin.objUser().colCityManager(false);
            viewAdmin.objUser().colStProvManager(false);
            viewAdmin.objUser().colCountryManager(false);
            viewAdmin.divisionValue("");
            viewAdmin.facilityValue("");
            viewAdmin.plantValue("");
            viewAdmin.clientLocNoValue("");
            viewAdmin.cityValue("");
            viewAdmin.stProvValue("");
            viewAdmin.countryValue("");
            break;
        case 2:
            viewAdmin.objUser().colRiskManager(false);
            viewAdmin.objUser().colPlantManager(false);
            viewAdmin.objUser().colCustomAccess(false);
            viewAdmin.objUser().colClientLocNoManager(false);
            viewAdmin.objUser().colFacilityManager(false);
            viewAdmin.objUser().colCityManager(false);
            viewAdmin.objUser().colStProvManager(false);
            viewAdmin.objUser().colCountryManager(false);
            viewAdmin.customAccessTextValue("");
            viewAdmin.facilityValue("");
            viewAdmin.plantValue("");
            viewAdmin.clientLocNoValue("");
            viewAdmin.cityValue("");
            viewAdmin.stProvValue("");
            viewAdmin.countryValue("");
            break;
        case 3:
            viewAdmin.objUser().colRiskManager(false);
            viewAdmin.objUser().colCustomAccess(false);
            viewAdmin.objUser().colDivisionManager(false);
            viewAdmin.objUser().colClientLocNoManager(false);
            //viewAdmin.objUser().colFacilityManager(false);
            viewAdmin.objUser().colPlantManager(false);
            viewAdmin.objUser().colCityManager(false);
            viewAdmin.objUser().colStProvManager(false);
            viewAdmin.objUser().colCountryManager(false);
            viewAdmin.customAccessTextValue("");
            viewAdmin.divisionValue("");
            viewAdmin.plantValue("");
            viewAdmin.clientLocNoValue("");
            viewAdmin.cityValue("");
            viewAdmin.stProvValue("");
            viewAdmin.countryValue("");
            break;
        case 4:
            viewAdmin.objUser().colRiskManager(true);
            viewAdmin.objUser().colCustomAccess(false);
            viewAdmin.objUser().colPlantManager(false);
            viewAdmin.objUser().colDivisionManager(false);
            viewAdmin.objUser().colClientLocNoManager(false);
            viewAdmin.objUser().colFacilityManager(false);
            viewAdmin.objUser().colCityManager(false);
            viewAdmin.objUser().colStProvManager(false);
            viewAdmin.objUser().colCountryManager(false);
            viewAdmin.customAccessTextValue("");
            viewAdmin.divisionValue("");
            viewAdmin.facilityValue("");
            viewAdmin.plantValue("");
            viewAdmin.clientLocNoValue("");
            viewAdmin.cityValue("");
            viewAdmin.stProvValue("");
            viewAdmin.countryValue("");
            break;
        case 5:
            viewAdmin.objUser().colCustomAccess(false);
            viewAdmin.objUser().colPlantManager(false);
            viewAdmin.objUser().colDivisionManager(false);
            viewAdmin.objUser().colClientLocNoManager(false);
            viewAdmin.objUser().colFacilityManager(false);
            viewAdmin.objUser().colCityManager(false);
            viewAdmin.objUser().colStProvManager(false);
            viewAdmin.objUser().colCountryManager(false);
            viewAdmin.customAccessTextValue("");
            //viewAdmin.plantValue("");
            viewAdmin.divisionValue("");
            viewAdmin.facilityValue("");
            viewAdmin.clientLocNoValue("");
            viewAdmin.cityValue("");
            viewAdmin.stProvValue("");
            viewAdmin.countryValue("");
            break;
        case 6:
            // LOCATION ACCESS
            viewAdmin.objUser().colRiskManager(false);
            viewAdmin.objUser().colCustomAccess(false);
            viewAdmin.objUser().colPlantManager(false);
            viewAdmin.objUser().colDivisionManager(false);
            viewAdmin.objUser().colClientLocNoManager(false);
            viewAdmin.objUser().colFacilityManager(false);
            viewAdmin.objUser().colCityManager(false);
            viewAdmin.objUser().colStProvManager(false);
            viewAdmin.objUser().colCountryManager(false);
            viewAdmin.customAccessTextValue("");
            viewAdmin.divisionValue("");
            viewAdmin.facilityValue("");
            viewAdmin.plantValue("");
            viewAdmin.clientLocNoValue("");
            viewAdmin.cityValue("");
            viewAdmin.stProvValue("");
            viewAdmin.countryValue("");
            break;
        case 7:
            // CLIENT LOC NO
            viewAdmin.objUser().colRiskManager(false);
            viewAdmin.objUser().colCustomAccess(false);
            viewAdmin.objUser().colPlantManager(false);
            viewAdmin.objUser().colDivisionManager(false);
            //viewAdmin.objUser().colClientLocNoManager(false);
            viewAdmin.objUser().colFacilityManager(false);
            viewAdmin.objUser().colCityManager(false);
            viewAdmin.objUser().colStProvManager(false);
            viewAdmin.objUser().colCountryManager(false);
            viewAdmin.customAccessTextValue("");
            viewAdmin.plantValue("");
            viewAdmin.divisionValue("");
            viewAdmin.facilityValue("");
            //viewAdmin.clientLocNoValue("");
            viewAdmin.cityValue("");
            viewAdmin.stProvValue("");
            viewAdmin.countryValue("");
            break;
        case 8:
            // CITY
            viewAdmin.objUser().colRiskManager(false);
            viewAdmin.objUser().colCustomAccess(false);
            viewAdmin.objUser().colPlantManager(false);
            viewAdmin.objUser().colDivisionManager(false);
            viewAdmin.objUser().colClientLocNoManager(false);
            viewAdmin.objUser().colFacilityManager(false);
            //viewAdmin.objUser().colCityManager(false);
            viewAdmin.objUser().colStProvManager(false);
            viewAdmin.objUser().colCountryManager(false);
            viewAdmin.customAccessTextValue("");
            viewAdmin.plantValue("");
            viewAdmin.divisionValue("");
            viewAdmin.facilityValue("");
            viewAdmin.clientLocNoValue("");
            //viewAdmin.cityValue("");
            viewAdmin.stProvValue("");
            viewAdmin.countryValue("");
            break;
        case 9:
            // ST/PROV
            viewAdmin.objUser().colRiskManager(false);
            viewAdmin.objUser().colCustomAccess(false);
            viewAdmin.objUser().colPlantManager(false);
            viewAdmin.objUser().colDivisionManager(false);
            viewAdmin.objUser().colClientLocNoManager(false);
            viewAdmin.objUser().colFacilityManager(false);
            viewAdmin.objUser().colCityManager(false);
            //viewAdmin.objUser().colStProvManager(false);
            viewAdmin.objUser().colCountryManager(false);
            viewAdmin.customAccessTextValue("");
            viewAdmin.plantValue("");
            viewAdmin.divisionValue("");
            viewAdmin.facilityValue("");
            viewAdmin.clientLocNoValue("");
            viewAdmin.cityValue("");
            //viewAdmin.stProvValue("");
            viewAdmin.countryValue("");
            break;
        case 10:
            // COUNTRY
            viewAdmin.objUser().colRiskManager(false);
            viewAdmin.objUser().colCustomAccess(false);
            viewAdmin.objUser().colPlantManager(false);
            viewAdmin.objUser().colDivisionManager(false);
            viewAdmin.objUser().colClientLocNoManager(false);
            viewAdmin.objUser().colFacilityManager(false);
            viewAdmin.objUser().colCityManager(false);
            viewAdmin.objUser().colStProvManager(false);
            //viewAdmin.objUser().colCountryManager(false);
            viewAdmin.customAccessTextValue("");
            viewAdmin.plantValue("");
            viewAdmin.divisionValue("");
            viewAdmin.facilityValue("");
            viewAdmin.clientLocNoValue("");
            viewAdmin.cityValue("");
            viewAdmin.stProvValue("");
            //viewAdmin.countryValue("");
            break;
    }
    return false;
}

function onUserAllCheckClick(checkType) {
    var tempCheck = false;
    switch(checkType) {
        case 1:
            if (viewAdmin.All_Init()) { tempCheck = false; } else { tempCheck = true; viewAdmin.objUser().colCCActive(true); } //// NEED REVERSE LOGIC
            viewAdmin.Fire_Init(tempCheck);
            viewAdmin.BM_Init(tempCheck);
            viewAdmin.IR_Init(tempCheck);
            //viewAdmin.Wind_Init(tempCheck);
            //viewAdmin.Seismic_Init(tempCheck);
            //viewAdmin.Flood_Init(tempCheck);
            viewAdmin.NatHaz_Init(tempCheck);
            viewAdmin.DivServ_Init(tempCheck);
            viewAdmin.ProcSafe_Init(tempCheck);
            break;
        case 2:
            if (viewAdmin.All_Rpt()) { tempCheck = false; } else { tempCheck = true; viewAdmin.objUser().colCCActive(true); } //// NEED REVERSE LOGIC
            viewAdmin.Fire_Rpt(tempCheck);
            viewAdmin.BM_Rpt(tempCheck);
            viewAdmin.IR_Rpt(tempCheck);
            //viewAdmin.Wind_Rpt(tempCheck);
            //viewAdmin.Seismic_Rpt(tempCheck);
            //viewAdmin.Flood_Rpt(tempCheck);
            viewAdmin.NatHaz_Rpt(tempCheck);
            viewAdmin.DivServ_Rpt(tempCheck);
            viewAdmin.ProcSafe_Rpt(tempCheck);
            break;
        case 3:
            if (viewAdmin.All_1stFU()) { tempCheck = false; } else { tempCheck = true; viewAdmin.objUser().colCCActive(true); } //// NEED REVERSE LOGIC
            viewAdmin.Fire_1stFU(tempCheck);
            viewAdmin.BM_1stFU(tempCheck);
            viewAdmin.IR_1stFU(tempCheck);
            //viewAdmin.Wind_1stFU(tempCheck);
            //viewAdmin.Seismic_1stFU(tempCheck);
            //viewAdmin.Flood_1stFU(tempCheck);
            viewAdmin.NatHaz_1stFU(tempCheck);
            viewAdmin.DivServ_1stFU(tempCheck);
            viewAdmin.ProcSafe_1stFU(tempCheck);
            break;
        case 4:
            if (viewAdmin.All_2ndFU()) { tempCheck = false; } else { tempCheck = true; viewAdmin.objUser().colCCActive(true); } //// NEED REVERSE LOGIC
            viewAdmin.Fire_2ndFU(tempCheck);
            viewAdmin.BM_2ndFU(tempCheck);
            viewAdmin.IR_2ndFU(tempCheck);
            //viewAdmin.Wind_2ndFU(tempCheck);
            //viewAdmin.Seismic_2ndFU(tempCheck);
            //viewAdmin.Flood_2ndFU(tempCheck);
            viewAdmin.NatHaz_2ndFU(tempCheck);
            viewAdmin.DivServ_2ndFU(tempCheck);
            viewAdmin.ProcSafe_2ndFU(tempCheck);
            break;
        case 5:
            if (viewAdmin.All_3rdFU()) { tempCheck = false; } else { tempCheck = true; viewAdmin.objUser().colCCActive(true); } //// NEED REVERSE LOGIC
            viewAdmin.Fire_3rdFU(tempCheck);
            viewAdmin.BM_3rdFU(tempCheck);
            viewAdmin.IR_3rdFU(tempCheck);
            //viewAdmin.Wind_3rdFU(tempCheck);
            //viewAdmin.Seismic_3rdFU(tempCheck);
            //viewAdmin.Flood_3rdFU(tempCheck);
            viewAdmin.NatHaz_3rdFU(tempCheck);
            viewAdmin.DivServ_3rdFU(tempCheck);
            viewAdmin.ProcSafe_3rdFU(tempCheck);
            break;
        case 6:
            if (viewAdmin.All_1stOD()) { tempCheck = false; } else { tempCheck = true; viewAdmin.objUser().colCCActive(true); } //// NEED REVERSE LOGIC
            viewAdmin.Fire_1stOD(tempCheck);
            viewAdmin.BM_1stOD(tempCheck);
            viewAdmin.IR_1stOD(tempCheck);
            //viewAdmin.Wind_1stOD(tempCheck);
            //viewAdmin.Seismic_1stOD(tempCheck);
            //viewAdmin.Flood_1stOD(tempCheck);
            viewAdmin.NatHaz_1stOD(tempCheck);
            viewAdmin.DivServ_1stOD(tempCheck);
            viewAdmin.ProcSafe_1stOD(tempCheck);
            break;
        case 7:
            if (viewAdmin.All_2ndOD()) { tempCheck = false; } else { tempCheck = true; viewAdmin.objUser().colCCActive(true); } //// NEED REVERSE LOGIC
            viewAdmin.Fire_2ndOD(tempCheck);
            viewAdmin.BM_2ndOD(tempCheck);
            viewAdmin.IR_2ndOD(tempCheck);
            //viewAdmin.Wind_2ndOD(tempCheck);
            //viewAdmin.Seismic_2ndOD(tempCheck);
            //viewAdmin.Flood_2ndOD(tempCheck);
            viewAdmin.NatHaz_2ndOD(tempCheck);
            viewAdmin.DivServ_2ndOD(tempCheck);
            viewAdmin.ProcSafe_2ndOD(tempCheck);
            break;
        case 8:
            if (viewAdmin.All_3rdOD()) { tempCheck = false; } else { tempCheck = true; viewAdmin.objUser().colCCActive(true); } //// NEED REVERSE LOGIC
            viewAdmin.Fire_3rdOD(tempCheck);
            viewAdmin.BM_3rdOD(tempCheck);
            viewAdmin.IR_3rdOD(tempCheck);
            //viewAdmin.Wind_3rdOD(tempCheck);
            //viewAdmin.Seismic_3rdOD(tempCheck);
            //viewAdmin.Flood_3rdOD(tempCheck);
            viewAdmin.NatHaz_3rdOD(tempCheck);
            viewAdmin.DivServ_3rdOD(tempCheck);
            viewAdmin.ProcSafe_3rdOD(tempCheck);
            break;
        case 9:
            if (viewAdmin.All_PastDue()) { tempCheck = false; } else { tempCheck = true; viewAdmin.objUser().colCCActive(true); } //// NEED REVERSE LOGIC
            viewAdmin.Fire_PastDue(tempCheck);
            viewAdmin.BM_PastDue(tempCheck);
            viewAdmin.IR_PastDue(tempCheck);
            //viewAdmin.Wind_PastDue(tempCheck);
            //viewAdmin.Seismic_PastDue(tempCheck);
            //viewAdmin.Flood_PastDue(tempCheck);
            viewAdmin.NatHaz_PastDue(tempCheck);
            viewAdmin.DivServ_PastDue(tempCheck);
            viewAdmin.ProcSafe_PastDue(tempCheck);
            break;
        case 10:
            if (viewAdmin.All_ExpdFU()) { tempCheck = false; } else { tempCheck = true; viewAdmin.objUser().colCCActive(true); } //// NEED REVERSE LOGIC
            viewAdmin.Fire_ExpdFU(tempCheck);
            viewAdmin.BM_ExpdFU(tempCheck);
            viewAdmin.IR_ExpdFU(tempCheck);
            //viewAdmin.Wind_ExpdFU(tempCheck);
            //viewAdmin.Seismic_ExpdFU(tempCheck);
            //viewAdmin.Flood_ExpdFU(tempCheck);
            viewAdmin.NatHaz_ExpdFU(tempCheck);
            viewAdmin.DivServ_ExpdFU(tempCheck);
            viewAdmin.ProcSafe_ExpdFU(tempCheck);
            break;
        default:
            //// DO NOTHING
    }
    setTimeout( function() {
        viewAdmin.objUser().colCCActive(checkAllCheckBoxes());
    }, 250);
}

function checkAllCheckBoxes() {
    var zReturn = false;
    if(viewAdmin.Fire_Init() == true) { zReturn = true; }
    if(viewAdmin.BM_Init() == true) { zReturn = true; }
    if(viewAdmin.IR_Init() == true) { zReturn = true; }
    //if(viewAdmin.Wind_Init() == true) { zReturn = true; }
    //if(viewAdmin.Seismic_Init() == true) { zReturn = true; }
    //if(viewAdmin.Flood_Init() == true) { zReturn = true; }
    if (viewAdmin.NatHaz_Init() == true) { zReturn = true; }
    if (viewAdmin.DivServ_Init() == true) { zReturn = true; }
    if (viewAdmin.ProcSafe_Init() == true) { zReturn = true; }

    if(viewAdmin.Fire_Rpt() == true) { zReturn = true; }
    if(viewAdmin.BM_Rpt() == true) { zReturn = true; }
    if(viewAdmin.IR_Rpt() == true) { zReturn = true; }
    //if(viewAdmin.Wind_Rpt() == true) { zReturn = true; }
    //if(viewAdmin.Seismic_Rpt() == true) { zReturn = true; }
    //if(viewAdmin.Flood_Rpt() == true) { zReturn = true; }
    if (viewAdmin.NatHaz_Rpt() == true) { zReturn = true; }
    if (viewAdmin.DivServ_Rpt() == true) { zReturn = true; }
    if (viewAdmin.ProcSafe_Rpt() == true) { zReturn = true; }

    if(viewAdmin.Fire_1stFU() == true) { zReturn = true; }
    if(viewAdmin.BM_1stFU() == true) { zReturn = true; }
    if(viewAdmin.IR_1stFU() == true) { zReturn = true; }
    //if(viewAdmin.Wind_1stFU() == true) { zReturn = true; }
    //if(viewAdmin.Seismic_1stFU() == true) { zReturn = true; }
    //if (viewAdmin.Flood_1stFU() == true) { zReturn = true; }
    if (viewAdmin.NatHaz_1stFU() == true) { zReturn = true; }
    if (viewAdmin.DivServ_1stFU() == true) { zReturn = true; }
    if (viewAdmin.ProcSafe_1stFU() == true) { zReturn = true; }

    if(viewAdmin.Fire_2ndFU() == true) { zReturn = true; }
    if(viewAdmin.BM_2ndFU() == true) { zReturn = true; }
    if(viewAdmin.IR_2ndFU() == true) { zReturn = true; }
    //if(viewAdmin.Wind_2ndFU() == true) { zReturn = true; }
    //if(viewAdmin.Seismic_2ndFU() == true) { zReturn = true; }
    //if (viewAdmin.Flood_2ndFU() == true) { zReturn = true; }
    if (viewAdmin.NatHaz_2ndFU() == true) { zReturn = true; }
    if (viewAdmin.DivServ_2ndFU() == true) { zReturn = true; }
    if (viewAdmin.ProcSafe_2ndFU() == true) { zReturn = true; }

    if(viewAdmin.Fire_3rdFU() == true) { zReturn = true; }
    if(viewAdmin.BM_3rdFU() == true) { zReturn = true; }
    if(viewAdmin.IR_3rdFU() == true) { zReturn = true; }
    //if(viewAdmin.Wind_3rdFU() == true) { zReturn = true; }
    //if(viewAdmin.Seismic_3rdFU() == true) { zReturn = true; }
    //if (viewAdmin.Flood_3rdFU() == true) { zReturn = true; }
    if (viewAdmin.NatHaz_3rdFU() == true) { zReturn = true; }
    if (viewAdmin.DivServ_3rdFU() == true) { zReturn = true; }
    if (viewAdmin.ProcSafe_3rdFU() == true) { zReturn = true; }

    if(viewAdmin.Fire_1stOD() == true) { zReturn = true; }
    if(viewAdmin.BM_1stOD() == true) { zReturn = true; }
    if(viewAdmin.IR_1stOD() == true) { zReturn = true; }
    //if(viewAdmin.Wind_1stOD() == true) { zReturn = true; }
    //if(viewAdmin.Seismic_1stOD() == true) { zReturn = true; }
    //if (viewAdmin.Flood_1stOD() == true) { zReturn = true; }
    if (viewAdmin.NatHaz_1stOD() == true) { zReturn = true; }
    if (viewAdmin.DivServ_1stOD() == true) { zReturn = true; }
    if (viewAdmin.ProcSafe_1stOD() == true) { zReturn = true; }

    if(viewAdmin.Fire_2ndOD() == true) { zReturn = true; }
    if(viewAdmin.BM_2ndOD() == true) { zReturn = true; }
    if(viewAdmin.IR_2ndOD() == true) { zReturn = true; }
    //if(viewAdmin.Wind_2ndOD() == true) { zReturn = true; }
    //if(viewAdmin.Seismic_2ndOD() == true) { zReturn = true; }
    //if (viewAdmin.Flood_2ndOD() == true) { zReturn = true; }
    if (viewAdmin.NatHaz_2ndOD() == true) { zReturn = true; }
    if (viewAdmin.DivServ_2ndOD() == true) { zReturn = true; }
    if (viewAdmin.ProcSafe_2ndOD() == true) { zReturn = true; }

    if(viewAdmin.Fire_3rdOD() == true) { zReturn = true; }
    if(viewAdmin.BM_3rdOD() == true) { zReturn = true; }
    if(viewAdmin.IR_3rdOD() == true) { zReturn = true; }
    //if(viewAdmin.Wind_3rdOD() == true) { zReturn = true; }
    //if(viewAdmin.Seismic_3rdOD() == true) { zReturn = true; }
    //if (viewAdmin.Flood_3rdOD() == true) { zReturn = true; }
    if (viewAdmin.NatHaz_3rdOD() == true) { zReturn = true; }
    if (viewAdmin.DivServ_3rdOD() == true) { zReturn = true; }
    if (viewAdmin.ProcSafe_3rdOD() == true) { zReturn = true; }

    if(viewAdmin.Fire_PastDue() == true) { zReturn = true; }
    if(viewAdmin.BM_PastDue() == true) { zReturn = true; }
    if(viewAdmin.IR_PastDue() == true) { zReturn = true; }
    //if(viewAdmin.Wind_PastDue() == true) { zReturn = true; }
    //if(viewAdmin.Seismic_PastDue() == true) { zReturn = true; }
    //if (viewAdmin.Flood_PastDue() == true) { zReturn = true; }
    if (viewAdmin.NatHaz_PastDue() == true) { zReturn = true; }
    if (viewAdmin.DivServ_PastDue() == true) { zReturn = true; }
    if (viewAdmin.ProcSafe_PastDue() == true) { zReturn = true; }
    return zReturn;
}


function docManagerPlaceReport(sender, args) {
    var tempPath = args._item._path;
    if (tempPath[tempPath.length - 1] != "\\" && tempPath[tempPath.length - 1] != "/") {
        args.set_cancel(true);
        var newPath = "#";
        var tempArray = tempPath.split("/");
        for (f = 2; f < tempArray.length; f++) {
            if (f == 2) {
                newPath = newPath + tempArray[f];
            } else {
                newPath = newPath + "\\" + tempArray[f];
            }
        }
        newPath = newPath + "#";
        if (newPath.length > 2) {
            if (viewAdmin.selectReportMode == "er") { viewAdmin.objDoc().LinkToReport(newPath); } else { viewAdmin.objDoc().LinkToReport2(newPath); }
        } else {
            if (viewAdmin.selectReportMode == "er") { viewAdmin.objDoc().LinkToReport(tempPath); } else { viewAdmin.objDoc().LinkToReport2(tempPath); }
        }
        
        $("#divDoc_ReportPicker").fadeOut(function () {
            $("#divDoc_Form").fadeIn();
        });
    }
}

function docManagerPlaceDiagram(sender, args) {
    var tempPath = args._item._path;
    if (tempPath[tempPath.length - 1] != "\\" && tempPath[tempPath.length - 1] != "/") {
        //// TURN OFF THE OPEN EVENT
        args.set_cancel(true);
        var newPath = "#";
        var tempArray = tempPath.split("/");
        for (f = 2; f < tempArray.length; f++) {
            if (f == 2) {
                newPath = newPath + tempArray[f];
            } else {
                newPath = newPath + "\\" + tempArray[f];
            }
        }
        newPath = newPath + "#";
        if (newPath.length > 2) {
            viewAdmin.objDoc().LinkToDiagram(newPath);
        } else {
            viewAdmin.objDoc().LinkToDiagram(tempPath);
        }

        $("#divDoc_DiagramPicker").fadeOut(function () {
            $("#divDoc_Form").fadeIn();
        });
    }
}

function PlanProjectPlaceItem(sender, args) {
    var tempPath = args._item._path;
    if (tempPath[tempPath.length - 1] != "\\" && tempPath[tempPath.length - 1] != "/") {
        args.set_cancel(true);
        var newPath = "#";
        var tempArray = tempPath.split("/");
        for (f = 2; f < tempArray.length; f++) {
            if (f == 2) {
                newPath = newPath + tempArray[f];
            } else {
                newPath = newPath + "\\" + tempArray[f];
            }
        }
        newPath = newPath + "#";
        if (newPath.length > 2) {
            viewAdmin.objPlanProject().ToReview(newPath);
        } else {
            viewAdmin.objPlanProject().ToReview(tempPath);
        }

        $("#divPlanProject_PlanProjectGrid").fadeOut();
        $("#divPlanProject_FilePicker").fadeOut(function () {
            $("#divPlanProject_PlanProjectDetailForm").fadeIn();
        });
    }
}

//// VALIDATION AND EVENTS
function maxLengthProject(pTextDOM, pMaxChars) {
    if (maxLengthTrim(pTextDOM, pMaxChars)) {
        $("#lblMessagePlanProjectDetails").removeClass("messageNotice");
        $("#lblMessagePlanProjectDetails").addClass("messageError");
        viewAdmin.messagePlanProjectDetails(viewAdmin.objAdminLanguageLabels().lblMaxCharProject);
    } else {
        viewAdmin.messagePlanProjectDetails("");
    }
}
function maxLengthTrim(pTextDOM, pMaxChars) {
    if (pTextDOM.length > pMaxChars) {
        pTextDOM.value = pTextDOM.substring(0, pMaxChars);
        return true;
    } else {
        return false;
    }
}

$("#txtPlanProject_ProjectNo").keydown(function (e) {
    // ALLOW: backspace, delete, tab, escape, enter, home, end, left, right, Ctrl+A, Ctrl+C, Ctrl+V
    if (e.keyCode == 46 || e.keyCode == 8 || e.keyCode == 9 || e.keyCode == 27 || e.keyCode == 13 || (e.keyCode >= 35 && e.keyCode <= 39) || (e.keyCode == 65 && e.ctrlKey === true) || (e.keyCode == 67 && e.ctrlKey === true) || (e.keyCode == 86 && e.ctrlKey === true)) {
        // DO NOTHING
        return;
    } else {
        // ALLOW NUMBERS ONLY OR STOP THE KEYPRESS
        if (e.shiftKey || (e.keyCode < 48 || e.keyCode > 57) && (e.keyCode < 96 || e.keyCode > 105)) {
            e.preventDefault();
        }
    }
});

$("#txtUser_Email").attr('autocomplete', 'off');

$("#txtUser_Email").blur(function (e) {
    //// LOOK UP THE EMAIL AND DISPLAY INFORMATION THAT ALREADY EXISTS
    if (viewAdmin.editNewMode == "new") {
        viewAdmin.onLoadUsersByEmail(viewAdmin.objUser().colEmail());
    }
});